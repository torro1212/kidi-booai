"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./components/BookViewer.tsx":
/*!***********************************!*\
  !*** ./components/BookViewer.tsx ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _services_geminiService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/services/geminiService */ \"(app-pages-browser)/./services/geminiService.ts\");\n/* harmony import */ var _components_DriveConnectButton__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/components/DriveConnectButton */ \"(app-pages-browser)/./components/DriveConnectButton.tsx\");\n/* harmony import */ var html2canvas__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! html2canvas */ \"(app-pages-browser)/./node_modules/html2canvas/dist/html2canvas.js\");\n/* harmony import */ var html2canvas__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(html2canvas__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var jspdf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! jspdf */ \"(app-pages-browser)/./node_modules/jspdf/dist/jspdf.es.min.js\");\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jszip */ \"(app-pages-browser)/./node_modules/jszip/dist/jszip.min.js\");\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jszip__WEBPACK_IMPORTED_MODULE_6__);\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n\n// Helper to convert AudioBuffer to WAV Blob\nfunction audioBufferToWav(buffer) {\n    const numChannels = buffer.numberOfChannels;\n    const sampleRate = buffer.sampleRate;\n    const format = 1; // PCM\n    const bitDepth = 16;\n    const bytesPerSample = bitDepth / 8;\n    const blockAlign = numChannels * bytesPerSample;\n    const dataByteCount = buffer.length * blockAlign;\n    const headerByteCount = 44;\n    const totalByteCount = headerByteCount + dataByteCount;\n    const headerBuffer = new ArrayBuffer(headerByteCount);\n    const view = new DataView(headerBuffer);\n    const writeString = (view, offset, string)=>{\n        for(let i = 0; i < string.length; i++){\n            view.setUint8(offset + i, string.charCodeAt(i));\n        }\n    };\n    writeString(view, 0, 'RIFF');\n    view.setUint32(4, totalByteCount - 8, true);\n    writeString(view, 8, 'WAVE');\n    writeString(view, 12, 'fmt ');\n    view.setUint32(16, 16, true);\n    view.setUint16(20, format, true);\n    view.setUint16(22, numChannels, true);\n    view.setUint32(24, sampleRate, true);\n    view.setUint32(28, sampleRate * blockAlign, true);\n    view.setUint16(32, blockAlign, true);\n    view.setUint16(34, bitDepth, true);\n    writeString(view, 36, 'data');\n    view.setUint32(40, dataByteCount, true);\n    const dataBuffer = new ArrayBuffer(dataByteCount);\n    const dataView = new DataView(dataBuffer);\n    let offset = 0;\n    for(let i = 0; i < buffer.length; i++){\n        for(let channel = 0; channel < numChannels; channel++){\n            const sample = buffer.getChannelData(channel)[i];\n            const s = Math.max(-1, Math.min(1, sample));\n            const int16 = s < 0 ? s * 0x8000 : s * 0x7FFF;\n            dataView.setInt16(offset, int16, true);\n            offset += 2;\n        }\n    }\n    return new Blob([\n        headerBuffer,\n        dataBuffer\n    ], {\n        type: 'audio/wav'\n    });\n}\nconst BookViewer = (param)=>{\n    let { book, onUpdateBook, onClose } = param;\n    var _book_pages_find, _book_metadata_audioConfig, _book_metadata_audioConfig1;\n    _s();\n    const [currentPageIndex, setCurrentPageIndex] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0);\n    const bookRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(book);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"BookViewer.useEffect\": ()=>{\n            bookRef.current = book;\n        }\n    }[\"BookViewer.useEffect\"], [\n        book\n    ]);\n    const [images, setImages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({\n        \"BookViewer.useState\": ()=>{\n            const initialImages = {};\n            book.pages.forEach({\n                \"BookViewer.useState\": (page, index)=>{\n                    if (page.generatedImageUrl) {\n                        initialImages[index] = page.generatedImageUrl;\n                    }\n                }\n            }[\"BookViewer.useState\"]);\n            return initialImages;\n        }\n    }[\"BookViewer.useState\"]);\n    const [loadingImages, setLoadingImages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({});\n    const [sessionReferenceImage, setSessionReferenceImage] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(book.metadata.baseCharacterImageUrl || ((_book_pages_find = book.pages.find({\n        \"BookViewer.useState\": (p)=>p.generatedImageUrl\n    }[\"BookViewer.useState\"])) === null || _book_pages_find === void 0 ? void 0 : _book_pages_find.generatedImageUrl) || null);\n    const [isExporting, setIsExporting] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [exportProgress, setExportProgress] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)('');\n    const [isPlaying, setIsPlaying] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [isLoadingAudio, setIsLoadingAudio] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [audioError, setAudioError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [audioBuffers, setAudioBuffers] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({});\n    const audioContextRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const audioSourceRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const currentPage = book.pages[currentPageIndex];\n    const totalPages = book.pages.length;\n    var _book_metadata_audioConfig_enabled;\n    const audioEnabled = (_book_metadata_audioConfig_enabled = (_book_metadata_audioConfig = book.metadata.audioConfig) === null || _book_metadata_audioConfig === void 0 ? void 0 : _book_metadata_audioConfig.enabled) !== null && _book_metadata_audioConfig_enabled !== void 0 ? _book_metadata_audioConfig_enabled : true;\n    const voiceName = ((_book_metadata_audioConfig1 = book.metadata.audioConfig) === null || _book_metadata_audioConfig1 === void 0 ? void 0 : _book_metadata_audioConfig1.voiceName) || 'Puck';\n    const fullCharacterDescription = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)({\n        \"BookViewer.useMemo[fullCharacterDescription]\": ()=>{\n            let desc = \"Main Character: \".concat(book.metadata.mainCharacterDescription, \".\");\n            if (book.metadata.mainCharacterDistinctiveMark) {\n                desc += \" DISTINCTIVE FEATURE: \".concat(book.metadata.mainCharacterDistinctiveMark, \" (Must appear in every image).\");\n            }\n            if (book.metadata.secondaryCharacterDescription) {\n                desc += \"\\nSecondary Character (Sidekick): \".concat(book.metadata.secondaryCharacterDescription, \" (This appearance MUST be consistent across all pages).\");\n                if (book.metadata.secondaryCharacterDistinctiveMark) {\n                    desc += \" DISTINCTIVE FEATURE: \".concat(book.metadata.secondaryCharacterDistinctiveMark, \".\");\n                }\n            }\n            return desc;\n        }\n    }[\"BookViewer.useMemo[fullCharacterDescription]\"], [\n        book.metadata\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"BookViewer.useEffect\": ()=>{\n            return ({\n                \"BookViewer.useEffect\": ()=>{\n                    stopAudio();\n                    if (audioContextRef.current) {\n                        audioContextRef.current.close();\n                    }\n                }\n            })[\"BookViewer.useEffect\"];\n        }\n    }[\"BookViewer.useEffect\"], []);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"BookViewer.useEffect\": ()=>{\n            stopAudio();\n            setAudioError(null);\n        }\n    }[\"BookViewer.useEffect\"], [\n        currentPageIndex\n    ]);\n    const stopAudio = ()=>{\n        if (audioSourceRef.current) {\n            try {\n                audioSourceRef.current.stop();\n            } catch (e) {}\n            audioSourceRef.current = null;\n        }\n        setIsPlaying(false);\n    };\n    const handleChangeKey = ()=>{\n        const aistudio = window.aistudio;\n        if (aistudio) aistudio.openSelectKey();\n    };\n    const handleToggleAudio = async ()=>{\n        if (!audioEnabled) return;\n        if (isPlaying) {\n            stopAudio();\n            return;\n        }\n        setAudioError(null);\n        if (!audioContextRef.current) {\n            audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)({\n                sampleRate: 24000\n            });\n        }\n        if (audioContextRef.current.state === 'suspended') {\n            await audioContextRef.current.resume();\n        }\n        const ctx = audioContextRef.current;\n        if (audioBuffers[currentPageIndex]) {\n            playBuffer(audioBuffers[currentPageIndex], ctx);\n            return;\n        }\n        setIsLoadingAudio(true);\n        try {\n            const textToRead = currentPageIndex === 0 ? book.metadata.title : currentPage.hebrewText;\n            const buffer = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageAudio)(textToRead, ctx, voiceName);\n            if (buffer) {\n                setAudioBuffers((prev)=>({\n                        ...prev,\n                        [currentPageIndex]: buffer\n                    }));\n                playBuffer(buffer, ctx);\n            } else {\n                setAudioError(\"תקלה ביצירת אודיו\");\n            }\n        } catch (e) {\n            console.error(e);\n            setAudioError(\"שגיאה כללית\");\n        } finally{\n            setIsLoadingAudio(false);\n        }\n    };\n    const playBuffer = (buffer, ctx)=>{\n        const source = ctx.createBufferSource();\n        source.buffer = buffer;\n        source.connect(ctx.destination);\n        source.onended = ()=>setIsPlaying(false);\n        audioSourceRef.current = source;\n        source.start();\n        setIsPlaying(true);\n    };\n    const handleNext = ()=>{\n        if (currentPageIndex < totalPages - 1) setCurrentPageIndex((prev)=>prev + 1);\n    };\n    const handlePrev = ()=>{\n        if (currentPageIndex > 0) setCurrentPageIndex((prev)=>prev - 1);\n    };\n    const updateBookState = (index, url)=>{\n        const currentBookState = bookRef.current;\n        const updatedPages = [\n            ...currentBookState.pages\n        ];\n        updatedPages[index] = {\n            ...updatedPages[index],\n            generatedImageUrl: url\n        };\n        const updatedBook = {\n            ...currentBookState,\n            pages: updatedPages\n        };\n        onUpdateBook(updatedBook);\n    };\n    const loadImage = async (pageIndex, actionPrompt)=>{\n        if (images[pageIndex] || loadingImages[pageIndex]) return;\n        if (bookRef.current.pages[pageIndex].generatedImageUrl) {\n            setImages((prev)=>({\n                    ...prev,\n                    [pageIndex]: bookRef.current.pages[pageIndex].generatedImageUrl\n                }));\n            return;\n        }\n        setLoadingImages((prev)=>({\n                ...prev,\n                [pageIndex]: true\n            }));\n        try {\n            const referenceToUse = bookRef.current.metadata.baseCharacterImageUrl || sessionReferenceImage;\n            const isCover = pageIndex === 0;\n            const textToRender = isCover ? bookRef.current.metadata.title : undefined;\n            const url = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageImage)(actionPrompt, fullCharacterDescription, bookRef.current.metadata.artStyle, referenceToUse || undefined, isCover, textToRender);\n            if (url) {\n                setImages((prev)=>({\n                        ...prev,\n                        [pageIndex]: url\n                    }));\n                if (!referenceToUse && !sessionReferenceImage) {\n                    setSessionReferenceImage(url);\n                }\n                updateBookState(pageIndex, url);\n            }\n            return url;\n        } catch (err) {\n            console.error(\"Failed to load page image:\", err);\n            return null;\n        } finally{\n            setLoadingImages((prev)=>({\n                    ...prev,\n                    [pageIndex]: false\n                }));\n        }\n    };\n    const handleRegenerateImage = async (e)=>{\n        e.stopPropagation();\n        const pageIndex = currentPageIndex;\n        if (loadingImages[pageIndex]) return;\n        setLoadingImages((prev)=>({\n                ...prev,\n                [pageIndex]: true\n            }));\n        try {\n            const referenceToUse = bookRef.current.metadata.baseCharacterImageUrl || sessionReferenceImage;\n            const isCover = pageIndex === 0;\n            const textToRender = isCover ? bookRef.current.metadata.title : undefined;\n            const url = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageImage)(bookRef.current.pages[pageIndex].imagePrompt, fullCharacterDescription, bookRef.current.metadata.artStyle, referenceToUse || undefined, isCover, textToRender);\n            if (url) {\n                setImages((prev)=>({\n                        ...prev,\n                        [pageIndex]: url\n                    }));\n                if (pageIndex === 0 && !bookRef.current.metadata.baseCharacterImageUrl) {\n                    setSessionReferenceImage(url);\n                }\n                updateBookState(pageIndex, url);\n            }\n        } catch (error) {\n            console.error(\"Regeneration failed\", error);\n            alert(\"שגיאה ביצירת התמונה מחדש\");\n        } finally{\n            setLoadingImages((prev)=>({\n                    ...prev,\n                    [pageIndex]: false\n                }));\n        }\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"BookViewer.useEffect\": ()=>{\n            const page = book.pages[currentPageIndex];\n            if (page && !images[currentPageIndex]) {\n                loadImage(currentPageIndex, page.imagePrompt);\n            }\n        }\n    }[\"BookViewer.useEffect\"], [\n        currentPageIndex\n    ]);\n    const prepareExportCanvas = async (i, imgUrl)=>{\n        const isCover = i === 0;\n        // EXPORT LAYOUT STRATEGY:\n        // Cover: 1024x1024 Square (Image contains title, no extra text area)\n        // Inner: 1024x1280 (1024x1024 Image Top + 1024x256 Text Area Bottom)\n        const width = 1024;\n        const height = isCover ? 1024 : 1280;\n        const container = document.createElement('div');\n        container.style.width = \"\".concat(width, \"px\");\n        container.style.height = \"\".concat(height, \"px\");\n        container.style.position = 'absolute';\n        container.style.left = '-9999px';\n        container.style.backgroundColor = '#ffffff';\n        container.style.overflow = 'hidden';\n        if (isCover) {\n            // Cover is simple full image\n            container.innerHTML = '<img src=\"'.concat(imgUrl, '\" style=\"width: 1024px; height: 1024px; object-fit: cover;\" />');\n        } else {\n            // Inner pages: Vertical Stack. Image Top, Text Bottom.\n            const text = book.pages[i].hebrewText || \"\";\n            // Improved text styling matching globals.css updates\n            container.innerHTML = '\\n            <div style=\"display: flex; flex-direction: column; width: 1024px; height: 1280px; background: white;\">\\n                <div style=\"width: 1024px; height: 1000px; flex-shrink: 0; background-color: #f8fafc;\">\\n                    <img src=\"'.concat(imgUrl, '\" style=\"width: 100%; height: 100%; object-fit: cover; display: block;\" />\\n                </div>\\n                <div style=\"\\n                    width: 1024px; \\n                    height: 280px; \\n                    display: flex; \\n                    align-items: center; \\n                    justify-content: center; \\n                    padding: 32px 48px; \\n                    box-sizing: border-box; \\n                    background: linear-gradient(to bottom, #fffdf5 0%, #fff8e7 30%, #fdecc8 70%, #fbe3b2 100%);\\n                    box-shadow: inset 0 2px 0 rgba(255, 255, 255, 0.8), inset 0 -2px 8px rgba(0, 0, 0, 0.05);\\n                    border-top: 3px solid rgba(255, 255, 255, 0.9);\\n                \">\\n                     <p style=\"\\n                        margin: 0; \\n                        font-family: \\'Rubik\\', \\'Heebo\\', \\'Arial\\', sans-serif; \\n                        font-size: 44px; \\n                        font-weight: 600; \\n                        color: #2a1a0a; \\n                        direction: rtl; \\n                        text-align: center; \\n                        line-height: 1.7;\\n                        text-shadow: 0 1px 0 rgba(255, 255, 255, 0.8), 0 2px 4px rgba(0, 0, 0, 0.06);\\n                        letter-spacing: 0.01em;\\n                     \">\\n                        ').concat(text, \"\\n                     </p>\\n                </div>\\n            </div>\\n        \");\n        }\n        document.body.appendChild(container);\n        await new Promise((resolve)=>setTimeout(resolve, 500));\n        const canvas = await html2canvas__WEBPACK_IMPORTED_MODULE_4___default()(container, {\n            scale: 1,\n            useCORS: true,\n            width,\n            height\n        });\n        document.body.removeChild(container);\n        return canvas;\n    };\n    const handleDownloadZIP = async ()=>{\n        if (isExporting) return;\n        setIsExporting(true);\n        setExportProgress('מכין חבילה מלאה...');\n        const zip = new (jszip__WEBPACK_IMPORTED_MODULE_6___default())();\n        // A4 Portrait for standardized printing\n        const pdf = new jspdf__WEBPACK_IMPORTED_MODULE_5__.jsPDF('p', 'mm', 'a4');\n        const pageWidth = 210;\n        try {\n            zip.file(\"sequel_data.json\", JSON.stringify(bookRef.current, null, 2));\n            for(let i = 0; i < book.pages.length; i++){\n                setExportProgress(\"מעבד עמוד \".concat(i + 1, \" מתוך \").concat(book.pages.length, \"...\"));\n                let imgUrl = images[i];\n                const isCover = i === 0;\n                if (!imgUrl) {\n                    const referenceToUse = bookRef.current.metadata.baseCharacterImageUrl || sessionReferenceImage;\n                    const textToRender = isCover ? bookRef.current.metadata.title : undefined;\n                    imgUrl = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageImage)(book.pages[i].imagePrompt, fullCharacterDescription, book.metadata.artStyle, referenceToUse || undefined, isCover, textToRender);\n                    if (imgUrl) {\n                        setImages((prev)=>({\n                                ...prev,\n                                [i]: imgUrl\n                            }));\n                        if (!referenceToUse && !sessionReferenceImage) setSessionReferenceImage(imgUrl);\n                        updateBookState(i, imgUrl); // Sync!\n                    }\n                }\n                if (imgUrl) {\n                    const canvas = await prepareExportCanvas(i, imgUrl);\n                    const pngBlob = await new Promise((resolve)=>canvas.toBlob(resolve, 'image/png'));\n                    if (pngBlob) zip.file(i === 0 ? '00_COVER.png' : \"PAGE_\".concat(String(i).padStart(2, '0'), \".png\"), pngBlob);\n                    const imgData = canvas.toDataURL('image/jpeg', 0.9);\n                    // PDF Layout\n                    const canvasRatio = canvas.height / canvas.width;\n                    const pdfImgHeight = pageWidth * canvasRatio;\n                    // If height exceeds A4 (297mm), scale down to fit\n                    let renderWidth = pageWidth;\n                    let renderHeight = pdfImgHeight;\n                    if (renderHeight > 297) {\n                        const scale = 297 / renderHeight;\n                        renderHeight = 297;\n                        renderWidth = pageWidth * scale;\n                    }\n                    const xOffset = (210 - renderWidth) / 2;\n                    pdf.addImage(imgData, 'JPEG', xOffset, 0, renderWidth, renderHeight);\n                    if (i < book.pages.length - 1) pdf.addPage();\n                }\n                if (audioEnabled) {\n                    let audioBuf = audioBuffers[i];\n                    if (!audioBuf) {\n                        if (!audioContextRef.current) audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)({\n                            sampleRate: 24000\n                        });\n                        const buf = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageAudio)(i === 0 ? book.metadata.title : book.pages[i].hebrewText, audioContextRef.current, voiceName);\n                        if (buf) {\n                            audioBuf = buf;\n                            setAudioBuffers((prev)=>({\n                                    ...prev,\n                                    [i]: buf\n                                }));\n                        }\n                    }\n                    if (audioBuf) zip.file(i === 0 ? '00_AUDIO_Title.wav' : \"AUDIO_Page_\".concat(String(i).padStart(2, '0'), \".wav\"), audioBufferToWav(audioBuf));\n                }\n            }\n            const pdfBlob = pdf.output('blob');\n            zip.file(\"\".concat(book.metadata.title, \".pdf\"), pdfBlob);\n            const content = await zip.generateAsync({\n                type: 'blob'\n            });\n            // Upload to Google Drive if connected\n            let driveLinks = null;\n            try {\n                const { hasDriveAccess, uploadBookToDrive } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/googleDrive */ \"(app-pages-browser)/./services/googleDrive.ts\"));\n                if (hasDriveAccess()) {\n                    setExportProgress('מעלה ל-Google Drive...');\n                    driveLinks = await uploadBookToDrive(content, pdfBlob, book.metadata.title);\n                }\n            } catch (driveError) {\n                console.warn('Drive upload failed:', driveError);\n            }\n            // Save to Firestore WITH Drive links\n            setExportProgress('שומר מידע...');\n            try {\n                const { saveBookPrompts } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/firebase */ \"(app-pages-browser)/./services/firebase.ts\"));\n                await saveBookPrompts({\n                    bookTitle: book.metadata.title,\n                    mainCharacter: book.metadata.mainCharacterDescription || '',\n                    artStyle: book.metadata.artStyle,\n                    topic: book.metadata.mainTheme || '',\n                    imagePrompts: book.pages.map((p)=>p.imagePrompt),\n                    driveZipUrl: driveLinks === null || driveLinks === void 0 ? void 0 : driveLinks.zipLink,\n                    drivePdfUrl: driveLinks === null || driveLinks === void 0 ? void 0 : driveLinks.pdfLink\n                });\n                console.log('Book saved to Firestore with Drive links!');\n            } catch (firebaseError) {\n                console.warn('Firestore save failed:', firebaseError);\n            }\n            // Download locally\n            const link = document.createElement('a');\n            link.href = URL.createObjectURL(content);\n            const safeTitle = book.metadata.title.replace(/[\\\\/:*?\"<>|]/g, '_');\n            link.download = \"\".concat(safeTitle, \".zip\");\n            link.click();\n            // Show Drive links if uploaded\n            if (driveLinks) {\n                setTimeout(()=>{\n                    const showLinks = confirm(\"הספר הועלה ל-Google Drive!\\n\\nלהציג קישורים?\");\n                    if (showLinks) {\n                        alert(\"\\uD83D\\uDCE6 ZIP: \".concat(driveLinks.zipLink, \"\\n\\n\\uD83D\\uDCC4 PDF: \").concat(driveLinks.pdfLink));\n                    }\n                }, 500);\n            }\n        } catch (error) {\n            console.error(\"Export failed:\", error);\n            alert(\"הייצוא נכשל. אנא נסה שוב.\");\n        } finally{\n            setIsExporting(false);\n            setExportProgress('');\n        }\n    };\n    const handleDownloadPDF = async ()=>{\n        if (isExporting) return;\n        setIsExporting(true);\n        setExportProgress('יוצר PDF...');\n        const pdf = new jspdf__WEBPACK_IMPORTED_MODULE_5__.jsPDF('p', 'mm', 'a4');\n        const pageWidth = 210;\n        try {\n            for(let i = 0; i < book.pages.length; i++){\n                setExportProgress(\"מוסיף עמוד \".concat(i + 1, \"...\"));\n                let imgUrl = images[i];\n                const isCover = i === 0;\n                if (!imgUrl) {\n                    const ref = bookRef.current.metadata.baseCharacterImageUrl || sessionReferenceImage;\n                    const textToRender = isCover ? bookRef.current.metadata.title : undefined;\n                    imgUrl = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageImage)(book.pages[i].imagePrompt, fullCharacterDescription, book.metadata.artStyle, ref || undefined, isCover, textToRender);\n                    if (imgUrl) {\n                        setImages((prev)=>({\n                                ...prev,\n                                [i]: imgUrl\n                            }));\n                        updateBookState(i, imgUrl);\n                    }\n                }\n                if (imgUrl) {\n                    const canvas = await prepareExportCanvas(i, imgUrl);\n                    const imgData = canvas.toDataURL('image/jpeg', 0.9);\n                    const canvasRatio = canvas.height / canvas.width;\n                    const pdfImgHeight = pageWidth * canvasRatio;\n                    let renderWidth = pageWidth;\n                    let renderHeight = pdfImgHeight;\n                    if (renderHeight > 297) {\n                        const scale = 297 / renderHeight;\n                        renderHeight = 297;\n                        renderWidth = pageWidth * scale;\n                    }\n                    const xOffset = (210 - renderWidth) / 2;\n                    pdf.addImage(imgData, 'JPEG', xOffset, 0, renderWidth, renderHeight);\n                    if (i < book.pages.length - 1) pdf.addPage();\n                }\n            }\n            const pdfBlob = pdf.output('blob');\n            // Upload to Google Drive if connected\n            let driveLinks = null;\n            try {\n                const { hasDriveAccess, uploadBookToDrive } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/googleDrive */ \"(app-pages-browser)/./services/googleDrive.ts\"));\n                if (hasDriveAccess()) {\n                    setExportProgress('מעלה ל-Google Drive...');\n                    // For PDF only export, we just upload the PDF (mock empty ZIP)\n                    // Or better, we can use a simpler uploadToDrive function, but uploadBookToDrive is handy.\n                    // Let's just upload the PDF using the generic upload function exposed or via uploadBookToDrive passing empty blob for zip?\n                    // Actually uploadBookToDrive expects both. Let's import uploadToDrive directly.\n                    const { uploadToDrive } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/googleDrive */ \"(app-pages-browser)/./services/googleDrive.ts\"));\n                    const safeTitle = book.metadata.title.replace(/[\\\\/:*?\"<>|]/g, '_');\n                    const timestamp = new Date().toISOString().split('T')[0];\n                    const result = await uploadToDrive(pdfBlob, \"\".concat(safeTitle, \"_\").concat(timestamp, \".pdf\"), 'application/pdf');\n                    driveLinks = {\n                        zipLink: '',\n                        pdfLink: result.webViewLink\n                    };\n                }\n            } catch (driveError) {\n                console.warn('Drive upload failed:', driveError);\n            }\n            // Log book metadata to Firestore WITH Drive link\n            setExportProgress('שומר מידע...');\n            try {\n                const { saveBookPrompts } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/firebase */ \"(app-pages-browser)/./services/firebase.ts\"));\n                await saveBookPrompts({\n                    bookTitle: book.metadata.title,\n                    mainCharacter: book.metadata.mainCharacterDescription || '',\n                    artStyle: book.metadata.artStyle,\n                    topic: book.metadata.mainTheme || '',\n                    imagePrompts: book.pages.map((p)=>p.imagePrompt),\n                    drivePdfUrl: driveLinks === null || driveLinks === void 0 ? void 0 : driveLinks.pdfLink\n                });\n                console.log('Book metadata saved to Firestore!');\n            } catch (firebaseError) {\n                console.warn('Firestore save failed:', firebaseError);\n            }\n            const safeTitle = book.metadata.title.replace(/[\\\\/:*?\"<>|]/g, '_');\n            pdf.save(\"\".concat(safeTitle, \".pdf\"));\n            // Show Drive links if uploaded\n            if (driveLinks === null || driveLinks === void 0 ? void 0 : driveLinks.pdfLink) {\n                setTimeout(()=>{\n                    const showLinks = confirm(\"ה-PDF הועלה ל-Google Drive!\\n\\nלהציג קישור?\");\n                    if (showLinks) {\n                        alert(\"\\uD83D\\uDCC4 PDF: \".concat(driveLinks.pdfLink));\n                    }\n                }, 500);\n            }\n        } finally{\n            setIsExporting(false);\n            setExportProgress('');\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"fixed inset-0 bg-slate-900 z-[100] flex flex-col items-center\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"w-full bg-white px-4 h-20 flex items-center justify-between shadow-md shrink-0 z-50\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center gap-4\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: onClose,\n                                className: \"text-slate-600 hover:text-slate-900 font-bold flex items-center gap-2\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        className: \"text-xl\",\n                                        children: \"←\"\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 589,\n                                        columnNumber: 13\n                                    }, undefined),\n                                    \" חזרה לעריכה\"\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 588,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: handleChangeKey,\n                                className: \"text-slate-400 hover:text-slate-600 text-xs font-bold border border-slate-200 px-2 py-1 rounded-full flex items-center gap-1\",\n                                children: \"\\uD83D\\uDD11 API\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 591,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 587,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center gap-3\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_DriveConnectButton__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {}, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 596,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: handleDownloadZIP,\n                                disabled: isExporting,\n                                className: \"bg-kid-orange hover:bg-orange-400 text-white font-bold py-2 px-4 rounded-full text-sm transition-all flex items-center gap-2\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        children: \"חבילה מלאה\"\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 598,\n                                        columnNumber: 13\n                                    }, undefined),\n                                    \" \\uD83D\\uDCE6\"\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 597,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: handleDownloadPDF,\n                                disabled: isExporting,\n                                className: \"bg-kid-blue hover:bg-teal-400 text-white font-bold py-2 px-4 rounded-full text-sm transition-all\",\n                                children: \"PDF בלבד \\uD83D\\uDCC4\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 600,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 595,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                lineNumber: 586,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex-grow w-full flex items-center justify-center p-4 overflow-auto bg-slate-800\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"relative w-full max-w-[550px] bg-white rounded-2xl shadow-2xl overflow-hidden group border-4 border-white flex flex-col\",\n                    children: images[currentPageIndex] ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"relative w-full \".concat(currentPageIndex === 0 ? 'h-full aspect-square' : 'aspect-square shrink-0', \" bg-slate-100\"),\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                                        src: images[currentPageIndex],\n                                        className: \"w-full h-full object-cover\"\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 615,\n                                        columnNumber: 17\n                                    }, undefined),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        onClick: handleRegenerateImage,\n                                        disabled: loadingImages[currentPageIndex],\n                                        className: \"absolute top-4 left-4 z-30 bg-white/80 hover:bg-white text-slate-700 p-2 rounded-full shadow-lg backdrop-blur-sm transition-all hover:scale-110 disabled:opacity-50\",\n                                        title: \"צייר מחדש את התמונה\",\n                                        children: loadingImages[currentPageIndex] ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"w-6 h-6 border-2 border-slate-700 border-t-transparent rounded-full animate-spin\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 624,\n                                            columnNumber: 21\n                                        }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            className: \"text-xl\",\n                                            children: \"\\uD83D\\uDD04\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 626,\n                                            columnNumber: 21\n                                        }, undefined)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 617,\n                                        columnNumber: 17\n                                    }, undefined),\n                                    currentPageIndex === 0 && audioEnabled && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"absolute bottom-6 right-6 flex flex-col items-end gap-2 z-20\",\n                                        children: [\n                                            audioError && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                className: \"text-xs text-red-500 bg-white px-2 py-1 rounded-full font-bold shadow-md\",\n                                                children: audioError\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                lineNumber: 633,\n                                                columnNumber: 36\n                                            }, undefined),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                onClick: (e)=>{\n                                                    e.stopPropagation();\n                                                    handleToggleAudio();\n                                                },\n                                                disabled: isLoadingAudio,\n                                                className: \"\\n                                flex items-center justify-center w-14 h-14 rounded-full shadow-lg border-4 border-white transition-all\\n                                \".concat(isPlaying ? 'bg-red-500 text-white animate-pulse' : 'bg-kid-blue text-white hover:bg-teal-400 hover:scale-110', \"\\n                                \").concat(audioError ? 'bg-slate-400 border-slate-200' : '', \"\\n                            \"),\n                                                children: isLoadingAudio ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                    className: \"w-6 h-6 border-3 border-white border-t-transparent rounded-full animate-spin\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                    lineNumber: 643,\n                                                    columnNumber: 41\n                                                }, undefined) : isPlaying ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"text-3xl\",\n                                                    children: \"⏹\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                    lineNumber: 643,\n                                                    columnNumber: 156\n                                                }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"text-3xl\",\n                                                    children: \"\\uD83D\\uDD0A\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                    lineNumber: 643,\n                                                    columnNumber: 194\n                                                }, undefined)\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                lineNumber: 634,\n                                                columnNumber: 21\n                                            }, undefined)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 632,\n                                        columnNumber: 19\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 614,\n                                columnNumber: 15\n                            }, undefined),\n                            currentPageIndex !== 0 && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"w-full book-text-container flex items-center justify-between flex-1\",\n                                children: [\n                                    audioEnabled && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        onClick: (e)=>{\n                                            e.stopPropagation();\n                                            handleToggleAudio();\n                                        },\n                                        disabled: isLoadingAudio,\n                                        className: \"\\n                                shrink-0 flex items-center justify-center w-12 h-12 rounded-full shadow-sm transition-all mr-6\\n                                \".concat(isPlaying ? 'bg-red-500 text-white animate-pulse' : 'bg-kid-blue text-white hover:bg-teal-400', \"\\n                                \").concat(isLoadingAudio ? 'opacity-70 cursor-wait' : '', \"\\n                                \").concat(audioError ? 'bg-slate-400' : '', \"\\n                            \"),\n                                        children: isLoadingAudio ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 664,\n                                            columnNumber: 41\n                                        }, undefined) : isPlaying ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            className: \"text-2xl\",\n                                            children: \"⏹\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 664,\n                                            columnNumber: 156\n                                        }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            className: \"text-2xl\",\n                                            children: \"\\uD83D\\uDD0A\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 664,\n                                            columnNumber: 194\n                                        }, undefined)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 654,\n                                        columnNumber: 21\n                                    }, undefined),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"flex-1 text-center flex items-center justify-center\",\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                            className: \"book-text\",\n                                            children: currentPage.hebrewText\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 669,\n                                            columnNumber: 21\n                                        }, undefined)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 668,\n                                        columnNumber: 19\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 651,\n                                columnNumber: 17\n                            }, undefined)\n                        ]\n                    }, void 0, true) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"w-full aspect-square flex flex-col items-center justify-center bg-slate-100\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"w-12 h-12 border-4 border-kid-blue border-t-transparent rounded-full animate-spin mb-4\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 678,\n                                columnNumber: 15\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                className: \"font-bold text-slate-500\",\n                                children: \"מצייר רגע קסום...\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 679,\n                                columnNumber: 15\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 677,\n                        columnNumber: 13\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                    lineNumber: 607,\n                    columnNumber: 9\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                lineNumber: 606,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"w-full bg-white/10 backdrop-blur-md p-6 flex justify-center items-center gap-10\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: handlePrev,\n                        disabled: currentPageIndex === 0,\n                        className: \"w-14 h-14 bg-white/20 hover:bg-white/40 text-white rounded-full text-2xl disabled:opacity-20 transition-all\",\n                        children: \"←\"\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 686,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                        className: \"text-white font-bold bg-black/40 px-6 py-2 rounded-full\",\n                        children: [\n                            \"עמוד \",\n                            currentPageIndex + 1,\n                            \" מתוך \",\n                            totalPages\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 687,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: handleNext,\n                        disabled: currentPageIndex === totalPages - 1,\n                        className: \"w-14 h-14 bg-kid-yellow hover:bg-yellow-400 text-slate-900 rounded-full text-2xl disabled:opacity-20 transition-all\",\n                        children: \"→\"\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 690,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                lineNumber: 685,\n                columnNumber: 7\n            }, undefined),\n            isExporting && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"fixed inset-0 z-[400] bg-slate-900/90 flex items-center justify-center text-white\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"text-center\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"w-16 h-16 border-4 border-kid-blue border-t-transparent rounded-full animate-spin mx-auto mb-6\"\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                            lineNumber: 696,\n                            columnNumber: 13\n                        }, undefined),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                            className: \"text-2xl font-bold font-fredoka\",\n                            children: exportProgress\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                            lineNumber: 697,\n                            columnNumber: 13\n                        }, undefined)\n                    ]\n                }, void 0, true, {\n                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                    lineNumber: 695,\n                    columnNumber: 11\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                lineNumber: 694,\n                columnNumber: 9\n            }, undefined)\n        ]\n    }, void 0, true, {\n        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n        lineNumber: 585,\n        columnNumber: 5\n    }, undefined);\n};\n_s(BookViewer, \"t6oHnyOc5fHACHQZGgQuPJY5mz0=\");\n_c = BookViewer;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (BookViewer);\nvar _c;\n$RefreshReg$(_c, \"BookViewer\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2NvbXBvbmVudHMvQm9va1ZpZXdlci50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUVtRTtBQUVZO0FBQ2Y7QUFDM0I7QUFDUjtBQUNKO0FBUXpCLDRDQUE0QztBQUM1QyxTQUFTVyxpQkFBaUJDLE1BQW1CO0lBQzNDLE1BQU1DLGNBQWNELE9BQU9FLGdCQUFnQjtJQUMzQyxNQUFNQyxhQUFhSCxPQUFPRyxVQUFVO0lBQ3BDLE1BQU1DLFNBQVMsR0FBRyxNQUFNO0lBQ3hCLE1BQU1DLFdBQVc7SUFDakIsTUFBTUMsaUJBQWlCRCxXQUFXO0lBQ2xDLE1BQU1FLGFBQWFOLGNBQWNLO0lBQ2pDLE1BQU1FLGdCQUFnQlIsT0FBT1MsTUFBTSxHQUFHRjtJQUN0QyxNQUFNRyxrQkFBa0I7SUFDeEIsTUFBTUMsaUJBQWlCRCxrQkFBa0JGO0lBQ3pDLE1BQU1JLGVBQWUsSUFBSUMsWUFBWUg7SUFDckMsTUFBTUksT0FBTyxJQUFJQyxTQUFTSDtJQUMxQixNQUFNSSxjQUFjLENBQUNGLE1BQWdCRyxRQUFnQkM7UUFDbkQsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlELE9BQU9ULE1BQU0sRUFBRVUsSUFBSztZQUN0Q0wsS0FBS00sUUFBUSxDQUFDSCxTQUFTRSxHQUFHRCxPQUFPRyxVQUFVLENBQUNGO1FBQzlDO0lBQ0Y7SUFDQUgsWUFBWUYsTUFBTSxHQUFHO0lBQ3JCQSxLQUFLUSxTQUFTLENBQUMsR0FBR1gsaUJBQWlCLEdBQUc7SUFDdENLLFlBQVlGLE1BQU0sR0FBRztJQUNyQkUsWUFBWUYsTUFBTSxJQUFJO0lBQ3RCQSxLQUFLUSxTQUFTLENBQUMsSUFBSSxJQUFJO0lBQ3ZCUixLQUFLUyxTQUFTLENBQUMsSUFBSW5CLFFBQVE7SUFDM0JVLEtBQUtTLFNBQVMsQ0FBQyxJQUFJdEIsYUFBYTtJQUNoQ2EsS0FBS1EsU0FBUyxDQUFDLElBQUluQixZQUFZO0lBQy9CVyxLQUFLUSxTQUFTLENBQUMsSUFBSW5CLGFB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VTs7MENBQ2IsOERBQUNEO2dDQUFJQyxXQUFVOzs7Ozs7MENBQ2YsOERBQUNsSztnQ0FBRWtLLFdBQVU7MENBQTJCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzBCQU1oRCw4REFBQ0Q7Z0JBQUlDLFdBQVU7O2tDQUNiLDhEQUFDQzt3QkFBT0MsU0FBUzdHO3dCQUFZK0csVUFBVXpMLHFCQUFxQjt3QkFBR3FMLFdBQVU7a0NBQThHOzs7Ozs7a0NBQ3ZMLDhEQUFDRzt3QkFBS0gsV0FBVTs7NEJBQTBEOzRCQUNsRXJMLG1CQUFtQjs0QkFBRTs0QkFBT21DOzs7Ozs7O2tDQUVwQyw4REFBQ21KO3dCQUFPQyxTQUFTOUc7d0JBQVlnSCxVQUFVekwscUJBQXFCbUMsYUFBYTt3QkFBR2tKLFdBQVU7a0NBQXNIOzs7Ozs7Ozs7Ozs7WUFHN01qSyw2QkFDQyw4REFBQ2dLO2dCQUFJQyxXQUFVOzBCQUNiLDRFQUFDRDtvQkFBSUMsV0FBVTs7c0NBQ2IsOERBQUNEOzRCQUFJQyxXQUFVOzs7Ozs7c0NBQ2YsOERBQUNPOzRCQUFHUCxXQUFVO3NDQUFtQy9KOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU03RDtHQWhvQk0xQjtLQUFBQTtBQWtvQk4saUVBQWVBLFVBQVVBLEVBQUMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcTEVOT1ZPXFxEZXNrdG9wXFxzaGFoYXJcXGJvb2thaVxcY29tcG9uZW50c1xcQm9va1ZpZXdlci50c3giXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBjbGllbnQnXG5cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VSZWYgfSBmcm9tICdyZWFjdCdcbmltcG9ydCB7IEJvb2sgfSBmcm9tICdAL3R5cGVzJ1xuaW1wb3J0IHsgZ2VuZXJhdGVQYWdlSW1hZ2UsIGdlbmVyYXRlUGFnZUF1ZGlvIH0gZnJvbSAnQC9zZXJ2aWNlcy9nZW1pbmlTZXJ2aWNlJ1xuaW1wb3J0IERyaXZlQ29ubmVjdEJ1dHRvbiBmcm9tICdAL2NvbXBvbmVudHMvRHJpdmVDb25uZWN0QnV0dG9uJ1xuaW1wb3J0IGh0bWwyY2FudmFzIGZyb20gJ2h0bWwyY2FudmFzJ1xuaW1wb3J0IHsganNQREYgfSBmcm9tICdqc3BkZidcbmltcG9ydCBKU1ppcCBmcm9tICdqc3ppcCdcblxuaW50ZXJmYWNlIEJvb2tWaWV3ZXJQcm9wcyB7XG4gIGJvb2s6IEJvb2s7XG4gIG9uVXBkYXRlQm9vazogKGJvb2s6IEJvb2spID0+IHZvaWQ7XG4gIG9uQ2xvc2U6ICgpID0+IHZvaWQ7XG59XG5cbi8vIEhlbHBlciB0byBjb252ZXJ0IEF1ZGlvQnVmZmVyIHRvIFdBViBCbG9iXG5mdW5jdGlvbiBhdWRpb0J1ZmZlclRvV2F2KGJ1ZmZlcjogQXVkaW9CdWZmZXIpOiBCbG9iIHtcbiAgY29uc3QgbnVtQ2hhbm5lbHMgPSBidWZmZXIubnVtYmVyT2ZDaGFubmVscztcbiAgY29uc3Qgc2FtcGxlUmF0ZSA9IGJ1ZmZlci5zYW1wbGVSYXRlO1xuICBjb25zdCBmb3JtYXQgPSAxOyAvLyBQQ01cbiAgY29uc3QgYml0RGVwdGggPSAxNjtcbiAgY29uc3QgYnl0ZXNQZXJTYW1wbGUgPSBiaXREZXB0aCAvIDg7XG4gIGNvbnN0IGJsb2NrQWxpZ24gPSBudW1DaGFubmVscyAqIGJ5dGVzUGVyU2FtcGxlO1xuICBjb25zdCBkYXRhQnl0ZUNvdW50ID0gYnVmZmVyLmxlbmd0aCAqIGJsb2NrQWxpZ247XG4gIGNvbnN0IGhlYWRlckJ5dGVDb3VudCA9IDQ0O1xuICBjb25zdCB0b3RhbEJ5dGVDb3VudCA9IGhlYWRlckJ5dGVDb3VudCArIGRhdGFCeXRlQ291bnQ7XG4gIGNvbnN0IGhlYWRlckJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihoZWFkZXJCeXRlQ291bnQpO1xuICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KGhlYWRlckJ1ZmZlcik7XG4gIGNvbnN0IHdyaXRlU3RyaW5nID0gKHZpZXc6IERhdGFWaWV3LCBvZmZzZXQ6IG51bWJlciwgc3RyaW5nOiBzdHJpbmcpID0+IHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0cmluZy5sZW5ndGg7IGkrKykge1xuICAgICAgdmlldy5zZXRVaW50OChvZmZzZXQgKyBpLCBzdHJpbmcuY2hhckNvZGVBdChpKSk7XG4gICAgfVxuICB9O1xuICB3cml0ZVN0cmluZyh2aWV3LCAwLCAnUklGRicpO1xuICB2aWV3LnNldFVpbnQzMig0LCB0b3RhbEJ5dGVDb3VudCAtIDgsIHRydWUpO1xuICB3cml0ZVN0cmluZyh2aWV3LCA4LCAnV0FWRScpO1xuICB3cml0ZVN0cmluZyh2aWV3LCAxMiwgJ2ZtdCAnKTtcbiAgdmlldy5zZXRVaW50MzIoMTYsIDE2LCB0cnVlKTtcbiAgdmlldy5zZXRVaW50MTYoMjAsIGZvcm1hdCwgdHJ1ZSk7XG4gIHZpZXcuc2V0VWludDE2KDIyLCBudW1DaGFubmVscywgdHJ1ZSk7XG4gIHZpZXcuc2V0VWludDMyKDI0LCBzYW1wbGVSYXRlLCB0cnVlKTtcbiAgdmlldy5zZXRVaW50MzIoMjgsIHNhbXBsZVJhdGUgKiBibG9ja0FsaWduLCB0cnVlKTtcbiAgdmlldy5zZXRVaW50MTYoMzIsIGJsb2NrQWxpZ24sIHRydWUpO1xuICB2aWV3LnNldFVpbnQxNigzNCwgYml0RGVwdGgsIHRydWUpO1xuICB3cml0ZVN0cmluZyh2aWV3LCAzNiwgJ2RhdGEnKTtcbiAgdmlldy5zZXRVaW50MzIoNDAsIGRhdGFCeXRlQ291bnQsIHRydWUpO1xuICBjb25zdCBkYXRhQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGRhdGFCeXRlQ291bnQpO1xuICBjb25zdCBkYXRhVmlldyA9IG5ldyBEYXRhVmlldyhkYXRhQnVmZmVyKTtcbiAgbGV0IG9mZnNldCA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYnVmZmVyLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChsZXQgY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCBudW1DaGFubmVsczsgY2hhbm5lbCsrKSB7XG4gICAgICBjb25zdCBzYW1wbGUgPSBidWZmZXIuZ2V0Q2hhbm5lbERhdGEoY2hhbm5lbClbaV07XG4gICAgICBjb25zdCBzID0gTWF0aC5tYXgoLTEsIE1hdGgubWluKDEsIHNhbXBsZSkpO1xuICAgICAgY29uc3QgaW50MTYgPSBzIDwgMCA/IHMgKiAweDgwMDAgOiBzICogMHg3RkZGO1xuICAgICAgZGF0YVZpZXcuc2V0SW50MTYob2Zmc2V0LCBpbnQxNiwgdHJ1ZSk7XG4gICAgICBvZmZzZXQgKz0gMjtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5ldyBCbG9iKFtoZWFkZXJCdWZmZXIsIGRhdGFCdWZmZXJdLCB7IHR5cGU6ICdhdWRpby93YXYnIH0pO1xufVxuXG5jb25zdCBCb29rVmlld2VyOiBSZWFjdC5GQzxCb29rVmlld2VyUHJvcHM+ID0gKHsgYm9vaywgb25VcGRhdGVCb29rLCBvbkNsb3NlIH0pID0+IHtcbiAgY29uc3QgW2N1cnJlbnRQYWdlSW5kZXgsIHNldEN1cnJlbnRQYWdlSW5kZXhdID0gdXNlU3RhdGUoMCk7XG4gIGNvbnN0IGJvb2tSZWYgPSB1c2VSZWYoYm9vayk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBib29rUmVmLmN1cnJlbnQgPSBib29rO1xuICB9LCBbYm9va10pO1xuXG4gIGNvbnN0IFtpbWFnZXMsIHNldEltYWdlc10gPSB1c2VTdGF0ZTxSZWNvcmQ8bnVtYmVyLCBzdHJpbmc+PigoKSA9PiB7XG4gICAgY29uc3QgaW5pdGlhbEltYWdlczogUmVjb3JkPG51bWJlciwgc3RyaW5nPiA9IHt9O1xuICAgIGJvb2sucGFnZXMuZm9yRWFjaCgocGFnZSwgaW5kZXgpID0+IHtcbiAgICAgIGlmIChwYWdlLmdlbmVyYXRlZEltYWdlVXJsKSB7XG4gICAgICAgIGluaXRpYWxJbWFnZXNbaW5kZXhdID0gcGFnZS5nZW5lcmF0ZWRJbWFnZVVybDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gaW5pdGlhbEltYWdlcztcbiAgfSk7XG5cbiAgY29uc3QgW2xvYWRpbmdJbWFnZXMsIHNldExvYWRpbmdJbWFnZXNdID0gdXNlU3RhdGU8UmVjb3JkPG51bWJlciwgYm9vbGVhbj4+KHt9KTtcblxuICBjb25zdCBbc2Vzc2lvblJlZmVyZW5jZUltYWdlLCBzZXRTZXNzaW9uUmVmZXJlbmNlSW1hZ2VdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4oXG4gICAgYm9vay5tZXRhZGF0YS5iYXNlQ2hhcmFjdGVySW1hZ2VVcmwgfHwgYm9vay5wYWdlcy5maW5kKHAgPT4gcC5nZW5lcmF0ZWRJbWFnZVVybCk/LmdlbmVyYXRlZEltYWdlVXJsIHx8IG51bGxcbiAgKTtcblxuICBjb25zdCBbaXNFeHBvcnRpbmcsIHNldElzRXhwb3J0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2V4cG9ydFByb2dyZXNzLCBzZXRFeHBvcnRQcm9ncmVzc10gPSB1c2VTdGF0ZSgnJyk7XG5cbiAgY29uc3QgW2lzUGxheWluZywgc2V0SXNQbGF5aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2lzTG9hZGluZ0F1ZGlvLCBzZXRJc0xvYWRpbmdBdWRpb10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFthdWRpb0Vycm9yLCBzZXRBdWRpb0Vycm9yXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbYXVkaW9CdWZmZXJzLCBzZXRBdWRpb0J1ZmZlcnNdID0gdXNlU3RhdGU8UmVjb3JkPG51bWJlciwgQXVkaW9CdWZmZXI+Pih7fSk7XG4gIGNvbnN0IGF1ZGlvQ29udGV4dFJlZiA9IHVzZVJlZjxBdWRpb0NvbnRleHQgfCBudWxsPihudWxsKTtcbiAgY29uc3QgYXVkaW9Tb3VyY2VSZWYgPSB1c2VSZWY8QXVkaW9CdWZmZXJTb3VyY2VOb2RlIHwgbnVsbD4obnVsbCk7XG5cbiAgY29uc3QgY3VycmVudFBhZ2UgPSBib29rLnBhZ2VzW2N1cnJlbnRQYWdlSW5kZXhdO1xuICBjb25zdCB0b3RhbFBhZ2VzID0gYm9vay5wYWdlcy5sZW5ndGg7XG4gIGNvbnN0IGF1ZGlvRW5hYmxlZCA9IGJvb2subWV0YWRhdGEuYXVkaW9Db25maWc/LmVuYWJsZWQgPz8gdHJ1ZTtcbiAgY29uc3Qgdm9pY2VOYW1lID0gYm9vay5tZXRhZGF0YS5hdWRpb0NvbmZpZz8udm9pY2VOYW1lIHx8ICdQdWNrJztcblxuICBjb25zdCBmdWxsQ2hhcmFjdGVyRGVzY3JpcHRpb24gPSB1c2VNZW1vKCgpID0+IHtcbiAgICBsZXQgZGVzYyA9IGBNYWluIENoYXJhY3RlcjogJHtib29rLm1ldGFkYXRhLm1haW5DaGFyYWN0ZXJEZXNjcmlwdGlvbn0uYDtcbiAgICBpZiAoYm9vay5tZXRhZGF0YS5tYWluQ2hhcmFjdGVyRGlzdGluY3RpdmVNYXJrKSB7XG4gICAgICBkZXNjICs9IGAgRElTVElOQ1RJVkUgRkVBVFVSRTogJHtib29rLm1ldGFkYXRhLm1haW5DaGFyYWN0ZXJEaXN0aW5jdGl2ZU1hcmt9IChNdXN0IGFwcGVhciBpbiBldmVyeSBpbWFnZSkuYDtcbiAgICB9XG4gICAgaWYgKGJvb2subWV0YWRhdGEuc2Vjb25kYXJ5Q2hhcmFjdGVyRGVzY3JpcHRpb24pIHtcbiAgICAgIGRlc2MgKz0gYFxcblNlY29uZGFyeSBDaGFyYWN0ZXIgKFNpZGVraWNrKTogJHtib29rLm1ldGFkYXRhLnNlY29uZGFyeUNoYXJhY3RlckRlc2NyaXB0aW9ufSAoVGhpcyBhcHBlYXJhbmNlIE1VU1QgYmUgY29uc2lzdGVudCBhY3Jvc3MgYWxsIHBhZ2VzKS5gO1xuICAgICAgaWYgKGJvb2subWV0YWRhdGEuc2Vjb25kYXJ5Q2hhcmFjdGVyRGlzdGluY3RpdmVNYXJrKSB7XG4gICAgICAgIGRlc2MgKz0gYCBESVNUSU5DVElWRSBGRUFUVVJFOiAke2Jvb2subWV0YWRhdGEuc2Vjb25kYXJ5Q2hhcmFjdGVyRGlzdGluY3RpdmVNYXJrfS5gO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGVzYztcbiAgfSwgW2Jvb2subWV0YWRhdGFdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBzdG9wQXVkaW8oKTtcbiAgICAgIGlmIChhdWRpb0NvbnRleHRSZWYuY3VycmVudCkge1xuICAgICAgICBhdWRpb0NvbnRleHRSZWYuY3VycmVudC5jbG9zZSgpO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHN0b3BBdWRpbygpO1xuICAgIHNldEF1ZGlvRXJyb3IobnVsbCk7XG4gIH0sIFtjdXJyZW50UGFnZUluZGV4XSk7XG5cbiAgY29uc3Qgc3RvcEF1ZGlvID0gKCkgPT4ge1xuICAgIGlmIChhdWRpb1NvdXJjZVJlZi5jdXJyZW50KSB7XG4gICAgICB0cnkgeyBhdWRpb1NvdXJjZVJlZi5jdXJyZW50LnN0b3AoKTsgfSBjYXRjaCAoZSkgeyB9XG4gICAgICBhdWRpb1NvdXJjZVJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICB9XG4gICAgc2V0SXNQbGF5aW5nKGZhbHNlKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVDaGFuZ2VLZXkgPSAoKSA9PiB7XG4gICAgY29uc3QgYWlzdHVkaW8gPSAod2luZG93IGFzIGFueSkuYWlzdHVkaW87XG4gICAgaWYgKGFpc3R1ZGlvKSBhaXN0dWRpby5vcGVuU2VsZWN0S2V5KCk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlVG9nZ2xlQXVkaW8gPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFhdWRpb0VuYWJsZWQpIHJldHVybjtcblxuICAgIGlmIChpc1BsYXlpbmcpIHtcbiAgICAgIHN0b3BBdWRpbygpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHNldEF1ZGlvRXJyb3IobnVsbCk7XG5cbiAgICBpZiAoIWF1ZGlvQ29udGV4dFJlZi5jdXJyZW50KSB7XG4gICAgICBhdWRpb0NvbnRleHRSZWYuY3VycmVudCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCAod2luZG93IGFzIGFueSkud2Via2l0QXVkaW9Db250ZXh0KSh7IHNhbXBsZVJhdGU6IDI0MDAwIH0pO1xuICAgIH1cblxuICAgIGlmIChhdWRpb0NvbnRleHRSZWYuY3VycmVudC5zdGF0ZSA9PT0gJ3N1c3BlbmRlZCcpIHtcbiAgICAgIGF3YWl0IGF1ZGlvQ29udGV4dFJlZi5jdXJyZW50LnJlc3VtZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IGN0eCA9IGF1ZGlvQ29udGV4dFJlZi5jdXJyZW50O1xuXG4gICAgaWYgKGF1ZGlvQnVmZmVyc1tjdXJyZW50UGFnZUluZGV4XSkge1xuICAgICAgcGxheUJ1ZmZlcihhdWRpb0J1ZmZlcnNbY3VycmVudFBhZ2VJbmRleF0sIGN0eCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc2V0SXNMb2FkaW5nQXVkaW8odHJ1ZSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRleHRUb1JlYWQgPSBjdXJyZW50UGFnZUluZGV4ID09PSAwID8gYm9vay5tZXRhZGF0YS50aXRsZSA6IGN1cnJlbnRQYWdlLmhlYnJld1RleHQ7XG4gICAgICBjb25zdCBidWZmZXIgPSBhd2FpdCBnZW5lcmF0ZVBhZ2VBdWRpbyh0ZXh0VG9SZWFkLCBjdHgsIHZvaWNlTmFtZSk7XG4gICAgICBpZiAoYnVmZmVyKSB7XG4gICAgICAgIHNldEF1ZGlvQnVmZmVycyhwcmV2ID0+ICh7IC4uLnByZXYsIFtjdXJyZW50UGFnZUluZGV4XTogYnVmZmVyIH0pKTtcbiAgICAgICAgcGxheUJ1ZmZlcihidWZmZXIsIGN0eCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXRBdWRpb0Vycm9yKFwi16rXp9ec15Qg15HXmdem15nXqNeqINeQ15XXk9eZ15VcIik7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgIHNldEF1ZGlvRXJyb3IoXCLXqdeS15nXkNeUINeb15zXnNeZ16pcIik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzTG9hZGluZ0F1ZGlvKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcGxheUJ1ZmZlciA9IChidWZmZXI6IEF1ZGlvQnVmZmVyLCBjdHg6IEF1ZGlvQ29udGV4dCkgPT4ge1xuICAgIGNvbnN0IHNvdXJjZSA9IGN0eC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcbiAgICBzb3VyY2UuYnVmZmVyID0gYnVmZmVyO1xuICAgIHNvdXJjZS5jb25uZWN0KGN0eC5kZXN0aW5hdGlvbik7XG4gICAgc291cmNlLm9uZW5kZWQgPSAoKSA9PiBzZXRJc1BsYXlpbmcoZmFsc2UpO1xuICAgIGF1ZGlvU291cmNlUmVmLmN1cnJlbnQgPSBzb3VyY2U7XG4gICAgc291cmNlLnN0YXJ0KCk7XG4gICAgc2V0SXNQbGF5aW5nKHRydWUpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZU5leHQgPSAoKSA9PiB7IGlmIChjdXJyZW50UGFnZUluZGV4IDwgdG90YWxQYWdlcyAtIDEpIHNldEN1cnJlbnRQYWdlSW5kZXgoKHByZXYpID0+IHByZXYgKyAxKTsgfTtcbiAgY29uc3QgaGFuZGxlUHJldiA9ICgpID0+IHsgaWYgKGN1cnJlbnRQYWdlSW5kZXggPiAwKSBzZXRDdXJyZW50UGFnZUluZGV4KChwcmV2KSA9PiBwcmV2IC0gMSk7IH07XG5cbiAgY29uc3QgdXBkYXRlQm9va1N0YXRlID0gKGluZGV4OiBudW1iZXIsIHVybDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgY3VycmVudEJvb2tTdGF0ZSA9IGJvb2tSZWYuY3VycmVudDtcbiAgICBjb25zdCB1cGRhdGVkUGFnZXMgPSBbLi4uY3VycmVudEJvb2tTdGF0ZS5wYWdlc107XG4gICAgdXBkYXRlZFBhZ2VzW2luZGV4XSA9IHsgLi4udXBkYXRlZFBhZ2VzW2luZGV4XSwgZ2VuZXJhdGVkSW1hZ2VVcmw6IHVybCB9O1xuICAgIGNvbnN0IHVwZGF0ZWRCb29rID0geyAuLi5jdXJyZW50Qm9va1N0YXRlLCBwYWdlczogdXBkYXRlZFBhZ2VzIH07XG4gICAgb25VcGRhdGVCb29rKHVwZGF0ZWRCb29rKTtcbiAgfTtcblxuICBjb25zdCBsb2FkSW1hZ2UgPSBhc3luYyAocGFnZUluZGV4OiBudW1iZXIsIGFjdGlvblByb21wdDogc3RyaW5nKSA9PiB7XG4gICAgaWYgKGltYWdlc1twYWdlSW5kZXhdIHx8IGxvYWRpbmdJbWFnZXNbcGFnZUluZGV4XSkgcmV0dXJuO1xuXG4gICAgaWYgKGJvb2tSZWYuY3VycmVudC5wYWdlc1twYWdlSW5kZXhdLmdlbmVyYXRlZEltYWdlVXJsKSB7XG4gICAgICBzZXRJbWFnZXMoKHByZXYpID0+ICh7IC4uLnByZXYsIFtwYWdlSW5kZXhdOiBib29rUmVmLmN1cnJlbnQucGFnZXNbcGFnZUluZGV4XS5nZW5lcmF0ZWRJbWFnZVVybCEgfSkpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHNldExvYWRpbmdJbWFnZXMoKHByZXYpID0+ICh7IC4uLnByZXYsIFtwYWdlSW5kZXhdOiB0cnVlIH0pKTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVmZXJlbmNlVG9Vc2UgPSBib29rUmVmLmN1cnJlbnQubWV0YWRhdGEuYmFzZUNoYXJhY3RlckltYWdlVXJsIHx8IHNlc3Npb25SZWZlcmVuY2VJbWFnZTtcbiAgICAgIGNvbnN0IGlzQ292ZXIgPSBwYWdlSW5kZXggPT09IDA7XG4gICAgICBjb25zdCB0ZXh0VG9SZW5kZXIgPSBpc0NvdmVyID8gYm9va1JlZi5jdXJyZW50Lm1ldGFkYXRhLnRpdGxlIDogdW5kZWZpbmVkO1xuXG4gICAgICBjb25zdCB1cmwgPSBhd2FpdCBnZW5lcmF0ZVBhZ2VJbWFnZShcbiAgICAgICAgYWN0aW9uUHJvbXB0LFxuICAgICAgICBmdWxsQ2hhcmFjdGVyRGVzY3JpcHRpb24sXG4gICAgICAgIGJvb2tSZWYuY3VycmVudC5tZXRhZGF0YS5hcnRTdHlsZSxcbiAgICAgICAgcmVmZXJlbmNlVG9Vc2UgfHwgdW5kZWZpbmVkLFxuICAgICAgICBpc0NvdmVyLFxuICAgICAgICB0ZXh0VG9SZW5kZXJcbiAgICAgICk7XG5cbiAgICAgIGlmICh1cmwpIHtcbiAgICAgICAgc2V0SW1hZ2VzKChwcmV2KSA9PiAoeyAuLi5wcmV2LCBbcGFnZUluZGV4XTogdXJsIH0pKTtcbiAgICAgICAgaWYgKCFyZWZlcmVuY2VUb1VzZSAmJiAhc2Vzc2lvblJlZmVyZW5jZUltYWdlKSB7XG4gICAgICAgICAgc2V0U2Vzc2lvblJlZmVyZW5jZUltYWdlKHVybCk7XG4gICAgICAgIH1cbiAgICAgICAgdXBkYXRlQm9va1N0YXRlKHBhZ2VJbmRleCwgdXJsKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGxvYWQgcGFnZSBpbWFnZTpcIiwgZXJyKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRMb2FkaW5nSW1hZ2VzKChwcmV2KSA9PiAoeyAuLi5wcmV2LCBbcGFnZUluZGV4XTogZmFsc2UgfSkpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVSZWdlbmVyYXRlSW1hZ2UgPSBhc3luYyAoZTogUmVhY3QuTW91c2VFdmVudCkgPT4ge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgY29uc3QgcGFnZUluZGV4ID0gY3VycmVudFBhZ2VJbmRleDtcbiAgICBpZiAobG9hZGluZ0ltYWdlc1twYWdlSW5kZXhdKSByZXR1cm47XG5cbiAgICBzZXRMb2FkaW5nSW1hZ2VzKChwcmV2KSA9PiAoeyAuLi5wcmV2LCBbcGFnZUluZGV4XTogdHJ1ZSB9KSk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVmZXJlbmNlVG9Vc2UgPSBib29rUmVmLmN1cnJlbnQubWV0YWRhdGEuYmFzZUNoYXJhY3RlckltYWdlVXJsIHx8IHNlc3Npb25SZWZlcmVuY2VJbWFnZTtcbiAgICAgIGNvbnN0IGlzQ292ZXIgPSBwYWdlSW5kZXggPT09IDA7XG4gICAgICBjb25zdCB0ZXh0VG9SZW5kZXIgPSBpc0NvdmVyID8gYm9va1JlZi5jdXJyZW50Lm1ldGFkYXRhLnRpdGxlIDogdW5kZWZpbmVkO1xuXG4gICAgICBjb25zdCB1cmwgPSBhd2FpdCBnZW5lcmF0ZVBhZ2VJbWFnZShcbiAgICAgICAgYm9va1JlZi5jdXJyZW50LnBhZ2VzW3BhZ2VJbmRleF0uaW1hZ2VQcm9tcHQsXG4gICAgICAgIGZ1bGxDaGFyYWN0ZXJEZXNjcmlwdGlvbixcbiAgICAgICAgYm9va1JlZi5jdXJyZW50Lm1ldGFkYXRhLmFydFN0eWxlLFxuICAgICAgICByZWZlcmVuY2VUb1VzZSB8fCB1bmRlZmluZWQsXG4gICAgICAgIGlzQ292ZXIsXG4gICAgICAgIHRleHRUb1JlbmRlclxuICAgICAgKTtcblxuICAgICAgaWYgKHVybCkge1xuICAgICAgICBzZXRJbWFnZXMoKHByZXYpID0+ICh7IC4uLnByZXYsIFtwYWdlSW5kZXhdOiB1cmwgfSkpO1xuICAgICAgICBpZiAocGFnZUluZGV4ID09PSAwICYmICFib29rUmVmLmN1cnJlbnQubWV0YWRhdGEuYmFzZUNoYXJhY3RlckltYWdlVXJsKSB7XG4gICAgICAgICAgc2V0U2Vzc2lvblJlZmVyZW5jZUltYWdlKHVybCk7XG4gICAgICAgIH1cbiAgICAgICAgdXBkYXRlQm9va1N0YXRlKHBhZ2VJbmRleCwgdXJsKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIlJlZ2VuZXJhdGlvbiBmYWlsZWRcIiwgZXJyb3IpO1xuICAgICAgYWxlcnQoXCLXqdeS15nXkNeUINeR15nXpteZ16jXqiDXlNeq157Xldeg15Qg157Xl9eT16lcIik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldExvYWRpbmdJbWFnZXMoKHByZXYpID0+ICh7IC4uLnByZXYsIFtwYWdlSW5kZXhdOiBmYWxzZSB9KSk7XG4gICAgfVxuICB9O1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgcGFnZSA9IGJvb2sucGFnZXNbY3VycmVudFBhZ2VJbmRleF07XG4gICAgaWYgKHBhZ2UgJiYgIWltYWdlc1tjdXJyZW50UGFnZUluZGV4XSkge1xuICAgICAgbG9hZEltYWdlKGN1cnJlbnRQYWdlSW5kZXgsIHBhZ2UuaW1hZ2VQcm9tcHQpO1xuICAgIH1cbiAgfSwgW2N1cnJlbnRQYWdlSW5kZXhdKTtcblxuICBjb25zdCBwcmVwYXJlRXhwb3J0Q2FudmFzID0gYXN5bmMgKGk6IG51bWJlciwgaW1nVXJsOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBpc0NvdmVyID0gaSA9PT0gMDtcblxuICAgIC8vIEVYUE9SVCBMQVlPVVQgU1RSQVRFR1k6XG4gICAgLy8gQ292ZXI6IDEwMjR4MTAyNCBTcXVhcmUgKEltYWdlIGNvbnRhaW5zIHRpdGxlLCBubyBleHRyYSB0ZXh0IGFyZWEpXG4gICAgLy8gSW5uZXI6IDEwMjR4MTI4MCAoMTAyNHgxMDI0IEltYWdlIFRvcCArIDEwMjR4MjU2IFRleHQgQXJlYSBCb3R0b20pXG5cbiAgICBjb25zdCB3aWR0aCA9IDEwMjQ7XG4gICAgY29uc3QgaGVpZ2h0ID0gaXNDb3ZlciA/IDEwMjQgOiAxMjgwO1xuXG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgO1xuICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHtoZWlnaHR9cHhgO1xuICAgIGNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgY29udGFpbmVyLnN0eWxlLmxlZnQgPSAnLTk5OTlweCc7XG4gICAgY29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjZmZmZmZmJztcbiAgICBjb250YWluZXIuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcblxuICAgIGlmIChpc0NvdmVyKSB7XG4gICAgICAvLyBDb3ZlciBpcyBzaW1wbGUgZnVsbCBpbWFnZVxuICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGA8aW1nIHNyYz1cIiR7aW1nVXJsfVwiIHN0eWxlPVwid2lkdGg6IDEwMjRweDsgaGVpZ2h0OiAxMDI0cHg7IG9iamVjdC1maXQ6IGNvdmVyO1wiIC8+YDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSW5uZXIgcGFnZXM6IFZlcnRpY2FsIFN0YWNrLiBJbWFnZSBUb3AsIFRleHQgQm90dG9tLlxuICAgICAgY29uc3QgdGV4dCA9IGJvb2sucGFnZXNbaV0uaGVicmV3VGV4dCB8fCBcIlwiO1xuICAgICAgLy8gSW1wcm92ZWQgdGV4dCBzdHlsaW5nIG1hdGNoaW5nIGdsb2JhbHMuY3NzIHVwZGF0ZXNcbiAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgd2lkdGg6IDEwMjRweDsgaGVpZ2h0OiAxMjgwcHg7IGJhY2tncm91bmQ6IHdoaXRlO1wiPlxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJ3aWR0aDogMTAyNHB4OyBoZWlnaHQ6IDEwMDBweDsgZmxleC1zaHJpbms6IDA7IGJhY2tncm91bmQtY29sb3I6ICNmOGZhZmM7XCI+XG4gICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwiJHtpbWdVcmx9XCIgc3R5bGU9XCJ3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyBvYmplY3QtZml0OiBjb3ZlcjsgZGlzcGxheTogYmxvY2s7XCIgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwiXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDI0cHg7IFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDI4MHB4OyBcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDsgXG4gICAgICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7IFxuICAgICAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDMycHggNDhweDsgXG4gICAgICAgICAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IFxuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAjZmZmZGY1IDAlLCAjZmZmOGU3IDMwJSwgI2ZkZWNjOCA3MCUsICNmYmUzYjIgMTAwJSk7XG4gICAgICAgICAgICAgICAgICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMnB4IDAgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpLCBpbnNldCAwIC0ycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4wNSk7XG4gICAgICAgICAgICAgICAgICAgIGJvcmRlci10b3A6IDNweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOSk7XG4gICAgICAgICAgICAgICAgXCI+XG4gICAgICAgICAgICAgICAgICAgICA8cCBzdHlsZT1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAwOyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAnUnViaWsnLCAnSGVlYm8nLCAnQXJpYWwnLCBzYW5zLXNlcmlmOyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogNDRweDsgXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNjAwOyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjMmExYTBhOyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogcnRsOyBcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsgXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMS43O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC1zaGFkb3c6IDAgMXB4IDAgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpLCAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjA2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldHRlci1zcGFjaW5nOiAwLjAxZW07XG4gICAgICAgICAgICAgICAgICAgICBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICR7dGV4dH1cbiAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgO1xuICAgIH1cblxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwKSk7XG4gICAgY29uc3QgY2FudmFzID0gYXdhaXQgaHRtbDJjYW52YXMoY29udGFpbmVyLCB7IHNjYWxlOiAxLCB1c2VDT1JTOiB0cnVlLCB3aWR0aCwgaGVpZ2h0IH0pO1xuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoY29udGFpbmVyKTtcbiAgICByZXR1cm4gY2FudmFzO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZURvd25sb2FkWklQID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmIChpc0V4cG9ydGluZykgcmV0dXJuO1xuICAgIHNldElzRXhwb3J0aW5nKHRydWUpO1xuICAgIHNldEV4cG9ydFByb2dyZXNzKCfXnteb15nXnyDXl9eR15nXnNeUINee15zXkNeULi4uJyk7XG4gICAgY29uc3QgemlwID0gbmV3IEpTWmlwKCk7XG4gICAgLy8gQTQgUG9ydHJhaXQgZm9yIHN0YW5kYXJkaXplZCBwcmludGluZ1xuICAgIGNvbnN0IHBkZiA9IG5ldyBqc1BERigncCcsICdtbScsICdhNCcpO1xuICAgIGNvbnN0IHBhZ2VXaWR0aCA9IDIxMDtcblxuICAgIHRyeSB7XG4gICAgICB6aXAuZmlsZShcInNlcXVlbF9kYXRhLmpzb25cIiwgSlNPTi5zdHJpbmdpZnkoYm9va1JlZi5jdXJyZW50LCBudWxsLCAyKSk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9vay5wYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBzZXRFeHBvcnRQcm9ncmVzcyhg157XoteR15Mg16LXnteV15MgJHtpICsgMX0g157XqteV15ogJHtib29rLnBhZ2VzLmxlbmd0aH0uLi5gKTtcbiAgICAgICAgbGV0IGltZ1VybCA9IGltYWdlc1tpXTtcbiAgICAgICAgY29uc3QgaXNDb3ZlciA9IGkgPT09IDA7XG5cbiAgICAgICAgaWYgKCFpbWdVcmwpIHtcbiAgICAgICAgICBjb25zdCByZWZlcmVuY2VUb1VzZSA9IGJvb2tSZWYuY3VycmVudC5tZXRhZGF0YS5iYXNlQ2hhcmFjdGVySW1hZ2VVcmwgfHwgc2Vzc2lvblJlZmVyZW5jZUltYWdlO1xuICAgICAgICAgIGNvbnN0IHRleHRUb1JlbmRlciA9IGlzQ292ZXIgPyBib29rUmVmLmN1cnJlbnQubWV0YWRhdGEudGl0bGUgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgaW1nVXJsID0gYXdhaXQgZ2VuZXJhdGVQYWdlSW1hZ2UoXG4gICAgICAgICAgICBib29rLnBhZ2VzW2ldLmltYWdlUHJvbXB0LFxuICAgICAgICAgICAgZnVsbENoYXJhY3RlckRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgYm9vay5tZXRhZGF0YS5hcnRTdHlsZSxcbiAgICAgICAgICAgIHJlZmVyZW5jZVRvVXNlIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGlzQ292ZXIsXG4gICAgICAgICAgICB0ZXh0VG9SZW5kZXJcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChpbWdVcmwpIHtcbiAgICAgICAgICAgIHNldEltYWdlcyhwcmV2ID0+ICh7IC4uLnByZXYsIFtpXTogaW1nVXJsIH0pKTtcbiAgICAgICAgICAgIGlmICghcmVmZXJlbmNlVG9Vc2UgJiYgIXNlc3Npb25SZWZlcmVuY2VJbWFnZSkgc2V0U2Vzc2lvblJlZmVyZW5jZUltYWdlKGltZ1VybCk7XG4gICAgICAgICAgICB1cGRhdGVCb29rU3RhdGUoaSwgaW1nVXJsKTsgLy8gU3luYyFcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW1nVXJsKSB7XG4gICAgICAgICAgY29uc3QgY2FudmFzID0gYXdhaXQgcHJlcGFyZUV4cG9ydENhbnZhcyhpLCBpbWdVcmwpO1xuICAgICAgICAgIGNvbnN0IHBuZ0Jsb2IgPSBhd2FpdCBuZXcgUHJvbWlzZTxCbG9iIHwgbnVsbD4ocmVzb2x2ZSA9PiBjYW52YXMudG9CbG9iKHJlc29sdmUsICdpbWFnZS9wbmcnKSk7XG5cbiAgICAgICAgICBpZiAocG5nQmxvYikgemlwLmZpbGUoaSA9PT0gMCA/ICcwMF9DT1ZFUi5wbmcnIDogYFBBR0VfJHtTdHJpbmcoaSkucGFkU3RhcnQoMiwgJzAnKX0ucG5nYCwgcG5nQmxvYik7XG5cbiAgICAgICAgICBjb25zdCBpbWdEYXRhID0gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvanBlZycsIDAuOSk7XG5cbiAgICAgICAgICAvLyBQREYgTGF5b3V0XG4gICAgICAgICAgY29uc3QgY2FudmFzUmF0aW8gPSBjYW52YXMuaGVpZ2h0IC8gY2FudmFzLndpZHRoO1xuICAgICAgICAgIGNvbnN0IHBkZkltZ0hlaWdodCA9IHBhZ2VXaWR0aCAqIGNhbnZhc1JhdGlvO1xuXG4gICAgICAgICAgLy8gSWYgaGVpZ2h0IGV4Y2VlZHMgQTQgKDI5N21tKSwgc2NhbGUgZG93biB0byBmaXRcbiAgICAgICAgICBsZXQgcmVuZGVyV2lkdGggPSBwYWdlV2lkdGg7XG4gICAgICAgICAgbGV0IHJlbmRlckhlaWdodCA9IHBkZkltZ0hlaWdodDtcbiAgICAgICAgICBpZiAocmVuZGVySGVpZ2h0ID4gMjk3KSB7XG4gICAgICAgICAgICBjb25zdCBzY2FsZSA9IDI5NyAvIHJlbmRlckhlaWdodDtcbiAgICAgICAgICAgIHJlbmRlckhlaWdodCA9IDI5NztcbiAgICAgICAgICAgIHJlbmRlcldpZHRoID0gcGFnZVdpZHRoICogc2NhbGU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHhPZmZzZXQgPSAoMjEwIC0gcmVuZGVyV2lkdGgpIC8gMjtcblxuICAgICAgICAgIHBkZi5hZGRJbWFnZShpbWdEYXRhLCAnSlBFRycsIHhPZmZzZXQsIDAsIHJlbmRlcldpZHRoLCByZW5kZXJIZWlnaHQpO1xuXG4gICAgICAgICAgaWYgKGkgPCBib29rLnBhZ2VzLmxlbmd0aCAtIDEpIHBkZi5hZGRQYWdlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYXVkaW9FbmFibGVkKSB7XG4gICAgICAgICAgbGV0IGF1ZGlvQnVmID0gYXVkaW9CdWZmZXJzW2ldO1xuICAgICAgICAgIGlmICghYXVkaW9CdWYpIHtcbiAgICAgICAgICAgIGlmICghYXVkaW9Db250ZXh0UmVmLmN1cnJlbnQpIGF1ZGlvQ29udGV4dFJlZi5jdXJyZW50ID0gbmV3ICh3aW5kb3cuQXVkaW9Db250ZXh0IHx8ICh3aW5kb3cgYXMgYW55KS53ZWJraXRBdWRpb0NvbnRleHQpKHsgc2FtcGxlUmF0ZTogMjQwMDAgfSk7XG4gICAgICAgICAgICBjb25zdCBidWYgPSBhd2FpdCBnZW5lcmF0ZVBhZ2VBdWRpbyhpID09PSAwID8gYm9vay5tZXRhZGF0YS50aXRsZSA6IGJvb2sucGFnZXNbaV0uaGVicmV3VGV4dCwgYXVkaW9Db250ZXh0UmVmLmN1cnJlbnQsIHZvaWNlTmFtZSk7XG4gICAgICAgICAgICBpZiAoYnVmKSB7IGF1ZGlvQnVmID0gYnVmOyBzZXRBdWRpb0J1ZmZlcnMocHJldiA9PiAoeyAuLi5wcmV2LCBbaV06IGJ1ZiB9KSk7IH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGF1ZGlvQnVmKSB6aXAuZmlsZShpID09PSAwID8gJzAwX0FVRElPX1RpdGxlLndhdicgOiBgQVVESU9fUGFnZV8ke1N0cmluZyhpKS5wYWRTdGFydCgyLCAnMCcpfS53YXZgLCBhdWRpb0J1ZmZlclRvV2F2KGF1ZGlvQnVmKSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgcGRmQmxvYiA9IHBkZi5vdXRwdXQoJ2Jsb2InKTtcbiAgICAgIHppcC5maWxlKGAke2Jvb2subWV0YWRhdGEudGl0bGV9LnBkZmAsIHBkZkJsb2IpO1xuXG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgemlwLmdlbmVyYXRlQXN5bmMoeyB0eXBlOiAnYmxvYicgfSk7XG5cbiAgICAgIC8vIFVwbG9hZCB0byBHb29nbGUgRHJpdmUgaWYgY29ubmVjdGVkXG4gICAgICBsZXQgZHJpdmVMaW5rczogeyB6aXBMaW5rOiBzdHJpbmc7IHBkZkxpbms6IHN0cmluZyB9IHwgbnVsbCA9IG51bGw7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGhhc0RyaXZlQWNjZXNzLCB1cGxvYWRCb29rVG9Ecml2ZSB9ID0gYXdhaXQgaW1wb3J0KCdAL3NlcnZpY2VzL2dvb2dsZURyaXZlJyk7XG4gICAgICAgIGlmIChoYXNEcml2ZUFjY2VzcygpKSB7XG4gICAgICAgICAgc2V0RXhwb3J0UHJvZ3Jlc3MoJ9ee16LXnNeUINecLUdvb2dsZSBEcml2ZS4uLicpO1xuICAgICAgICAgIGRyaXZlTGlua3MgPSBhd2FpdCB1cGxvYWRCb29rVG9Ecml2ZShjb250ZW50LCBwZGZCbG9iLCBib29rLm1ldGFkYXRhLnRpdGxlKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZHJpdmVFcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0RyaXZlIHVwbG9hZCBmYWlsZWQ6JywgZHJpdmVFcnJvcik7XG4gICAgICB9XG5cbiAgICAgIC8vIFNhdmUgdG8gRmlyZXN0b3JlIFdJVEggRHJpdmUgbGlua3NcbiAgICAgIHNldEV4cG9ydFByb2dyZXNzKCfXqdeV157XqCDXnteZ15PXoi4uLicpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBzYXZlQm9va1Byb21wdHMgfSA9IGF3YWl0IGltcG9ydCgnQC9zZXJ2aWNlcy9maXJlYmFzZScpO1xuICAgICAgICBhd2FpdCBzYXZlQm9va1Byb21wdHMoe1xuICAgICAgICAgIGJvb2tUaXRsZTogYm9vay5tZXRhZGF0YS50aXRsZSxcbiAgICAgICAgICBtYWluQ2hhcmFjdGVyOiBib29rLm1ldGFkYXRhLm1haW5DaGFyYWN0ZXJEZXNjcmlwdGlvbiB8fCAnJyxcbiAgICAgICAgICBhcnRTdHlsZTogYm9vay5tZXRhZGF0YS5hcnRTdHlsZSxcbiAgICAgICAgICB0b3BpYzogYm9vay5tZXRhZGF0YS5tYWluVGhlbWUgfHwgJycsXG4gICAgICAgICAgaW1hZ2VQcm9tcHRzOiBib29rLnBhZ2VzLm1hcChwID0+IHAuaW1hZ2VQcm9tcHQpLFxuICAgICAgICAgIGRyaXZlWmlwVXJsOiBkcml2ZUxpbmtzPy56aXBMaW5rLFxuICAgICAgICAgIGRyaXZlUGRmVXJsOiBkcml2ZUxpbmtzPy5wZGZMaW5rXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZygnQm9vayBzYXZlZCB0byBGaXJlc3RvcmUgd2l0aCBEcml2ZSBsaW5rcyEnKTtcbiAgICAgIH0gY2F0Y2ggKGZpcmViYXNlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdGaXJlc3RvcmUgc2F2ZSBmYWlsZWQ6JywgZmlyZWJhc2VFcnJvcik7XG4gICAgICB9XG5cbiAgICAgIC8vIERvd25sb2FkIGxvY2FsbHlcbiAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGNvbnRlbnQpO1xuICAgICAgY29uc3Qgc2FmZVRpdGxlID0gYm9vay5tZXRhZGF0YS50aXRsZS5yZXBsYWNlKC9bXFxcXC86Kj9cIjw+fF0vZywgJ18nKTtcbiAgICAgIGxpbmsuZG93bmxvYWQgPSBgJHtzYWZlVGl0bGV9LnppcGA7XG4gICAgICBsaW5rLmNsaWNrKCk7XG5cbiAgICAgIC8vIFNob3cgRHJpdmUgbGlua3MgaWYgdXBsb2FkZWRcbiAgICAgIGlmIChkcml2ZUxpbmtzKSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNob3dMaW5rcyA9IGNvbmZpcm0oYNeU16HXpNeoINeU15XXotec15Qg15wtR29vZ2xlIERyaXZlIVxcblxcbtec15TXpteZ15Ig16fXmdep15XXqNeZ150/YCk7XG4gICAgICAgICAgaWYgKHNob3dMaW5rcykge1xuICAgICAgICAgICAgYWxlcnQoYPCfk6YgWklQOiAke2RyaXZlTGlua3MuemlwTGlua31cXG5cXG7wn5OEIFBERjogJHtkcml2ZUxpbmtzLnBkZkxpbmt9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCA1MDApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXhwb3J0IGZhaWxlZDpcIiwgZXJyb3IpO1xuICAgICAgYWxlcnQoXCLXlNeZ15nXpteV15Ag16DXm9ep15wuINeQ16DXkCDXoNeh15Qg16nXldeRLlwiKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNFeHBvcnRpbmcoZmFsc2UpO1xuICAgICAgc2V0RXhwb3J0UHJvZ3Jlc3MoJycpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVEb3dubG9hZFBERiA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoaXNFeHBvcnRpbmcpIHJldHVybjtcbiAgICBzZXRJc0V4cG9ydGluZyh0cnVlKTtcbiAgICBzZXRFeHBvcnRQcm9ncmVzcygn15nXldem16ggUERGLi4uJyk7XG4gICAgY29uc3QgcGRmID0gbmV3IGpzUERGKCdwJywgJ21tJywgJ2E0Jyk7XG4gICAgY29uc3QgcGFnZVdpZHRoID0gMjEwO1xuXG4gICAgdHJ5IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9vay5wYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBzZXRFeHBvcnRQcm9ncmVzcyhg157Xldeh15nXoyDXotee15XXkyAke2kgKyAxfS4uLmApO1xuICAgICAgICBsZXQgaW1nVXJsID0gaW1hZ2VzW2ldO1xuICAgICAgICBjb25zdCBpc0NvdmVyID0gaSA9PT0gMDtcblxuICAgICAgICBpZiAoIWltZ1VybCkge1xuICAgICAgICAgIGNvbnN0IHJlZiA9IGJvb2tSZWYuY3VycmVudC5tZXRhZGF0YS5iYXNlQ2hhcmFjdGVySW1hZ2VVcmwgfHwgc2Vzc2lvblJlZmVyZW5jZUltYWdlO1xuICAgICAgICAgIGNvbnN0IHRleHRUb1JlbmRlciA9IGlzQ292ZXIgPyBib29rUmVmLmN1cnJlbnQubWV0YWRhdGEudGl0bGUgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgaW1nVXJsID0gYXdhaXQgZ2VuZXJhdGVQYWdlSW1hZ2UoYm9vay5wYWdlc1tpXS5pbWFnZVByb21wdCwgZnVsbENoYXJhY3RlckRlc2NyaXB0aW9uLCBib29rLm1ldGFkYXRhLmFydFN0eWxlLCByZWYgfHwgdW5kZWZpbmVkLCBpc0NvdmVyLCB0ZXh0VG9SZW5kZXIpO1xuICAgICAgICAgIGlmIChpbWdVcmwpIHsgc2V0SW1hZ2VzKHByZXYgPT4gKHsgLi4ucHJldiwgW2ldOiBpbWdVcmwgfSkpOyB1cGRhdGVCb29rU3RhdGUoaSwgaW1nVXJsKTsgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpbWdVcmwpIHtcbiAgICAgICAgICBjb25zdCBjYW52YXMgPSBhd2FpdCBwcmVwYXJlRXhwb3J0Q2FudmFzKGksIGltZ1VybCk7XG4gICAgICAgICAgY29uc3QgaW1nRGF0YSA9IGNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL2pwZWcnLCAwLjkpO1xuXG4gICAgICAgICAgY29uc3QgY2FudmFzUmF0aW8gPSBjYW52YXMuaGVpZ2h0IC8gY2FudmFzLndpZHRoO1xuICAgICAgICAgIGNvbnN0IHBkZkltZ0hlaWdodCA9IHBhZ2VXaWR0aCAqIGNhbnZhc1JhdGlvO1xuXG4gICAgICAgICAgbGV0IHJlbmRlcldpZHRoID0gcGFnZVdpZHRoO1xuICAgICAgICAgIGxldCByZW5kZXJIZWlnaHQgPSBwZGZJbWdIZWlnaHQ7XG4gICAgICAgICAgaWYgKHJlbmRlckhlaWdodCA+IDI5Nykge1xuICAgICAgICAgICAgY29uc3Qgc2NhbGUgPSAyOTcgLyByZW5kZXJIZWlnaHQ7XG4gICAgICAgICAgICByZW5kZXJIZWlnaHQgPSAyOTc7XG4gICAgICAgICAgICByZW5kZXJXaWR0aCA9IHBhZ2VXaWR0aCAqIHNjYWxlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB4T2Zmc2V0ID0gKDIxMCAtIHJlbmRlcldpZHRoKSAvIDI7XG5cbiAgICAgICAgICBwZGYuYWRkSW1hZ2UoaW1nRGF0YSwgJ0pQRUcnLCB4T2Zmc2V0LCAwLCByZW5kZXJXaWR0aCwgcmVuZGVySGVpZ2h0KTtcbiAgICAgICAgICBpZiAoaSA8IGJvb2sucGFnZXMubGVuZ3RoIC0gMSkgcGRmLmFkZFBhZ2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBwZGZCbG9iID0gcGRmLm91dHB1dCgnYmxvYicpO1xuXG4gICAgICAvLyBVcGxvYWQgdG8gR29vZ2xlIERyaXZlIGlmIGNvbm5lY3RlZFxuICAgICAgbGV0IGRyaXZlTGlua3M6IHsgemlwTGluazogc3RyaW5nOyBwZGZMaW5rOiBzdHJpbmcgfSB8IG51bGwgPSBudWxsO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBoYXNEcml2ZUFjY2VzcywgdXBsb2FkQm9va1RvRHJpdmUgfSA9IGF3YWl0IGltcG9ydCgnQC9zZXJ2aWNlcy9nb29nbGVEcml2ZScpO1xuICAgICAgICBpZiAoaGFzRHJpdmVBY2Nlc3MoKSkge1xuICAgICAgICAgIHNldEV4cG9ydFByb2dyZXNzKCfXntei15zXlCDXnC1Hb29nbGUgRHJpdmUuLi4nKTtcbiAgICAgICAgICAvLyBGb3IgUERGIG9ubHkgZXhwb3J0LCB3ZSBqdXN0IHVwbG9hZCB0aGUgUERGIChtb2NrIGVtcHR5IFpJUClcbiAgICAgICAgICAvLyBPciBiZXR0ZXIsIHdlIGNhbiB1c2UgYSBzaW1wbGVyIHVwbG9hZFRvRHJpdmUgZnVuY3Rpb24sIGJ1dCB1cGxvYWRCb29rVG9Ecml2ZSBpcyBoYW5keS5cbiAgICAgICAgICAvLyBMZXQncyBqdXN0IHVwbG9hZCB0aGUgUERGIHVzaW5nIHRoZSBnZW5lcmljIHVwbG9hZCBmdW5jdGlvbiBleHBvc2VkIG9yIHZpYSB1cGxvYWRCb29rVG9Ecml2ZSBwYXNzaW5nIGVtcHR5IGJsb2IgZm9yIHppcD9cbiAgICAgICAgICAvLyBBY3R1YWxseSB1cGxvYWRCb29rVG9Ecml2ZSBleHBlY3RzIGJvdGguIExldCdzIGltcG9ydCB1cGxvYWRUb0RyaXZlIGRpcmVjdGx5LlxuICAgICAgICAgIGNvbnN0IHsgdXBsb2FkVG9Ecml2ZSB9ID0gYXdhaXQgaW1wb3J0KCdAL3NlcnZpY2VzL2dvb2dsZURyaXZlJyk7XG4gICAgICAgICAgY29uc3Qgc2FmZVRpdGxlID0gYm9vay5tZXRhZGF0YS50aXRsZS5yZXBsYWNlKC9bXFxcXC86Kj9cIjw+fF0vZywgJ18nKTtcbiAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB1cGxvYWRUb0RyaXZlKHBkZkJsb2IsIGAke3NhZmVUaXRsZX1fJHt0aW1lc3RhbXB9LnBkZmAsICdhcHBsaWNhdGlvbi9wZGYnKTtcbiAgICAgICAgICBkcml2ZUxpbmtzID0geyB6aXBMaW5rOiAnJywgcGRmTGluazogcmVzdWx0LndlYlZpZXdMaW5rIH07XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGRyaXZlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdEcml2ZSB1cGxvYWQgZmFpbGVkOicsIGRyaXZlRXJyb3IpO1xuICAgICAgfVxuXG4gICAgICAvLyBMb2cgYm9vayBtZXRhZGF0YSB0byBGaXJlc3RvcmUgV0lUSCBEcml2ZSBsaW5rXG4gICAgICBzZXRFeHBvcnRQcm9ncmVzcygn16nXldee16gg157XmdeT16IuLi4nKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgc2F2ZUJvb2tQcm9tcHRzIH0gPSBhd2FpdCBpbXBvcnQoJ0Avc2VydmljZXMvZmlyZWJhc2UnKTtcbiAgICAgICAgYXdhaXQgc2F2ZUJvb2tQcm9tcHRzKHtcbiAgICAgICAgICBib29rVGl0bGU6IGJvb2subWV0YWRhdGEudGl0bGUsXG4gICAgICAgICAgbWFpbkNoYXJhY3RlcjogYm9vay5tZXRhZGF0YS5tYWluQ2hhcmFjdGVyRGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgICAgYXJ0U3R5bGU6IGJvb2subWV0YWRhdGEuYXJ0U3R5bGUsXG4gICAgICAgICAgdG9waWM6IGJvb2subWV0YWRhdGEubWFpblRoZW1lIHx8ICcnLFxuICAgICAgICAgIGltYWdlUHJvbXB0czogYm9vay5wYWdlcy5tYXAocCA9PiBwLmltYWdlUHJvbXB0KSxcbiAgICAgICAgICBkcml2ZVBkZlVybDogZHJpdmVMaW5rcz8ucGRmTGlua1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2coJ0Jvb2sgbWV0YWRhdGEgc2F2ZWQgdG8gRmlyZXN0b3JlIScpO1xuICAgICAgfSBjYXRjaCAoZmlyZWJhc2VFcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0ZpcmVzdG9yZSBzYXZlIGZhaWxlZDonLCBmaXJlYmFzZUVycm9yKTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc2FmZVRpdGxlID0gYm9vay5tZXRhZGF0YS50aXRsZS5yZXBsYWNlKC9bXFxcXC86Kj9cIjw+fF0vZywgJ18nKTtcbiAgICAgIHBkZi5zYXZlKGAke3NhZmVUaXRsZX0ucGRmYCk7XG5cbiAgICAgIC8vIFNob3cgRHJpdmUgbGlua3MgaWYgdXBsb2FkZWRcbiAgICAgIGlmIChkcml2ZUxpbmtzPy5wZGZMaW5rKSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNob3dMaW5rcyA9IGNvbmZpcm0oYNeULVBERiDXlNeV16LXnNeUINecLUdvb2dsZSBEcml2ZSFcXG5cXG7XnNeU16bXmdeSINen15nXqdeV16g/YCk7XG4gICAgICAgICAgaWYgKHNob3dMaW5rcykge1xuICAgICAgICAgICAgYWxlcnQoYPCfk4QgUERGOiAke2RyaXZlTGlua3MucGRmTGlua31gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIDUwMCk7XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHsgc2V0SXNFeHBvcnRpbmcoZmFsc2UpOyBzZXRFeHBvcnRQcm9ncmVzcygnJyk7IH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZml4ZWQgaW5zZXQtMCBiZy1zbGF0ZS05MDAgei1bMTAwXSBmbGV4IGZsZXgtY29sIGl0ZW1zLWNlbnRlclwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgYmctd2hpdGUgcHgtNCBoLTIwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBzaGFkb3ctbWQgc2hyaW5rLTAgei01MFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC00XCI+XG4gICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXtvbkNsb3NlfSBjbGFzc05hbWU9XCJ0ZXh0LXNsYXRlLTYwMCBob3Zlcjp0ZXh0LXNsYXRlLTkwMCBmb250LWJvbGQgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTJcIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQteGxcIj7ihpA8L3NwYW4+INeX15bXqNeUINec16LXqNeZ15vXlFxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDxidXR0b24gb25DbGljaz17aGFuZGxlQ2hhbmdlS2V5fSBjbGFzc05hbWU9XCJ0ZXh0LXNsYXRlLTQwMCBob3Zlcjp0ZXh0LXNsYXRlLTYwMCB0ZXh0LXhzIGZvbnQtYm9sZCBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCBweC0yIHB5LTEgcm91bmRlZC1mdWxsIGZsZXggaXRlbXMtY2VudGVyIGdhcC0xXCI+XG4gICAgICAgICAgICDwn5SRIEFQSVxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtM1wiPlxuICAgICAgICAgIDxEcml2ZUNvbm5lY3RCdXR0b24gLz5cbiAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2hhbmRsZURvd25sb2FkWklQfSBkaXNhYmxlZD17aXNFeHBvcnRpbmd9IGNsYXNzTmFtZT1cImJnLWtpZC1vcmFuZ2UgaG92ZXI6Ymctb3JhbmdlLTQwMCB0ZXh0LXdoaXRlIGZvbnQtYm9sZCBweS0yIHB4LTQgcm91bmRlZC1mdWxsIHRleHQtc20gdHJhbnNpdGlvbi1hbGwgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTJcIj5cbiAgICAgICAgICAgIDxzcGFuPteX15HXmdec15Qg157XnNeQ15Q8L3NwYW4+IPCfk6ZcbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2hhbmRsZURvd25sb2FkUERGfSBkaXNhYmxlZD17aXNFeHBvcnRpbmd9IGNsYXNzTmFtZT1cImJnLWtpZC1ibHVlIGhvdmVyOmJnLXRlYWwtNDAwIHRleHQtd2hpdGUgZm9udC1ib2xkIHB5LTIgcHgtNCByb3VuZGVkLWZ1bGwgdGV4dC1zbSB0cmFuc2l0aW9uLWFsbFwiPlxuICAgICAgICAgICAgUERGINeR15zXkdeTIPCfk4RcbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LWdyb3cgdy1mdWxsIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHAtNCBvdmVyZmxvdy1hdXRvIGJnLXNsYXRlLTgwMFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlbGF0aXZlIHctZnVsbCBtYXgtdy1bNTUwcHhdIGJnLXdoaXRlIHJvdW5kZWQtMnhsIHNoYWRvdy0yeGwgb3ZlcmZsb3ctaGlkZGVuIGdyb3VwIGJvcmRlci00IGJvcmRlci13aGl0ZSBmbGV4IGZsZXgtY29sXCI+XG4gICAgICAgICAge2ltYWdlc1tjdXJyZW50UGFnZUluZGV4XSA/IChcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgIHsvKiBJTUFHRSBBUkVBOiBcbiAgICAgICAgICAgICAgICAgLSBDb3ZlcjogRnVsbCBjb250YWluZXIuXG4gICAgICAgICAgICAgICAgIC0gSW5uZXI6IFN0cmljdGx5IHNxdWFyZSwgdG9wIHBhcnQgb2YgZmxleCBjb2x1bW4uXG4gICAgICAgICAgICAgICovfVxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHJlbGF0aXZlIHctZnVsbCAke2N1cnJlbnRQYWdlSW5kZXggPT09IDAgPyAnaC1mdWxsIGFzcGVjdC1zcXVhcmUnIDogJ2FzcGVjdC1zcXVhcmUgc2hyaW5rLTAnfSBiZy1zbGF0ZS0xMDBgfT5cbiAgICAgICAgICAgICAgICA8aW1nIHNyYz17aW1hZ2VzW2N1cnJlbnRQYWdlSW5kZXhdfSBjbGFzc05hbWU9XCJ3LWZ1bGwgaC1mdWxsIG9iamVjdC1jb3ZlclwiIC8+XG5cbiAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVSZWdlbmVyYXRlSW1hZ2V9XG4gICAgICAgICAgICAgICAgICBkaXNhYmxlZD17bG9hZGluZ0ltYWdlc1tjdXJyZW50UGFnZUluZGV4XX1cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImFic29sdXRlIHRvcC00IGxlZnQtNCB6LTMwIGJnLXdoaXRlLzgwIGhvdmVyOmJnLXdoaXRlIHRleHQtc2xhdGUtNzAwIHAtMiByb3VuZGVkLWZ1bGwgc2hhZG93LWxnIGJhY2tkcm9wLWJsdXItc20gdHJhbnNpdGlvbi1hbGwgaG92ZXI6c2NhbGUtMTEwIGRpc2FibGVkOm9wYWNpdHktNTBcIlxuICAgICAgICAgICAgICAgICAgdGl0bGU9XCLXpteZ15nXqCDXnteX15PXqSDXkNeqINeU16rXnteV16DXlFwiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAge2xvYWRpbmdJbWFnZXNbY3VycmVudFBhZ2VJbmRleF0gPyAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy02IGgtNiBib3JkZXItMiBib3JkZXItc2xhdGUtNzAwIGJvcmRlci10LXRyYW5zcGFyZW50IHJvdW5kZWQtZnVsbCBhbmltYXRlLXNwaW5cIj48L2Rpdj5cbiAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQteGxcIj7wn5SEPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cblxuICAgICAgICAgICAgICAgIHsvKiBBdWRpbyBCdXR0b24gZm9yIENvdmVyIChPdmVybGF5IFN0eWxlKSAqL31cbiAgICAgICAgICAgICAgICB7Y3VycmVudFBhZ2VJbmRleCA9PT0gMCAmJiBhdWRpb0VuYWJsZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhYnNvbHV0ZSBib3R0b20tNiByaWdodC02IGZsZXggZmxleC1jb2wgaXRlbXMtZW5kIGdhcC0yIHotMjBcIj5cbiAgICAgICAgICAgICAgICAgICAge2F1ZGlvRXJyb3IgJiYgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LXJlZC01MDAgYmctd2hpdGUgcHgtMiBweS0xIHJvdW5kZWQtZnVsbCBmb250LWJvbGQgc2hhZG93LW1kXCI+e2F1ZGlvRXJyb3J9PC9zcGFuPn1cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB7IGUuc3RvcFByb3BhZ2F0aW9uKCk7IGhhbmRsZVRvZ2dsZUF1ZGlvKCk7IH19XG4gICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzTG9hZGluZ0F1ZGlvfVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB3LTE0IGgtMTQgcm91bmRlZC1mdWxsIHNoYWRvdy1sZyBib3JkZXItNCBib3JkZXItd2hpdGUgdHJhbnNpdGlvbi1hbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtpc1BsYXlpbmcgPyAnYmctcmVkLTUwMCB0ZXh0LXdoaXRlIGFuaW1hdGUtcHVsc2UnIDogJ2JnLWtpZC1ibHVlIHRleHQtd2hpdGUgaG92ZXI6YmctdGVhbC00MDAgaG92ZXI6c2NhbGUtMTEwJ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHthdWRpb0Vycm9yID8gJ2JnLXNsYXRlLTQwMCBib3JkZXItc2xhdGUtMjAwJyA6ICcnfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGB9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICB7aXNMb2FkaW5nQXVkaW8gPyA8ZGl2IGNsYXNzTmFtZT1cInctNiBoLTYgYm9yZGVyLTMgYm9yZGVyLXdoaXRlIGJvcmRlci10LXRyYW5zcGFyZW50IHJvdW5kZWQtZnVsbCBhbmltYXRlLXNwaW5cIj48L2Rpdj4gOiBpc1BsYXlpbmcgPyA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LTN4bFwiPuKPuTwvc3Bhbj4gOiA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LTN4bFwiPvCflIo8L3NwYW4+fVxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgIHsvKiBURVhUIEFSRUEgKElubmVyIFBhZ2VzIE9ubHkpOiBVc2UgY3VzdG9tIGJvb2stdGV4dC1jb250YWluZXIgY2xhc3MgKi99XG4gICAgICAgICAgICAgIHtjdXJyZW50UGFnZUluZGV4ICE9PSAwICYmIChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctZnVsbCBib29rLXRleHQtY29udGFpbmVyIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBmbGV4LTFcIj5cblxuICAgICAgICAgICAgICAgICAge2F1ZGlvRW5hYmxlZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoZSkgPT4geyBlLnN0b3BQcm9wYWdhdGlvbigpOyBoYW5kbGVUb2dnbGVBdWRpbygpOyB9fVxuICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmdBdWRpb31cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hyaW5rLTAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdy0xMiBoLTEyIHJvdW5kZWQtZnVsbCBzaGFkb3ctc20gdHJhbnNpdGlvbi1hbGwgbXItNlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2lzUGxheWluZyA/ICdiZy1yZWQtNTAwIHRleHQtd2hpdGUgYW5pbWF0ZS1wdWxzZScgOiAnYmcta2lkLWJsdWUgdGV4dC13aGl0ZSBob3ZlcjpiZy10ZWFsLTQwMCd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7aXNMb2FkaW5nQXVkaW8gPyAnb3BhY2l0eS03MCBjdXJzb3Itd2FpdCcgOiAnJ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHthdWRpb0Vycm9yID8gJ2JnLXNsYXRlLTQwMCcgOiAnJ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAge2lzTG9hZGluZ0F1ZGlvID8gPGRpdiBjbGFzc05hbWU9XCJ3LTUgaC01IGJvcmRlci0yIGJvcmRlci13aGl0ZSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgYW5pbWF0ZS1zcGluXCI+PC9kaXY+IDogaXNQbGF5aW5nID8gPHNwYW4gY2xhc3NOYW1lPVwidGV4dC0yeGxcIj7ij7k8L3NwYW4+IDogPHNwYW4gY2xhc3NOYW1lPVwidGV4dC0yeGxcIj7wn5SKPC9zcGFuPn1cbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSB0ZXh0LWNlbnRlciBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJib29rLXRleHRcIj5cbiAgICAgICAgICAgICAgICAgICAgICB7Y3VycmVudFBhZ2UuaGVicmV3VGV4dH1cbiAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICApIDogKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgYXNwZWN0LXNxdWFyZSBmbGV4IGZsZXgtY29sIGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBiZy1zbGF0ZS0xMDBcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTEyIGgtMTIgYm9yZGVyLTQgYm9yZGVyLWtpZC1ibHVlIGJvcmRlci10LXRyYW5zcGFyZW50IHJvdW5kZWQtZnVsbCBhbmltYXRlLXNwaW4gbWItNFwiPjwvZGl2PlxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJmb250LWJvbGQgdGV4dC1zbGF0ZS01MDBcIj7Xntem15nXmdeoINeo15LXoiDXp9eh15XXnS4uLjwvcD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy1mdWxsIGJnLXdoaXRlLzEwIGJhY2tkcm9wLWJsdXItbWQgcC02IGZsZXgganVzdGlmeS1jZW50ZXIgaXRlbXMtY2VudGVyIGdhcC0xMFwiPlxuICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2hhbmRsZVByZXZ9IGRpc2FibGVkPXtjdXJyZW50UGFnZUluZGV4ID09PSAwfSBjbGFzc05hbWU9XCJ3LTE0IGgtMTQgYmctd2hpdGUvMjAgaG92ZXI6Ymctd2hpdGUvNDAgdGV4dC13aGl0ZSByb3VuZGVkLWZ1bGwgdGV4dC0yeGwgZGlzYWJsZWQ6b3BhY2l0eS0yMCB0cmFuc2l0aW9uLWFsbFwiPuKGkDwvYnV0dG9uPlxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlIGZvbnQtYm9sZCBiZy1ibGFjay80MCBweC02IHB5LTIgcm91bmRlZC1mdWxsXCI+XG4gICAgICAgICAg16LXnteV15Mge2N1cnJlbnRQYWdlSW5kZXggKyAxfSDXnteq15XXmiB7dG90YWxQYWdlc31cbiAgICAgICAgPC9zcGFuPlxuICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2hhbmRsZU5leHR9IGRpc2FibGVkPXtjdXJyZW50UGFnZUluZGV4ID09PSB0b3RhbFBhZ2VzIC0gMX0gY2xhc3NOYW1lPVwidy0xNCBoLTE0IGJnLWtpZC15ZWxsb3cgaG92ZXI6YmcteWVsbG93LTQwMCB0ZXh0LXNsYXRlLTkwMCByb3VuZGVkLWZ1bGwgdGV4dC0yeGwgZGlzYWJsZWQ6b3BhY2l0eS0yMCB0cmFuc2l0aW9uLWFsbFwiPuKGkjwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG5cbiAgICAgIHtpc0V4cG9ydGluZyAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZml4ZWQgaW5zZXQtMCB6LVs0MDBdIGJnLXNsYXRlLTkwMC85MCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB0ZXh0LXdoaXRlXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTE2IGgtMTYgYm9yZGVyLTQgYm9yZGVyLWtpZC1ibHVlIGJvcmRlci10LXRyYW5zcGFyZW50IHJvdW5kZWQtZnVsbCBhbmltYXRlLXNwaW4gbXgtYXV0byBtYi02XCI+PC9kaXY+XG4gICAgICAgICAgICA8aDMgY2xhc3NOYW1lPVwidGV4dC0yeGwgZm9udC1ib2xkIGZvbnQtZnJlZG9rYVwiPntleHBvcnRQcm9ncmVzc308L2gzPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBCb29rVmlld2VyO1xuIl0sIm5hbWVzIjpbIlJlYWN0IiwidXNlU3RhdGUiLCJ1c2VFZmZlY3QiLCJ1c2VNZW1vIiwidXNlUmVmIiwiZ2VuZXJhdGVQYWdlSW1hZ2UiLCJnZW5lcmF0ZVBhZ2VBdWRpbyIsIkRyaXZlQ29ubmVjdEJ1dHRvbiIsImh0bWwyY2FudmFzIiwianNQREYiLCJKU1ppcCIsImF1ZGlvQnVmZmVyVG9XYXYiLCJidWZmZXIiLCJudW1DaGFubmVscyIsIm51bWJlck9mQ2hhbm5lbHMiLCJzYW1wbGVSYXRlIiwiZm9ybWF0IiwiYml0RGVwdGgiLCJieXRlc1BlclNhbXBsZSIsImJsb2NrQWxpZ24iLCJkYXRhQnl0ZUNvdW50IiwibGVuZ3RoIiwiaGVhZGVyQnl0ZUNvdW50IiwidG90YWxCeXRlQ291bnQiLCJoZWFkZXJCdWZmZXIiLCJBcnJheUJ1ZmZlciIsInZpZXciLCJEYXRhVmlldyIsIndyaXRlU3RyaW5nIiwib2Zmc2V0Iiwic3RyaW5nIiwiaSIsInNldFVpbnQ4IiwiY2hhckNvZGVBdCIsInNldFVpbnQzMiIsInNldFVpbnQxNiIsImRhdGFCdWZmZXIiLCJkYXRhVmlldyIsImNoYW5uZWwiLCJzYW1wbGUiLCJnZXRDaGFubmVsRGF0YSIsInMiLCJNYXRoIiwibWF4IiwibWluIiwiaW50MTYiLCJzZXRJbnQxNiIsIkJsb2IiLCJ0eXBlIiwiQm9va1ZpZXdlciIsImJvb2siLCJvblVwZGF0ZUJvb2siLCJvbkNsb3NlIiwiY3VycmVudFBhZ2VJbmRleCIsInNldEN1cnJlbnRQYWdlSW5kZXgiLCJib29rUmVmIiwiY3VycmVudCIsImltYWdlcyIsInNldEltYWdlcyIsImluaXRpYWxJbWFnZXMiLCJwYWdlcyIsImZvckVhY2giLCJwYWdlIiwiaW5kZXgiLCJnZW5lcmF0ZWRJbWFnZVVybCIsImxvYWRpbmdJbWFnZXMiLCJzZXRMb2FkaW5nSW1hZ2VzIiwic2Vzc2lvblJlZmVyZW5jZUltYWdlIiwic2V0U2Vzc2lvblJlZmVyZW5jZUltYWdlIiwibWV0YWRhdGEiLCJiYXNlQ2hhcmFjdGVySW1hZ2VVcmwiLCJmaW5kIiwicCIsImlzRXhwb3J0aW5nIiwic2V0SXNFeHBvcnRpbmciLCJleHBvcnRQcm9ncmVzcyIsInNldEV4cG9ydFByb2dyZXNzIiwiaXNQbGF5aW5nIiwic2V0SXNQbGF5aW5nIiwiaXNMb2FkaW5nQXVkaW8iLCJzZXRJc0xvYWRpbmdBdWRpbyIsImF1ZGlvRXJyb3IiLCJzZXRBdWRpb0Vycm9yIiwiYXVkaW9CdWZmZXJzIiwic2V0QXVkaW9CdWZmZXJzIiwiYXVkaW9Db250ZXh0UmVmIiwiYXVkaW9Tb3VyY2VSZWYiLCJjdXJyZW50UGFnZSIsInRvdGFsUGFnZXMiLCJhdWRpb0VuYWJsZWQiLCJhdWRpb0NvbmZpZyIsImVuYWJsZWQiLCJ2b2ljZU5hbWUiLCJmdWxsQ2hhcmFjdGVyRGVzY3JpcHRpb24iLCJkZXNjIiwibWFpbkNoYXJhY3RlckRlc2NyaXB0aW9uIiwibWFpbkNoYXJhY3RlckRpc3RpbmN0aXZlTWFyayIsInNlY29uZGFyeUNoYXJhY3RlckRlc2NyaXB0aW9uIiwic2Vjb25kYXJ5Q2hhcmFjdGVyRGlzdGluY3RpdmVNYXJrIiwic3RvcEF1ZGlvIiwiY2xvc2UiLCJzdG9wIiwiZSIsImhhbmRsZUNoYW5nZUtleSIsImFpc3R1ZGlvIiwid2luZG93Iiwib3BlblNlbGVjdEtleSIsImhhbmRsZVRvZ2dsZUF1ZGlvIiwiQXVkaW9Db250ZXh0Iiwid2Via2l0QXVkaW9Db250ZXh0Iiwic3RhdGUiLCJyZXN1bWUiLCJjdHgiLCJwbGF5QnVmZmVyIiwidGV4dFRvUmVhZCIsInRpdGxlIiwiaGVicmV3VGV4dCIsInByZXYiLCJjb25zb2xlIiwiZXJyb3IiLCJzb3VyY2UiLCJjcmVhdGVCdWZmZXJTb3VyY2UiLCJjb25uZWN0IiwiZGVzdGluYXRpb24iLCJvbmVuZGVkIiwic3RhcnQiLCJoYW5kbGVOZXh0IiwiaGFuZGxlUHJldiIsInVwZGF0ZUJvb2tTdGF0ZSIsInVybCIsImN1cnJlbnRCb29rU3RhdGUiLCJ1cGRhdGVkUGFnZXMiLCJ1cGRhdGVkQm9vayIsImxvYWRJbWFnZSIsInBhZ2VJbmRleCIsImFjdGlvblByb21wdCIsInJlZmVyZW5jZVRvVXNlIiwiaXNDb3ZlciIsInRleHRUb1JlbmRlciIsInVuZGVmaW5lZCIsImFydFN0eWxlIiwiZXJyIiwiaGFuZGxlUmVnZW5lcmF0ZUltYWdlIiwic3RvcFByb3BhZ2F0aW9uIiwiaW1hZ2VQcm9tcHQiLCJhbGVydCIsInByZXBhcmVFeHBvcnRDYW52YXMiLCJpbWdVcmwiLCJ3aWR0aCIsImhlaWdodCIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInN0eWxlIiwicG9zaXRpb24iLCJsZWZ0IiwiYmFja2dyb3VuZENvbG9yIiwib3ZlcmZsb3ciLCJpbm5lckhUTUwiLCJ0ZXh0IiwiYm9keSIsImFwcGVuZENoaWxkIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiY2FudmFzIiwic2NhbGUiLCJ1c2VDT1JTIiwicmVtb3ZlQ2hpbGQiLCJoYW5kbGVEb3dubG9hZFpJUCIsInppcCIsInBkZiIsInBhZ2VXaWR0aCIsImZpbGUiLCJKU09OIiwic3RyaW5naWZ5IiwicG5nQmxvYiIsInRvQmxvYiIsIlN0cmluZyIsInBhZFN0YXJ0IiwiaW1nRGF0YSIsInRvRGF0YVVSTCIsImNhbnZhc1JhdGlvIiwicGRmSW1nSGVpZ2h0IiwicmVuZGVyV2lkdGgiLCJyZW5kZXJIZWlnaHQiLCJ4T2Zmc2V0IiwiYWRkSW1hZ2UiLCJhZGRQYWdlIiwiYXVkaW9CdWYiLCJidWYiLCJwZGZCbG9iIiwib3V0cHV0IiwiY29udGVudCIsImdlbmVyYXRlQXN5bmMiLCJkcml2ZUxpbmtzIiwiaGFzRHJpdmVBY2Nlc3MiLCJ1cGxvYWRCb29rVG9Ecml2ZSIsImRyaXZlRXJyb3IiLCJ3YXJuIiwic2F2ZUJvb2tQcm9tcHRzIiwiYm9va1RpdGxlIiwibWFpbkNoYXJhY3RlciIsInRvcGljIiwibWFpblRoZW1lIiwiaW1hZ2VQcm9tcHRzIiwibWFwIiwiZHJpdmVaaXBVcmwiLCJ6aXBMaW5rIiwiZHJpdmVQZGZVcmwiLCJwZGZMaW5rIiwibG9nIiwiZmlyZWJhc2VFcnJvciIsImxpbmsiLCJocmVmIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwic2FmZVRpdGxlIiwicmVwbGFjZSIsImRvd25sb2FkIiwiY2xpY2siLCJzaG93TGlua3MiLCJjb25maXJtIiwiaGFuZGxlRG93bmxvYWRQREYiLCJyZWYiLCJ1cGxvYWRUb0RyaXZlIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic3BsaXQiLCJyZXN1bHQiLCJ3ZWJWaWV3TGluayIsInNhdmUiLCJkaXYiLCJjbGFzc05hbWUiLCJidXR0b24iLCJvbkNsaWNrIiwic3BhbiIsImRpc2FibGVkIiwiaW1nIiwic3JjIiwiaDMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./components/BookViewer.tsx\n"));

/***/ })

});