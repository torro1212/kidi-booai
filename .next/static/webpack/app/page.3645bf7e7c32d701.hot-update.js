"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./components/BookViewer.tsx":
/*!***********************************!*\
  !*** ./components/BookViewer.tsx ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _services_geminiService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/services/geminiService */ \"(app-pages-browser)/./services/geminiService.ts\");\n/* harmony import */ var _components_DriveConnectButton__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/components/DriveConnectButton */ \"(app-pages-browser)/./components/DriveConnectButton.tsx\");\n/* harmony import */ var html2canvas__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! html2canvas */ \"(app-pages-browser)/./node_modules/html2canvas/dist/html2canvas.js\");\n/* harmony import */ var html2canvas__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(html2canvas__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var jspdf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! jspdf */ \"(app-pages-browser)/./node_modules/jspdf/dist/jspdf.es.min.js\");\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jszip */ \"(app-pages-browser)/./node_modules/jszip/dist/jszip.min.js\");\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jszip__WEBPACK_IMPORTED_MODULE_6__);\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n\n// Helper to convert AudioBuffer to WAV Blob\nfunction audioBufferToWav(buffer) {\n    const numChannels = buffer.numberOfChannels;\n    const sampleRate = buffer.sampleRate;\n    const format = 1; // PCM\n    const bitDepth = 16;\n    const bytesPerSample = bitDepth / 8;\n    const blockAlign = numChannels * bytesPerSample;\n    const dataByteCount = buffer.length * blockAlign;\n    const headerByteCount = 44;\n    const totalByteCount = headerByteCount + dataByteCount;\n    const headerBuffer = new ArrayBuffer(headerByteCount);\n    const view = new DataView(headerBuffer);\n    const writeString = (view, offset, string)=>{\n        for(let i = 0; i < string.length; i++){\n            view.setUint8(offset + i, string.charCodeAt(i));\n        }\n    };\n    writeString(view, 0, 'RIFF');\n    view.setUint32(4, totalByteCount - 8, true);\n    writeString(view, 8, 'WAVE');\n    writeString(view, 12, 'fmt ');\n    view.setUint32(16, 16, true);\n    view.setUint16(20, format, true);\n    view.setUint16(22, numChannels, true);\n    view.setUint32(24, sampleRate, true);\n    view.setUint32(28, sampleRate * blockAlign, true);\n    view.setUint16(32, blockAlign, true);\n    view.setUint16(34, bitDepth, true);\n    writeString(view, 36, 'data');\n    view.setUint32(40, dataByteCount, true);\n    const dataBuffer = new ArrayBuffer(dataByteCount);\n    const dataView = new DataView(dataBuffer);\n    let offset = 0;\n    for(let i = 0; i < buffer.length; i++){\n        for(let channel = 0; channel < numChannels; channel++){\n            const sample = buffer.getChannelData(channel)[i];\n            const s = Math.max(-1, Math.min(1, sample));\n            const int16 = s < 0 ? s * 0x8000 : s * 0x7FFF;\n            dataView.setInt16(offset, int16, true);\n            offset += 2;\n        }\n    }\n    return new Blob([\n        headerBuffer,\n        dataBuffer\n    ], {\n        type: 'audio/wav'\n    });\n}\nconst BookViewer = (param)=>{\n    let { book, onUpdateBook, onClose } = param;\n    var _book_pages_find, _book_metadata_audioConfig, _book_metadata_audioConfig1;\n    _s();\n    const [currentPageIndex, setCurrentPageIndex] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0);\n    const bookRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(book);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"BookViewer.useEffect\": ()=>{\n            bookRef.current = book;\n        }\n    }[\"BookViewer.useEffect\"], [\n        book\n    ]);\n    const [images, setImages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({\n        \"BookViewer.useState\": ()=>{\n            const initialImages = {};\n            book.pages.forEach({\n                \"BookViewer.useState\": (page, index)=>{\n                    if (page.generatedImageUrl) {\n                        initialImages[index] = page.generatedImageUrl;\n                    }\n                }\n            }[\"BookViewer.useState\"]);\n            return initialImages;\n        }\n    }[\"BookViewer.useState\"]);\n    const [loadingImages, setLoadingImages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({});\n    const [sessionReferenceImage, setSessionReferenceImage] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(book.metadata.baseCharacterImageUrl || ((_book_pages_find = book.pages.find({\n        \"BookViewer.useState\": (p)=>p.generatedImageUrl\n    }[\"BookViewer.useState\"])) === null || _book_pages_find === void 0 ? void 0 : _book_pages_find.generatedImageUrl) || null);\n    const [isExporting, setIsExporting] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [exportProgress, setExportProgress] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)('');\n    const [isPlaying, setIsPlaying] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [isLoadingAudio, setIsLoadingAudio] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [audioError, setAudioError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [audioBuffers, setAudioBuffers] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({});\n    const audioContextRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const audioSourceRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const currentPage = book.pages[currentPageIndex];\n    const totalPages = book.pages.length;\n    var _book_metadata_audioConfig_enabled;\n    const audioEnabled = (_book_metadata_audioConfig_enabled = (_book_metadata_audioConfig = book.metadata.audioConfig) === null || _book_metadata_audioConfig === void 0 ? void 0 : _book_metadata_audioConfig.enabled) !== null && _book_metadata_audioConfig_enabled !== void 0 ? _book_metadata_audioConfig_enabled : true;\n    const voiceName = ((_book_metadata_audioConfig1 = book.metadata.audioConfig) === null || _book_metadata_audioConfig1 === void 0 ? void 0 : _book_metadata_audioConfig1.voiceName) || 'Puck';\n    const fullCharacterDescription = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)({\n        \"BookViewer.useMemo[fullCharacterDescription]\": ()=>{\n            let desc = \"Main Character: \".concat(book.metadata.mainCharacterDescription, \".\");\n            if (book.metadata.mainCharacterDistinctiveMark) {\n                desc += \" DISTINCTIVE FEATURE: \".concat(book.metadata.mainCharacterDistinctiveMark, \" (Must appear in every image).\");\n            }\n            if (book.metadata.secondaryCharacterDescription) {\n                desc += \"\\nSecondary Character (Sidekick): \".concat(book.metadata.secondaryCharacterDescription, \" (This appearance MUST be consistent across all pages).\");\n                if (book.metadata.secondaryCharacterDistinctiveMark) {\n                    desc += \" DISTINCTIVE FEATURE: \".concat(book.metadata.secondaryCharacterDistinctiveMark, \".\");\n                }\n            }\n            return desc;\n        }\n    }[\"BookViewer.useMemo[fullCharacterDescription]\"], [\n        book.metadata\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"BookViewer.useEffect\": ()=>{\n            return ({\n                \"BookViewer.useEffect\": ()=>{\n                    stopAudio();\n                    if (audioContextRef.current) {\n                        audioContextRef.current.close();\n                    }\n                }\n            })[\"BookViewer.useEffect\"];\n        }\n    }[\"BookViewer.useEffect\"], []);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"BookViewer.useEffect\": ()=>{\n            stopAudio();\n            setAudioError(null);\n        }\n    }[\"BookViewer.useEffect\"], [\n        currentPageIndex\n    ]);\n    const stopAudio = ()=>{\n        if (audioSourceRef.current) {\n            try {\n                audioSourceRef.current.stop();\n            } catch (e) {}\n            audioSourceRef.current = null;\n        }\n        setIsPlaying(false);\n    };\n    const handleChangeKey = ()=>{\n        const aistudio = window.aistudio;\n        if (aistudio) aistudio.openSelectKey();\n    };\n    const handleToggleAudio = async ()=>{\n        if (!audioEnabled) return;\n        if (isPlaying) {\n            stopAudio();\n            return;\n        }\n        setAudioError(null);\n        if (!audioContextRef.current) {\n            audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)({\n                sampleRate: 24000\n            });\n        }\n        if (audioContextRef.current.state === 'suspended') {\n            await audioContextRef.current.resume();\n        }\n        const ctx = audioContextRef.current;\n        if (audioBuffers[currentPageIndex]) {\n            playBuffer(audioBuffers[currentPageIndex], ctx);\n            return;\n        }\n        setIsLoadingAudio(true);\n        try {\n            const textToRead = currentPageIndex === 0 ? book.metadata.title : currentPage.hebrewText;\n            const buffer = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageAudio)(textToRead, ctx, voiceName);\n            if (buffer) {\n                setAudioBuffers((prev)=>({\n                        ...prev,\n                        [currentPageIndex]: buffer\n                    }));\n                playBuffer(buffer, ctx);\n            } else {\n                setAudioError(\"תקלה ביצירת אודיו\");\n            }\n        } catch (e) {\n            console.error(e);\n            setAudioError(\"שגיאה כללית\");\n        } finally{\n            setIsLoadingAudio(false);\n        }\n    };\n    const playBuffer = (buffer, ctx)=>{\n        const source = ctx.createBufferSource();\n        source.buffer = buffer;\n        source.connect(ctx.destination);\n        source.onended = ()=>setIsPlaying(false);\n        audioSourceRef.current = source;\n        source.start();\n        setIsPlaying(true);\n    };\n    const handleNext = ()=>{\n        if (currentPageIndex < totalPages - 1) setCurrentPageIndex((prev)=>prev + 1);\n    };\n    const handlePrev = ()=>{\n        if (currentPageIndex > 0) setCurrentPageIndex((prev)=>prev - 1);\n    };\n    const updateBookState = (index, url)=>{\n        const currentBookState = bookRef.current;\n        const updatedPages = [\n            ...currentBookState.pages\n        ];\n        updatedPages[index] = {\n            ...updatedPages[index],\n            generatedImageUrl: url\n        };\n        const updatedBook = {\n            ...currentBookState,\n            pages: updatedPages\n        };\n        onUpdateBook(updatedBook);\n    };\n    const loadImage = async (pageIndex, actionPrompt)=>{\n        if (images[pageIndex] || loadingImages[pageIndex]) return;\n        if (bookRef.current.pages[pageIndex].generatedImageUrl) {\n            setImages((prev)=>({\n                    ...prev,\n                    [pageIndex]: bookRef.current.pages[pageIndex].generatedImageUrl\n                }));\n            return;\n        }\n        setLoadingImages((prev)=>({\n                ...prev,\n                [pageIndex]: true\n            }));\n        try {\n            const referenceToUse = bookRef.current.metadata.baseCharacterImageUrl || sessionReferenceImage;\n            const isCover = pageIndex === 0;\n            const textToRender = isCover ? bookRef.current.metadata.title : undefined;\n            const url = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageImage)(actionPrompt, fullCharacterDescription, bookRef.current.metadata.artStyle, referenceToUse || undefined, isCover, textToRender);\n            if (url) {\n                setImages((prev)=>({\n                        ...prev,\n                        [pageIndex]: url\n                    }));\n                if (!referenceToUse && !sessionReferenceImage) {\n                    setSessionReferenceImage(url);\n                }\n                updateBookState(pageIndex, url);\n            }\n            return url;\n        } catch (err) {\n            console.error(\"Failed to load page image:\", err);\n            return null;\n        } finally{\n            setLoadingImages((prev)=>({\n                    ...prev,\n                    [pageIndex]: false\n                }));\n        }\n    };\n    const handleRegenerateImage = async (e)=>{\n        e.stopPropagation();\n        const pageIndex = currentPageIndex;\n        if (loadingImages[pageIndex]) return;\n        setLoadingImages((prev)=>({\n                ...prev,\n                [pageIndex]: true\n            }));\n        try {\n            const referenceToUse = bookRef.current.metadata.baseCharacterImageUrl || sessionReferenceImage;\n            const isCover = pageIndex === 0;\n            const textToRender = isCover ? bookRef.current.metadata.title : undefined;\n            const url = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageImage)(bookRef.current.pages[pageIndex].imagePrompt, fullCharacterDescription, bookRef.current.metadata.artStyle, referenceToUse || undefined, isCover, textToRender);\n            if (url) {\n                setImages((prev)=>({\n                        ...prev,\n                        [pageIndex]: url\n                    }));\n                if (pageIndex === 0 && !bookRef.current.metadata.baseCharacterImageUrl) {\n                    setSessionReferenceImage(url);\n                }\n                updateBookState(pageIndex, url);\n            }\n        } catch (error) {\n            console.error(\"Regeneration failed\", error);\n            alert(\"שגיאה ביצירת התמונה מחדש\");\n        } finally{\n            setLoadingImages((prev)=>({\n                    ...prev,\n                    [pageIndex]: false\n                }));\n        }\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"BookViewer.useEffect\": ()=>{\n            const page = book.pages[currentPageIndex];\n            if (page && !images[currentPageIndex]) {\n                loadImage(currentPageIndex, page.imagePrompt);\n            }\n        }\n    }[\"BookViewer.useEffect\"], [\n        currentPageIndex\n    ]);\n    const prepareExportCanvas = async (i, imgUrl)=>{\n        const isCover = i === 0;\n        // EXPORT LAYOUT STRATEGY:\n        // Cover: 1024x1024 Square (Image contains title, no extra text area)\n        // Inner: 1024x1280 (1024x1024 Image Top + 1024x256 Text Area Bottom)\n        const width = 1024;\n        const height = isCover ? 1024 : 1280;\n        const container = document.createElement('div');\n        container.style.width = \"\".concat(width, \"px\");\n        container.style.height = \"\".concat(height, \"px\");\n        container.style.position = 'absolute';\n        container.style.left = '-9999px';\n        container.style.backgroundColor = '#ffffff';\n        container.style.overflow = 'hidden';\n        if (isCover) {\n            // Cover is simple full image\n            container.innerHTML = '<img src=\"'.concat(imgUrl, '\" style=\"width: 1024px; height: 1024px; object-fit: cover;\" />');\n        } else {\n            // Inner pages: Vertical Stack. Image Top, Text Bottom.\n            const text = book.pages[i].hebrewText || \"\";\n            // Improved text styling matching globals.css updates\n            container.innerHTML = '\\n            <div style=\"display: flex; flex-direction: column; width: 1024px; height: 1280px; background: white;\">\\n                <div style=\"width: 1024px; height: 1000px; flex-shrink: 0; background-color: #f8fafc;\">\\n                    <img src=\"'.concat(imgUrl, '\" style=\"width: 100%; height: 100%; object-fit: cover; display: block;\" />\\n                </div>\\n                <div style=\"\\n                    width: 1024px; \\n                    height: 280px; \\n                    display: flex; \\n                    align-items: center; \\n                    justify-content: center; \\n                    padding: 32px 48px; \\n                    box-sizing: border-box; \\n                    background: linear-gradient(to bottom, #fffdf5 0%, #fff8e7 30%, #fdecc8 70%, #fbe3b2 100%);\\n                    box-shadow: inset 0 2px 0 rgba(255, 255, 255, 0.8), inset 0 -2px 8px rgba(0, 0, 0, 0.05);\\n                    border-top: 3px solid rgba(255, 255, 255, 0.9);\\n                \">\\n                     <p style=\"\\n                        margin: 0; \\n                        font-family: \\'Rubik\\', \\'Heebo\\', \\'Arial\\', sans-serif; \\n                        font-size: 44px; \\n                        font-weight: 600; \\n                        color: #2a1a0a; \\n                        direction: rtl; \\n                        text-align: center; \\n                        line-height: 1.7;\\n                        text-shadow: 0 1px 0 rgba(255, 255, 255, 0.8), 0 2px 4px rgba(0, 0, 0, 0.06);\\n                        letter-spacing: 0.01em;\\n                     \">\\n                        ').concat(text, \"\\n                     </p>\\n                </div>\\n            </div>\\n        \");\n        }\n        document.body.appendChild(container);\n        await new Promise((resolve)=>setTimeout(resolve, 500));\n        const canvas = await html2canvas__WEBPACK_IMPORTED_MODULE_4___default()(container, {\n            scale: 1,\n            useCORS: true,\n            width,\n            height\n        });\n        document.body.removeChild(container);\n        return canvas;\n    };\n    const handleDownloadZIP = async ()=>{\n        if (isExporting) return;\n        setIsExporting(true);\n        setExportProgress('מכין חבילה מלאה...');\n        const zip = new (jszip__WEBPACK_IMPORTED_MODULE_6___default())();\n        // A4 Portrait for standardized printing\n        const pdf = new jspdf__WEBPACK_IMPORTED_MODULE_5__.jsPDF('p', 'mm', 'a4');\n        const pageWidth = 210;\n        try {\n            zip.file(\"sequel_data.json\", JSON.stringify(bookRef.current, null, 2));\n            for(let i = 0; i < book.pages.length; i++){\n                setExportProgress(\"מעבד עמוד \".concat(i + 1, \" מתוך \").concat(book.pages.length, \"...\"));\n                let imgUrl = images[i];\n                const isCover = i === 0;\n                if (!imgUrl) {\n                    const referenceToUse = bookRef.current.metadata.baseCharacterImageUrl || sessionReferenceImage;\n                    const textToRender = isCover ? bookRef.current.metadata.title || '' : undefined;\n                    imgUrl = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageImage)(book.pages[i].imagePrompt, fullCharacterDescription, book.metadata.artStyle, referenceToUse || undefined, isCover, textToRender);\n                    if (imgUrl) {\n                        setImages((prev)=>({\n                                ...prev,\n                                [i]: imgUrl\n                            }));\n                        if (!referenceToUse && !sessionReferenceImage) setSessionReferenceImage(imgUrl);\n                        updateBookState(i, imgUrl); // Sync!\n                    }\n                }\n                if (imgUrl) {\n                    const canvas = await prepareExportCanvas(i, imgUrl);\n                    const pngBlob = await new Promise((resolve)=>canvas.toBlob(resolve, 'image/png'));\n                    if (pngBlob) zip.file(i === 0 ? '00_COVER.png' : \"PAGE_\".concat(String(i).padStart(2, '0'), \".png\"), pngBlob);\n                    const imgData = canvas.toDataURL('image/jpeg', 0.9);\n                    // PDF Layout\n                    const canvasRatio = canvas.height / canvas.width;\n                    const pdfImgHeight = pageWidth * canvasRatio;\n                    // If height exceeds A4 (297mm), scale down to fit\n                    let renderWidth = pageWidth;\n                    let renderHeight = pdfImgHeight;\n                    if (renderHeight > 297) {\n                        const scale = 297 / renderHeight;\n                        renderHeight = 297;\n                        renderWidth = pageWidth * scale;\n                    }\n                    const xOffset = (210 - renderWidth) / 2;\n                    pdf.addImage(imgData, 'JPEG', xOffset, 0, renderWidth, renderHeight);\n                    if (i < book.pages.length - 1) pdf.addPage();\n                }\n                if (audioEnabled) {\n                    let audioBuf = audioBuffers[i];\n                    if (!audioBuf) {\n                        if (!audioContextRef.current) audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)({\n                            sampleRate: 24000\n                        });\n                        const buf = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageAudio)(i === 0 ? book.metadata.title : book.pages[i].hebrewText, audioContextRef.current, voiceName);\n                        if (buf) {\n                            audioBuf = buf;\n                            setAudioBuffers((prev)=>({\n                                    ...prev,\n                                    [i]: buf\n                                }));\n                        }\n                    }\n                    if (audioBuf) zip.file(i === 0 ? '00_AUDIO_Title.wav' : \"AUDIO_Page_\".concat(String(i).padStart(2, '0'), \".wav\"), audioBufferToWav(audioBuf));\n                }\n            }\n            const pdfBlob = pdf.output('blob');\n            zip.file(\"\".concat(book.metadata.title, \".pdf\"), pdfBlob);\n            const content = await zip.generateAsync({\n                type: 'blob'\n            });\n            // Upload to Google Drive if connected\n            let driveLinks = null;\n            try {\n                const { hasDriveAccess, uploadBookToDrive } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/googleDrive */ \"(app-pages-browser)/./services/googleDrive.ts\"));\n                if (hasDriveAccess()) {\n                    setExportProgress('מעלה ל-Google Drive...');\n                    driveLinks = await uploadBookToDrive(content, pdfBlob, book.metadata.title);\n                }\n            } catch (driveError) {\n                console.warn('Drive upload failed:', driveError);\n            }\n            // Save to Firestore WITH Drive links\n            setExportProgress('שומר מידע...');\n            try {\n                const { saveBookPrompts } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/firebase */ \"(app-pages-browser)/./services/firebase.ts\"));\n                await saveBookPrompts({\n                    bookTitle: book.metadata.title,\n                    mainCharacter: book.metadata.mainCharacterDescription || '',\n                    artStyle: book.metadata.artStyle,\n                    topic: book.metadata.mainTheme || '',\n                    imagePrompts: book.pages.map((p)=>p.imagePrompt),\n                    driveZipUrl: driveLinks === null || driveLinks === void 0 ? void 0 : driveLinks.zipLink,\n                    drivePdfUrl: driveLinks === null || driveLinks === void 0 ? void 0 : driveLinks.pdfLink\n                });\n                console.log('Book saved to Firestore with Drive links!');\n            } catch (firebaseError) {\n                console.warn('Firestore save failed:', firebaseError);\n            }\n            // Download locally\n            const link = document.createElement('a');\n            link.href = URL.createObjectURL(content);\n            const safeTitle = book.metadata.title.replace(/[\\\\/:*?\"<>|]/g, '_');\n            link.download = \"\".concat(safeTitle, \".zip\");\n            link.click();\n            // Show Drive links if uploaded\n            if (driveLinks) {\n                setTimeout(()=>{\n                    const showLinks = confirm(\"הספר הועלה ל-Google Drive!\\n\\nלהציג קישורים?\");\n                    if (showLinks) {\n                        alert(\"\\uD83D\\uDCE6 ZIP: \".concat(driveLinks.zipLink, \"\\n\\n\\uD83D\\uDCC4 PDF: \").concat(driveLinks.pdfLink));\n                    }\n                }, 500);\n            }\n        } catch (error) {\n            console.error(\"Export failed:\", error);\n            alert(\"הייצוא נכשל. אנא נסה שוב.\");\n        } finally{\n            setIsExporting(false);\n            setExportProgress('');\n        }\n    };\n    const handleDownloadPDF = async ()=>{\n        if (isExporting) return;\n        setIsExporting(true);\n        setExportProgress('יוצר PDF...');\n        const pdf = new jspdf__WEBPACK_IMPORTED_MODULE_5__.jsPDF('p', 'mm', 'a4');\n        const pageWidth = 210;\n        try {\n            for(let i = 0; i < book.pages.length; i++){\n                setExportProgress(\"מוסיף עמוד \".concat(i + 1, \"...\"));\n                let imgUrl = images[i];\n                const isCover = i === 0;\n                if (!imgUrl) {\n                    const ref = bookRef.current.metadata.baseCharacterImageUrl || sessionReferenceImage;\n                    const textToRender = isCover ? bookRef.current.metadata.title || '' : undefined;\n                    imgUrl = await (0,_services_geminiService__WEBPACK_IMPORTED_MODULE_2__.generatePageImage)(book.pages[i].imagePrompt, fullCharacterDescription, book.metadata.artStyle, ref || undefined, isCover, textToRender);\n                    if (imgUrl) {\n                        setImages((prev)=>({\n                                ...prev,\n                                [i]: imgUrl\n                            }));\n                        updateBookState(i, imgUrl);\n                    }\n                }\n                if (imgUrl) {\n                    const canvas = await prepareExportCanvas(i, imgUrl);\n                    const imgData = canvas.toDataURL('image/jpeg', 0.9);\n                    const canvasRatio = canvas.height / canvas.width;\n                    const pdfImgHeight = pageWidth * canvasRatio;\n                    let renderWidth = pageWidth;\n                    let renderHeight = pdfImgHeight;\n                    if (renderHeight > 297) {\n                        const scale = 297 / renderHeight;\n                        renderHeight = 297;\n                        renderWidth = pageWidth * scale;\n                    }\n                    const xOffset = (210 - renderWidth) / 2;\n                    pdf.addImage(imgData, 'JPEG', xOffset, 0, renderWidth, renderHeight);\n                    if (i < book.pages.length - 1) pdf.addPage();\n                }\n            }\n            const pdfBlob = pdf.output('blob');\n            // Upload to Google Drive if connected\n            let driveLinks = null;\n            try {\n                const { hasDriveAccess, uploadBookToDrive } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/googleDrive */ \"(app-pages-browser)/./services/googleDrive.ts\"));\n                if (hasDriveAccess()) {\n                    setExportProgress('מעלה ל-Google Drive...');\n                    // For PDF only export, we just upload the PDF (mock empty ZIP)\n                    // Or better, we can use a simpler uploadToDrive function, but uploadBookToDrive is handy.\n                    // Let's just upload the PDF using the generic upload function exposed or via uploadBookToDrive passing empty blob for zip?\n                    // Actually uploadBookToDrive expects both. Let's import uploadToDrive directly.\n                    const { uploadToDrive } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/googleDrive */ \"(app-pages-browser)/./services/googleDrive.ts\"));\n                    const safeTitle = book.metadata.title.replace(/[\\\\/:*?\"<>|]/g, '_');\n                    const timestamp = new Date().toISOString().split('T')[0];\n                    const result = await uploadToDrive(pdfBlob, \"\".concat(safeTitle, \"_\").concat(timestamp, \".pdf\"), 'application/pdf');\n                    driveLinks = {\n                        zipLink: '',\n                        pdfLink: result.webViewLink\n                    };\n                }\n            } catch (driveError) {\n                console.warn('Drive upload failed:', driveError);\n            }\n            // Log book metadata to Firestore WITH Drive link\n            setExportProgress('שומר מידע...');\n            try {\n                const { saveBookPrompts } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/services/firebase */ \"(app-pages-browser)/./services/firebase.ts\"));\n                await saveBookPrompts({\n                    bookTitle: book.metadata.title,\n                    mainCharacter: book.metadata.mainCharacterDescription || '',\n                    artStyle: book.metadata.artStyle,\n                    topic: book.metadata.mainTheme || '',\n                    imagePrompts: book.pages.map((p)=>p.imagePrompt),\n                    drivePdfUrl: driveLinks === null || driveLinks === void 0 ? void 0 : driveLinks.pdfLink\n                });\n                console.log('Book metadata saved to Firestore!');\n            } catch (firebaseError) {\n                console.warn('Firestore save failed:', firebaseError);\n            }\n            const safeTitle = book.metadata.title.replace(/[\\\\/:*?\"<>|]/g, '_');\n            pdf.save(\"\".concat(safeTitle, \".pdf\"));\n            // Show Drive links if uploaded\n            if (driveLinks === null || driveLinks === void 0 ? void 0 : driveLinks.pdfLink) {\n                setTimeout(()=>{\n                    const showLinks = confirm(\"ה-PDF הועלה ל-Google Drive!\\n\\nלהציג קישור?\");\n                    if (showLinks) {\n                        alert(\"\\uD83D\\uDCC4 PDF: \".concat(driveLinks.pdfLink));\n                    }\n                }, 500);\n            }\n        } finally{\n            setIsExporting(false);\n            setExportProgress('');\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"fixed inset-0 bg-slate-900 z-[100] flex flex-col items-center\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"w-full bg-white px-4 h-20 flex items-center justify-between shadow-md shrink-0 z-50\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center gap-4\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: onClose,\n                                className: \"text-slate-600 hover:text-slate-900 font-bold flex items-center gap-2\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        className: \"text-xl\",\n                                        children: \"←\"\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 596,\n                                        columnNumber: 13\n                                    }, undefined),\n                                    \" חזרה לעריכה\"\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 595,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: handleChangeKey,\n                                className: \"text-slate-400 hover:text-slate-600 text-xs font-bold border border-slate-200 px-2 py-1 rounded-full flex items-center gap-1\",\n                                children: \"\\uD83D\\uDD11 API\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 598,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 594,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center gap-3\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_DriveConnectButton__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {}, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 603,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: handleDownloadZIP,\n                                disabled: isExporting,\n                                className: \"bg-kid-orange hover:bg-orange-400 text-white font-bold py-2 px-4 rounded-full text-sm transition-all flex items-center gap-2\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        children: \"חבילה מלאה\"\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 605,\n                                        columnNumber: 13\n                                    }, undefined),\n                                    \" \\uD83D\\uDCE6\"\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 604,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: handleDownloadPDF,\n                                disabled: isExporting,\n                                className: \"bg-kid-blue hover:bg-teal-400 text-white font-bold py-2 px-4 rounded-full text-sm transition-all\",\n                                children: \"PDF בלבד \\uD83D\\uDCC4\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 607,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 602,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                lineNumber: 593,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex-grow w-full flex items-center justify-center p-4 overflow-auto bg-slate-800\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"relative w-full max-w-[550px] bg-white rounded-2xl shadow-2xl overflow-hidden group border-4 border-white flex flex-col\",\n                    children: images[currentPageIndex] ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"relative w-full \".concat(currentPageIndex === 0 ? 'h-full aspect-square' : 'aspect-square shrink-0', \" bg-slate-100\"),\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                                        src: images[currentPageIndex],\n                                        className: \"w-full h-full object-cover\"\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 622,\n                                        columnNumber: 17\n                                    }, undefined),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        onClick: handleRegenerateImage,\n                                        disabled: loadingImages[currentPageIndex],\n                                        className: \"absolute top-4 left-4 z-30 bg-white/80 hover:bg-white text-slate-700 p-2 rounded-full shadow-lg backdrop-blur-sm transition-all hover:scale-110 disabled:opacity-50\",\n                                        title: \"צייר מחדש את התמונה\",\n                                        children: loadingImages[currentPageIndex] ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"w-6 h-6 border-2 border-slate-700 border-t-transparent rounded-full animate-spin\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 631,\n                                            columnNumber: 21\n                                        }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            className: \"text-xl\",\n                                            children: \"\\uD83D\\uDD04\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 633,\n                                            columnNumber: 21\n                                        }, undefined)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 624,\n                                        columnNumber: 17\n                                    }, undefined),\n                                    currentPageIndex === 0 && audioEnabled && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"absolute bottom-6 right-6 flex flex-col items-end gap-2 z-20\",\n                                        children: [\n                                            audioError && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                className: \"text-xs text-red-500 bg-white px-2 py-1 rounded-full font-bold shadow-md\",\n                                                children: audioError\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                lineNumber: 640,\n                                                columnNumber: 36\n                                            }, undefined),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                onClick: (e)=>{\n                                                    e.stopPropagation();\n                                                    handleToggleAudio();\n                                                },\n                                                disabled: isLoadingAudio,\n                                                className: \"\\n                                flex items-center justify-center w-14 h-14 rounded-full shadow-lg border-4 border-white transition-all\\n                                \".concat(isPlaying ? 'bg-red-500 text-white animate-pulse' : 'bg-kid-blue text-white hover:bg-teal-400 hover:scale-110', \"\\n                                \").concat(audioError ? 'bg-slate-400 border-slate-200' : '', \"\\n                            \"),\n                                                children: isLoadingAudio ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                    className: \"w-6 h-6 border-3 border-white border-t-transparent rounded-full animate-spin\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                    lineNumber: 650,\n                                                    columnNumber: 41\n                                                }, undefined) : isPlaying ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"text-3xl\",\n                                                    children: \"⏹\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                    lineNumber: 650,\n                                                    columnNumber: 156\n                                                }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"text-3xl\",\n                                                    children: \"\\uD83D\\uDD0A\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                    lineNumber: 650,\n                                                    columnNumber: 194\n                                                }, undefined)\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                                lineNumber: 641,\n                                                columnNumber: 21\n                                            }, undefined)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 639,\n                                        columnNumber: 19\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 621,\n                                columnNumber: 15\n                            }, undefined),\n                            currentPageIndex !== 0 && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"w-full book-text-container flex items-center justify-between flex-1\",\n                                children: [\n                                    audioEnabled && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        onClick: (e)=>{\n                                            e.stopPropagation();\n                                            handleToggleAudio();\n                                        },\n                                        disabled: isLoadingAudio,\n                                        className: \"\\n                                shrink-0 flex items-center justify-center w-12 h-12 rounded-full shadow-sm transition-all mr-6\\n                                \".concat(isPlaying ? 'bg-red-500 text-white animate-pulse' : 'bg-kid-blue text-white hover:bg-teal-400', \"\\n                                \").concat(isLoadingAudio ? 'opacity-70 cursor-wait' : '', \"\\n                                \").concat(audioError ? 'bg-slate-400' : '', \"\\n                            \"),\n                                        children: isLoadingAudio ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 671,\n                                            columnNumber: 41\n                                        }, undefined) : isPlaying ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            className: \"text-2xl\",\n                                            children: \"⏹\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 671,\n                                            columnNumber: 156\n                                        }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            className: \"text-2xl\",\n                                            children: \"\\uD83D\\uDD0A\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 671,\n                                            columnNumber: 194\n                                        }, undefined)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 661,\n                                        columnNumber: 21\n                                    }, undefined),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"flex-1 text-center flex items-center justify-center\",\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                            className: \"book-text\",\n                                            children: currentPage.hebrewText\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                            lineNumber: 676,\n                                            columnNumber: 21\n                                        }, undefined)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                        lineNumber: 675,\n                                        columnNumber: 19\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 658,\n                                columnNumber: 17\n                            }, undefined)\n                        ]\n                    }, void 0, true) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"w-full aspect-square flex flex-col items-center justify-center bg-slate-100\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"w-12 h-12 border-4 border-kid-blue border-t-transparent rounded-full animate-spin mb-4\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 685,\n                                columnNumber: 15\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                className: \"font-bold text-slate-500\",\n                                children: \"מצייר רגע קסום...\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                                lineNumber: 686,\n                                columnNumber: 15\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 684,\n                        columnNumber: 13\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                    lineNumber: 614,\n                    columnNumber: 9\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                lineNumber: 613,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"w-full bg-white/10 backdrop-blur-md p-6 flex justify-center items-center gap-10\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: handlePrev,\n                        disabled: currentPageIndex === 0,\n                        className: \"w-14 h-14 bg-white/20 hover:bg-white/40 text-white rounded-full text-2xl disabled:opacity-20 transition-all\",\n                        children: \"←\"\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 693,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                        className: \"text-white font-bold bg-black/40 px-6 py-2 rounded-full\",\n                        children: [\n                            \"עמוד \",\n                            currentPageIndex + 1,\n                            \" מתוך \",\n                            totalPages\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 694,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: handleNext,\n                        disabled: currentPageIndex === totalPages - 1,\n                        className: \"w-14 h-14 bg-kid-yellow hover:bg-yellow-400 text-slate-900 rounded-full text-2xl disabled:opacity-20 transition-all\",\n                        children: \"→\"\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                        lineNumber: 697,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                lineNumber: 692,\n                columnNumber: 7\n            }, undefined),\n            isExporting && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"fixed inset-0 z-[400] bg-slate-900/90 flex items-center justify-center text-white\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"text-center\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"w-16 h-16 border-4 border-kid-blue border-t-transparent rounded-full animate-spin mx-auto mb-6\"\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                            lineNumber: 703,\n                            columnNumber: 13\n                        }, undefined),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                            className: \"text-2xl font-bold font-fredoka\",\n                            children: exportProgress\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                            lineNumber: 704,\n                            columnNumber: 13\n                        }, undefined)\n                    ]\n                }, void 0, true, {\n                    fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                    lineNumber: 702,\n                    columnNumber: 11\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n                lineNumber: 701,\n                columnNumber: 9\n            }, undefined)\n        ]\n    }, void 0, true, {\n        fileName: \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shahar\\\\bookai\\\\components\\\\BookViewer.tsx\",\n        lineNumber: 592,\n        columnNumber: 5\n    }, undefined);\n};\n_s(BookViewer, \"t6oHnyOc5fHACHQZGgQuPJY5mz0=\");\n_c = BookViewer;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (BookViewer);\nvar _c;\n$RefreshReg$(_c, \"BookViewer\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2NvbXBvbmVudHMvQm9va1ZpZXdlci50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUVtRTtBQUVZO0FBQ2Y7QUFDM0I7QUFDUjtBQUNKO0FBUXpCLDRDQUE0QztBQUM1QyxTQUFTVyxpQkFBaUJDLE1BQW1CO0lBQzNDLE1BQU1DLGNBQWNELE9BQU9FLGdCQUFnQjtJQUMzQyxNQUFNQyxhQUFhSCxPQUFPRyxVQUFVO0lBQ3BDLE1BQU1DLFNBQVMsR0FBRyxNQUFNO0lBQ3hCLE1BQU1DLFdBQVc7SUFDakIsTUFBTUMsaUJBQWlCRCxXQUFXO0lBQ2xDLE1BQU1FLGFBQWFOLGNBQWNLO0lBQ2pDLE1BQU1FLGdCQUFnQlIsT0FBT1MsTUFBTSxHQUFHRjtJQUN0QyxNQUFNRyxrQkFBa0I7SUFDeEIsTUFBTUMsaUJBQWlCRCxrQkFBa0JGO0lBQ3pDLE1BQU1JLGVBQWUsSUFBSUMsWUFBWUg7SUFDckMsTUFBTUksT0FBTyxJQUFJQyxTQUFTSDtJQUMxQixNQUFNSSxjQUFjLENBQUNGLE1BQWdCRyxRQUFnQkM7UUFDbkQsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlELE9BQU9ULE1BQU0sRUFBRVUsSUFBSztZQUN0Q0wsS0FBS00sUUFBUSxDQUFDSCxTQUFTRSxHQUFHRCxPQUFPRyxVQUFVLENBQUNGO1FBQzlDO0lBQ0Y7SUFDQUgsWUFBWUYsTUFBTSxHQUFHO0lBQ3JCQSxLQUFLUSxTQUFTLENBQUMsR0FBR1gsaUJBQWlCLEdBQUc7SUFDdENLLFlBQVlGLE1BQU0sR0FBRztJQUNyQkUsWUFBWUYsTUFBTSxJQUFJO0lBQ3RCQSxLQUFLUSxTQUFTLENBQUMsSUFBSSxJQUFJO0lBQ3ZCUixLQUFLUyxTQUFTLENBQUMsSUFBSW5CLFFBQVE7SUFDM0JVLEtBQUtTLFNBQVMsQ0FBQyxJQUFJdEIsYUFBYTtJQUNoQ2EsS0FBS1EsU0FBUyxDQUFDLElBQUluQixZQUFZO0lBQy9CVyxLQUFLUSxTQUFTLENBQUMsSUFBSW5CLGFB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O3dCQUFJQyxXQUFVOzswQ0FDYiw4REFBQ0Q7Z0NBQUlDLFdBQVU7Ozs7OzswQ0FDZiw4REFBQ2xLO2dDQUFFa0ssV0FBVTswQ0FBMkI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7MEJBTWhELDhEQUFDRDtnQkFBSUMsV0FBVTs7a0NBQ2IsOERBQUNDO3dCQUFPQyxTQUFTN0c7d0JBQVkrRyxVQUFVekwscUJBQXFCO3dCQUFHcUwsV0FBVTtrQ0FBOEc7Ozs7OztrQ0FDdkwsOERBQUNHO3dCQUFLSCxXQUFVOzs0QkFBMEQ7NEJBQ2xFckwsbUJBQW1COzRCQUFFOzRCQUFPbUM7Ozs7Ozs7a0NBRXBDLDhEQUFDbUo7d0JBQU9DLFNBQVM5Rzt3QkFBWWdILFVBQVV6TCxxQkFBcUJtQyxhQUFhO3dCQUFHa0osV0FBVTtrQ0FBc0g7Ozs7Ozs7Ozs7OztZQUc3TWpLLDZCQUNDLDhEQUFDZ0s7Z0JBQUlDLFdBQVU7MEJBQ2IsNEVBQUNEO29CQUFJQyxXQUFVOztzQ0FDYiw4REFBQ0Q7NEJBQUlDLFdBQVU7Ozs7OztzQ0FDZiw4REFBQ087NEJBQUdQLFdBQVU7c0NBQW1DL0o7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTTdEO0dBdm9CTTFCO0tBQUFBO0FBeW9CTixpRUFBZUEsVUFBVUEsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxMRU5PVk9cXERlc2t0b3BcXHNoYWhhclxcYm9va2FpXFxjb21wb25lbnRzXFxCb29rVmlld2VyLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGNsaWVudCdcblxuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZU1lbW8sIHVzZVJlZiB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgQm9vayB9IGZyb20gJ0AvdHlwZXMnXG5pbXBvcnQgeyBnZW5lcmF0ZVBhZ2VJbWFnZSwgZ2VuZXJhdGVQYWdlQXVkaW8gfSBmcm9tICdAL3NlcnZpY2VzL2dlbWluaVNlcnZpY2UnXG5pbXBvcnQgRHJpdmVDb25uZWN0QnV0dG9uIGZyb20gJ0AvY29tcG9uZW50cy9Ecml2ZUNvbm5lY3RCdXR0b24nXG5pbXBvcnQgaHRtbDJjYW52YXMgZnJvbSAnaHRtbDJjYW52YXMnXG5pbXBvcnQgeyBqc1BERiB9IGZyb20gJ2pzcGRmJ1xuaW1wb3J0IEpTWmlwIGZyb20gJ2pzemlwJ1xuXG5pbnRlcmZhY2UgQm9va1ZpZXdlclByb3BzIHtcbiAgYm9vazogQm9vaztcbiAgb25VcGRhdGVCb29rOiAoYm9vazogQm9vaykgPT4gdm9pZDtcbiAgb25DbG9zZTogKCkgPT4gdm9pZDtcbn1cblxuLy8gSGVscGVyIHRvIGNvbnZlcnQgQXVkaW9CdWZmZXIgdG8gV0FWIEJsb2JcbmZ1bmN0aW9uIGF1ZGlvQnVmZmVyVG9XYXYoYnVmZmVyOiBBdWRpb0J1ZmZlcik6IEJsb2Ige1xuICBjb25zdCBudW1DaGFubmVscyA9IGJ1ZmZlci5udW1iZXJPZkNoYW5uZWxzO1xuICBjb25zdCBzYW1wbGVSYXRlID0gYnVmZmVyLnNhbXBsZVJhdGU7XG4gIGNvbnN0IGZvcm1hdCA9IDE7IC8vIFBDTVxuICBjb25zdCBiaXREZXB0aCA9IDE2O1xuICBjb25zdCBieXRlc1BlclNhbXBsZSA9IGJpdERlcHRoIC8gODtcbiAgY29uc3QgYmxvY2tBbGlnbiA9IG51bUNoYW5uZWxzICogYnl0ZXNQZXJTYW1wbGU7XG4gIGNvbnN0IGRhdGFCeXRlQ291bnQgPSBidWZmZXIubGVuZ3RoICogYmxvY2tBbGlnbjtcbiAgY29uc3QgaGVhZGVyQnl0ZUNvdW50ID0gNDQ7XG4gIGNvbnN0IHRvdGFsQnl0ZUNvdW50ID0gaGVhZGVyQnl0ZUNvdW50ICsgZGF0YUJ5dGVDb3VudDtcbiAgY29uc3QgaGVhZGVyQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGhlYWRlckJ5dGVDb3VudCk7XG4gIGNvbnN0IHZpZXcgPSBuZXcgRGF0YVZpZXcoaGVhZGVyQnVmZmVyKTtcbiAgY29uc3Qgd3JpdGVTdHJpbmcgPSAodmlldzogRGF0YVZpZXcsIG9mZnNldDogbnVtYmVyLCBzdHJpbmc6IHN0cmluZykgPT4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyaW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2aWV3LnNldFVpbnQ4KG9mZnNldCArIGksIHN0cmluZy5jaGFyQ29kZUF0KGkpKTtcbiAgICB9XG4gIH07XG4gIHdyaXRlU3RyaW5nKHZpZXcsIDAsICdSSUZGJyk7XG4gIHZpZXcuc2V0VWludDMyKDQsIHRvdGFsQnl0ZUNvdW50IC0gOCwgdHJ1ZSk7XG4gIHdyaXRlU3RyaW5nKHZpZXcsIDgsICdXQVZFJyk7XG4gIHdyaXRlU3RyaW5nKHZpZXcsIDEyLCAnZm10ICcpO1xuICB2aWV3LnNldFVpbnQzMigxNiwgMTYsIHRydWUpO1xuICB2aWV3LnNldFVpbnQxNigyMCwgZm9ybWF0LCB0cnVlKTtcbiAgdmlldy5zZXRVaW50MTYoMjIsIG51bUNoYW5uZWxzLCB0cnVlKTtcbiAgdmlldy5zZXRVaW50MzIoMjQsIHNhbXBsZVJhdGUsIHRydWUpO1xuICB2aWV3LnNldFVpbnQzMigyOCwgc2FtcGxlUmF0ZSAqIGJsb2NrQWxpZ24sIHRydWUpO1xuICB2aWV3LnNldFVpbnQxNigzMiwgYmxvY2tBbGlnbiwgdHJ1ZSk7XG4gIHZpZXcuc2V0VWludDE2KDM0LCBiaXREZXB0aCwgdHJ1ZSk7XG4gIHdyaXRlU3RyaW5nKHZpZXcsIDM2LCAnZGF0YScpO1xuICB2aWV3LnNldFVpbnQzMig0MCwgZGF0YUJ5dGVDb3VudCwgdHJ1ZSk7XG4gIGNvbnN0IGRhdGFCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoZGF0YUJ5dGVDb3VudCk7XG4gIGNvbnN0IGRhdGFWaWV3ID0gbmV3IERhdGFWaWV3KGRhdGFCdWZmZXIpO1xuICBsZXQgb2Zmc2V0ID0gMDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBidWZmZXIubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBjaGFubmVsID0gMDsgY2hhbm5lbCA8IG51bUNoYW5uZWxzOyBjaGFubmVsKyspIHtcbiAgICAgIGNvbnN0IHNhbXBsZSA9IGJ1ZmZlci5nZXRDaGFubmVsRGF0YShjaGFubmVsKVtpXTtcbiAgICAgIGNvbnN0IHMgPSBNYXRoLm1heCgtMSwgTWF0aC5taW4oMSwgc2FtcGxlKSk7XG4gICAgICBjb25zdCBpbnQxNiA9IHMgPCAwID8gcyAqIDB4ODAwMCA6IHMgKiAweDdGRkY7XG4gICAgICBkYXRhVmlldy5zZXRJbnQxNihvZmZzZXQsIGludDE2LCB0cnVlKTtcbiAgICAgIG9mZnNldCArPSAyO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbmV3IEJsb2IoW2hlYWRlckJ1ZmZlciwgZGF0YUJ1ZmZlcl0sIHsgdHlwZTogJ2F1ZGlvL3dhdicgfSk7XG59XG5cbmNvbnN0IEJvb2tWaWV3ZXI6IFJlYWN0LkZDPEJvb2tWaWV3ZXJQcm9wcz4gPSAoeyBib29rLCBvblVwZGF0ZUJvb2ssIG9uQ2xvc2UgfSkgPT4ge1xuICBjb25zdCBbY3VycmVudFBhZ2VJbmRleCwgc2V0Q3VycmVudFBhZ2VJbmRleF0gPSB1c2VTdGF0ZSgwKTtcbiAgY29uc3QgYm9va1JlZiA9IHVzZVJlZihib29rKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGJvb2tSZWYuY3VycmVudCA9IGJvb2s7XG4gIH0sIFtib29rXSk7XG5cbiAgY29uc3QgW2ltYWdlcywgc2V0SW1hZ2VzXSA9IHVzZVN0YXRlPFJlY29yZDxudW1iZXIsIHN0cmluZz4+KCgpID0+IHtcbiAgICBjb25zdCBpbml0aWFsSW1hZ2VzOiBSZWNvcmQ8bnVtYmVyLCBzdHJpbmc+ID0ge307XG4gICAgYm9vay5wYWdlcy5mb3JFYWNoKChwYWdlLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKHBhZ2UuZ2VuZXJhdGVkSW1hZ2VVcmwpIHtcbiAgICAgICAgaW5pdGlhbEltYWdlc1tpbmRleF0gPSBwYWdlLmdlbmVyYXRlZEltYWdlVXJsO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBpbml0aWFsSW1hZ2VzO1xuICB9KTtcblxuICBjb25zdCBbbG9hZGluZ0ltYWdlcywgc2V0TG9hZGluZ0ltYWdlc10gPSB1c2VTdGF0ZTxSZWNvcmQ8bnVtYmVyLCBib29sZWFuPj4oe30pO1xuXG4gIGNvbnN0IFtzZXNzaW9uUmVmZXJlbmNlSW1hZ2UsIHNldFNlc3Npb25SZWZlcmVuY2VJbWFnZV0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihcbiAgICBib29rLm1ldGFkYXRhLmJhc2VDaGFyYWN0ZXJJbWFnZVVybCB8fCBib29rLnBhZ2VzLmZpbmQocCA9PiBwLmdlbmVyYXRlZEltYWdlVXJsKT8uZ2VuZXJhdGVkSW1hZ2VVcmwgfHwgbnVsbFxuICApO1xuXG4gIGNvbnN0IFtpc0V4cG9ydGluZywgc2V0SXNFeHBvcnRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbZXhwb3J0UHJvZ3Jlc3MsIHNldEV4cG9ydFByb2dyZXNzXSA9IHVzZVN0YXRlKCcnKTtcblxuICBjb25zdCBbaXNQbGF5aW5nLCBzZXRJc1BsYXlpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbaXNMb2FkaW5nQXVkaW8sIHNldElzTG9hZGluZ0F1ZGlvXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2F1ZGlvRXJyb3IsIHNldEF1ZGlvRXJyb3JdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFthdWRpb0J1ZmZlcnMsIHNldEF1ZGlvQnVmZmVyc10gPSB1c2VTdGF0ZTxSZWNvcmQ8bnVtYmVyLCBBdWRpb0J1ZmZlcj4+KHt9KTtcbiAgY29uc3QgYXVkaW9Db250ZXh0UmVmID0gdXNlUmVmPEF1ZGlvQ29udGV4dCB8IG51bGw+KG51bGwpO1xuICBjb25zdCBhdWRpb1NvdXJjZVJlZiA9IHVzZVJlZjxBdWRpb0J1ZmZlclNvdXJjZU5vZGUgfCBudWxsPihudWxsKTtcblxuICBjb25zdCBjdXJyZW50UGFnZSA9IGJvb2sucGFnZXNbY3VycmVudFBhZ2VJbmRleF07XG4gIGNvbnN0IHRvdGFsUGFnZXMgPSBib29rLnBhZ2VzLmxlbmd0aDtcbiAgY29uc3QgYXVkaW9FbmFibGVkID0gYm9vay5tZXRhZGF0YS5hdWRpb0NvbmZpZz8uZW5hYmxlZCA/PyB0cnVlO1xuICBjb25zdCB2b2ljZU5hbWUgPSBib29rLm1ldGFkYXRhLmF1ZGlvQ29uZmlnPy52b2ljZU5hbWUgfHwgJ1B1Y2snO1xuXG4gIGNvbnN0IGZ1bGxDaGFyYWN0ZXJEZXNjcmlwdGlvbiA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGxldCBkZXNjID0gYE1haW4gQ2hhcmFjdGVyOiAke2Jvb2subWV0YWRhdGEubWFpbkNoYXJhY3RlckRlc2NyaXB0aW9ufS5gO1xuICAgIGlmIChib29rLm1ldGFkYXRhLm1haW5DaGFyYWN0ZXJEaXN0aW5jdGl2ZU1hcmspIHtcbiAgICAgIGRlc2MgKz0gYCBESVNUSU5DVElWRSBGRUFUVVJFOiAke2Jvb2subWV0YWRhdGEubWFpbkNoYXJhY3RlckRpc3RpbmN0aXZlTWFya30gKE11c3QgYXBwZWFyIGluIGV2ZXJ5IGltYWdlKS5gO1xuICAgIH1cbiAgICBpZiAoYm9vay5tZXRhZGF0YS5zZWNvbmRhcnlDaGFyYWN0ZXJEZXNjcmlwdGlvbikge1xuICAgICAgZGVzYyArPSBgXFxuU2Vjb25kYXJ5IENoYXJhY3RlciAoU2lkZWtpY2spOiAke2Jvb2subWV0YWRhdGEuc2Vjb25kYXJ5Q2hhcmFjdGVyRGVzY3JpcHRpb259IChUaGlzIGFwcGVhcmFuY2UgTVVTVCBiZSBjb25zaXN0ZW50IGFjcm9zcyBhbGwgcGFnZXMpLmA7XG4gICAgICBpZiAoYm9vay5tZXRhZGF0YS5zZWNvbmRhcnlDaGFyYWN0ZXJEaXN0aW5jdGl2ZU1hcmspIHtcbiAgICAgICAgZGVzYyArPSBgIERJU1RJTkNUSVZFIEZFQVRVUkU6ICR7Ym9vay5tZXRhZGF0YS5zZWNvbmRhcnlDaGFyYWN0ZXJEaXN0aW5jdGl2ZU1hcmt9LmA7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkZXNjO1xuICB9LCBbYm9vay5tZXRhZGF0YV0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHN0b3BBdWRpbygpO1xuICAgICAgaWYgKGF1ZGlvQ29udGV4dFJlZi5jdXJyZW50KSB7XG4gICAgICAgIGF1ZGlvQ29udGV4dFJlZi5jdXJyZW50LmNsb3NlKCk7XG4gICAgICB9XG4gICAgfTtcbiAgfSwgW10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgc3RvcEF1ZGlvKCk7XG4gICAgc2V0QXVkaW9FcnJvcihudWxsKTtcbiAgfSwgW2N1cnJlbnRQYWdlSW5kZXhdKTtcblxuICBjb25zdCBzdG9wQXVkaW8gPSAoKSA9PiB7XG4gICAgaWYgKGF1ZGlvU291cmNlUmVmLmN1cnJlbnQpIHtcbiAgICAgIHRyeSB7IGF1ZGlvU291cmNlUmVmLmN1cnJlbnQuc3RvcCgpOyB9IGNhdGNoIChlKSB7IH1cbiAgICAgIGF1ZGlvU291cmNlUmVmLmN1cnJlbnQgPSBudWxsO1xuICAgIH1cbiAgICBzZXRJc1BsYXlpbmcoZmFsc2UpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZUNoYW5nZUtleSA9ICgpID0+IHtcbiAgICBjb25zdCBhaXN0dWRpbyA9ICh3aW5kb3cgYXMgYW55KS5haXN0dWRpbztcbiAgICBpZiAoYWlzdHVkaW8pIGFpc3R1ZGlvLm9wZW5TZWxlY3RLZXkoKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVUb2dnbGVBdWRpbyA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIWF1ZGlvRW5hYmxlZCkgcmV0dXJuO1xuXG4gICAgaWYgKGlzUGxheWluZykge1xuICAgICAgc3RvcEF1ZGlvKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc2V0QXVkaW9FcnJvcihudWxsKTtcblxuICAgIGlmICghYXVkaW9Db250ZXh0UmVmLmN1cnJlbnQpIHtcbiAgICAgIGF1ZGlvQ29udGV4dFJlZi5jdXJyZW50ID0gbmV3ICh3aW5kb3cuQXVkaW9Db250ZXh0IHx8ICh3aW5kb3cgYXMgYW55KS53ZWJraXRBdWRpb0NvbnRleHQpKHsgc2FtcGxlUmF0ZTogMjQwMDAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGF1ZGlvQ29udGV4dFJlZi5jdXJyZW50LnN0YXRlID09PSAnc3VzcGVuZGVkJykge1xuICAgICAgYXdhaXQgYXVkaW9Db250ZXh0UmVmLmN1cnJlbnQucmVzdW1lKCk7XG4gICAgfVxuXG4gICAgY29uc3QgY3R4ID0gYXVkaW9Db250ZXh0UmVmLmN1cnJlbnQ7XG5cbiAgICBpZiAoYXVkaW9CdWZmZXJzW2N1cnJlbnRQYWdlSW5kZXhdKSB7XG4gICAgICBwbGF5QnVmZmVyKGF1ZGlvQnVmZmVyc1tjdXJyZW50UGFnZUluZGV4XSwgY3R4KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzZXRJc0xvYWRpbmdBdWRpbyh0cnVlKTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdGV4dFRvUmVhZCA9IGN1cnJlbnRQYWdlSW5kZXggPT09IDAgPyBib29rLm1ldGFkYXRhLnRpdGxlIDogY3VycmVudFBhZ2UuaGVicmV3VGV4dDtcbiAgICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGdlbmVyYXRlUGFnZUF1ZGlvKHRleHRUb1JlYWQsIGN0eCwgdm9pY2VOYW1lKTtcbiAgICAgIGlmIChidWZmZXIpIHtcbiAgICAgICAgc2V0QXVkaW9CdWZmZXJzKHByZXYgPT4gKHsgLi4ucHJldiwgW2N1cnJlbnRQYWdlSW5kZXhdOiBidWZmZXIgfSkpO1xuICAgICAgICBwbGF5QnVmZmVyKGJ1ZmZlciwgY3R4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldEF1ZGlvRXJyb3IoXCLXqten15zXlCDXkdeZ16bXmdeo16og15DXldeT15nXlVwiKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgc2V0QXVkaW9FcnJvcihcItep15LXmdeQ15Qg15vXnNec15nXqlwiKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNMb2FkaW5nQXVkaW8oZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBwbGF5QnVmZmVyID0gKGJ1ZmZlcjogQXVkaW9CdWZmZXIsIGN0eDogQXVkaW9Db250ZXh0KSA9PiB7XG4gICAgY29uc3Qgc291cmNlID0gY3R4LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICAgIHNvdXJjZS5idWZmZXIgPSBidWZmZXI7XG4gICAgc291cmNlLmNvbm5lY3QoY3R4LmRlc3RpbmF0aW9uKTtcbiAgICBzb3VyY2Uub25lbmRlZCA9ICgpID0+IHNldElzUGxheWluZyhmYWxzZSk7XG4gICAgYXVkaW9Tb3VyY2VSZWYuY3VycmVudCA9IHNvdXJjZTtcbiAgICBzb3VyY2Uuc3RhcnQoKTtcbiAgICBzZXRJc1BsYXlpbmcodHJ1ZSk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlTmV4dCA9ICgpID0+IHsgaWYgKGN1cnJlbnRQYWdlSW5kZXggPCB0b3RhbFBhZ2VzIC0gMSkgc2V0Q3VycmVudFBhZ2VJbmRleCgocHJldikgPT4gcHJldiArIDEpOyB9O1xuICBjb25zdCBoYW5kbGVQcmV2ID0gKCkgPT4geyBpZiAoY3VycmVudFBhZ2VJbmRleCA+IDApIHNldEN1cnJlbnRQYWdlSW5kZXgoKHByZXYpID0+IHByZXYgLSAxKTsgfTtcblxuICBjb25zdCB1cGRhdGVCb29rU3RhdGUgPSAoaW5kZXg6IG51bWJlciwgdXJsOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBjdXJyZW50Qm9va1N0YXRlID0gYm9va1JlZi5jdXJyZW50O1xuICAgIGNvbnN0IHVwZGF0ZWRQYWdlcyA9IFsuLi5jdXJyZW50Qm9va1N0YXRlLnBhZ2VzXTtcbiAgICB1cGRhdGVkUGFnZXNbaW5kZXhdID0geyAuLi51cGRhdGVkUGFnZXNbaW5kZXhdLCBnZW5lcmF0ZWRJbWFnZVVybDogdXJsIH07XG4gICAgY29uc3QgdXBkYXRlZEJvb2sgPSB7IC4uLmN1cnJlbnRCb29rU3RhdGUsIHBhZ2VzOiB1cGRhdGVkUGFnZXMgfTtcbiAgICBvblVwZGF0ZUJvb2sodXBkYXRlZEJvb2spO1xuICB9O1xuXG4gIGNvbnN0IGxvYWRJbWFnZSA9IGFzeW5jIChwYWdlSW5kZXg6IG51bWJlciwgYWN0aW9uUHJvbXB0OiBzdHJpbmcpID0+IHtcbiAgICBpZiAoaW1hZ2VzW3BhZ2VJbmRleF0gfHwgbG9hZGluZ0ltYWdlc1twYWdlSW5kZXhdKSByZXR1cm47XG5cbiAgICBpZiAoYm9va1JlZi5jdXJyZW50LnBhZ2VzW3BhZ2VJbmRleF0uZ2VuZXJhdGVkSW1hZ2VVcmwpIHtcbiAgICAgIHNldEltYWdlcygocHJldikgPT4gKHsgLi4ucHJldiwgW3BhZ2VJbmRleF06IGJvb2tSZWYuY3VycmVudC5wYWdlc1twYWdlSW5kZXhdLmdlbmVyYXRlZEltYWdlVXJsISB9KSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc2V0TG9hZGluZ0ltYWdlcygocHJldikgPT4gKHsgLi4ucHJldiwgW3BhZ2VJbmRleF06IHRydWUgfSkpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZWZlcmVuY2VUb1VzZSA9IGJvb2tSZWYuY3VycmVudC5tZXRhZGF0YS5iYXNlQ2hhcmFjdGVySW1hZ2VVcmwgfHwgc2Vzc2lvblJlZmVyZW5jZUltYWdlO1xuICAgICAgY29uc3QgaXNDb3ZlciA9IHBhZ2VJbmRleCA9PT0gMDtcbiAgICAgIGNvbnN0IHRleHRUb1JlbmRlciA9IGlzQ292ZXIgPyBib29rUmVmLmN1cnJlbnQubWV0YWRhdGEudGl0bGUgOiB1bmRlZmluZWQ7XG5cbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGdlbmVyYXRlUGFnZUltYWdlKFxuICAgICAgICBhY3Rpb25Qcm9tcHQsXG4gICAgICAgIGZ1bGxDaGFyYWN0ZXJEZXNjcmlwdGlvbixcbiAgICAgICAgYm9va1JlZi5jdXJyZW50Lm1ldGFkYXRhLmFydFN0eWxlLFxuICAgICAgICByZWZlcmVuY2VUb1VzZSB8fCB1bmRlZmluZWQsXG4gICAgICAgIGlzQ292ZXIsXG4gICAgICAgIHRleHRUb1JlbmRlclxuICAgICAgKTtcblxuICAgICAgaWYgKHVybCkge1xuICAgICAgICBzZXRJbWFnZXMoKHByZXYpID0+ICh7IC4uLnByZXYsIFtwYWdlSW5kZXhdOiB1cmwgfSkpO1xuICAgICAgICBpZiAoIXJlZmVyZW5jZVRvVXNlICYmICFzZXNzaW9uUmVmZXJlbmNlSW1hZ2UpIHtcbiAgICAgICAgICBzZXRTZXNzaW9uUmVmZXJlbmNlSW1hZ2UodXJsKTtcbiAgICAgICAgfVxuICAgICAgICB1cGRhdGVCb29rU3RhdGUocGFnZUluZGV4LCB1cmwpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVybDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBwYWdlIGltYWdlOlwiLCBlcnIpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldExvYWRpbmdJbWFnZXMoKHByZXYpID0+ICh7IC4uLnByZXYsIFtwYWdlSW5kZXhdOiBmYWxzZSB9KSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGhhbmRsZVJlZ2VuZXJhdGVJbWFnZSA9IGFzeW5jIChlOiBSZWFjdC5Nb3VzZUV2ZW50KSA9PiB7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBjb25zdCBwYWdlSW5kZXggPSBjdXJyZW50UGFnZUluZGV4O1xuICAgIGlmIChsb2FkaW5nSW1hZ2VzW3BhZ2VJbmRleF0pIHJldHVybjtcblxuICAgIHNldExvYWRpbmdJbWFnZXMoKHByZXYpID0+ICh7IC4uLnByZXYsIFtwYWdlSW5kZXhdOiB0cnVlIH0pKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZWZlcmVuY2VUb1VzZSA9IGJvb2tSZWYuY3VycmVudC5tZXRhZGF0YS5iYXNlQ2hhcmFjdGVySW1hZ2VVcmwgfHwgc2Vzc2lvblJlZmVyZW5jZUltYWdlO1xuICAgICAgY29uc3QgaXNDb3ZlciA9IHBhZ2VJbmRleCA9PT0gMDtcbiAgICAgIGNvbnN0IHRleHRUb1JlbmRlciA9IGlzQ292ZXIgPyBib29rUmVmLmN1cnJlbnQubWV0YWRhdGEudGl0bGUgOiB1bmRlZmluZWQ7XG5cbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGdlbmVyYXRlUGFnZUltYWdlKFxuICAgICAgICBib29rUmVmLmN1cnJlbnQucGFnZXNbcGFnZUluZGV4XS5pbWFnZVByb21wdCxcbiAgICAgICAgZnVsbENoYXJhY3RlckRlc2NyaXB0aW9uLFxuICAgICAgICBib29rUmVmLmN1cnJlbnQubWV0YWRhdGEuYXJ0U3R5bGUsXG4gICAgICAgIHJlZmVyZW5jZVRvVXNlIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgaXNDb3ZlcixcbiAgICAgICAgdGV4dFRvUmVuZGVyXG4gICAgICApO1xuXG4gICAgICBpZiAodXJsKSB7XG4gICAgICAgIHNldEltYWdlcygocHJldikgPT4gKHsgLi4ucHJldiwgW3BhZ2VJbmRleF06IHVybCB9KSk7XG4gICAgICAgIGlmIChwYWdlSW5kZXggPT09IDAgJiYgIWJvb2tSZWYuY3VycmVudC5tZXRhZGF0YS5iYXNlQ2hhcmFjdGVySW1hZ2VVcmwpIHtcbiAgICAgICAgICBzZXRTZXNzaW9uUmVmZXJlbmNlSW1hZ2UodXJsKTtcbiAgICAgICAgfVxuICAgICAgICB1cGRhdGVCb29rU3RhdGUocGFnZUluZGV4LCB1cmwpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiUmVnZW5lcmF0aW9uIGZhaWxlZFwiLCBlcnJvcik7XG4gICAgICBhbGVydChcItep15LXmdeQ15Qg15HXmdem15nXqNeqINeU16rXnteV16DXlCDXnteX15PXqVwiKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0TG9hZGluZ0ltYWdlcygocHJldikgPT4gKHsgLi4ucHJldiwgW3BhZ2VJbmRleF06IGZhbHNlIH0pKTtcbiAgICB9XG4gIH07XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBwYWdlID0gYm9vay5wYWdlc1tjdXJyZW50UGFnZUluZGV4XTtcbiAgICBpZiAocGFnZSAmJiAhaW1hZ2VzW2N1cnJlbnRQYWdlSW5kZXhdKSB7XG4gICAgICBsb2FkSW1hZ2UoY3VycmVudFBhZ2VJbmRleCwgcGFnZS5pbWFnZVByb21wdCk7XG4gICAgfVxuICB9LCBbY3VycmVudFBhZ2VJbmRleF0pO1xuXG4gIGNvbnN0IHByZXBhcmVFeHBvcnRDYW52YXMgPSBhc3luYyAoaTogbnVtYmVyLCBpbWdVcmw6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGlzQ292ZXIgPSBpID09PSAwO1xuXG4gICAgLy8gRVhQT1JUIExBWU9VVCBTVFJBVEVHWTpcbiAgICAvLyBDb3ZlcjogMTAyNHgxMDI0IFNxdWFyZSAoSW1hZ2UgY29udGFpbnMgdGl0bGUsIG5vIGV4dHJhIHRleHQgYXJlYSlcbiAgICAvLyBJbm5lcjogMTAyNHgxMjgwICgxMDI0eDEwMjQgSW1hZ2UgVG9wICsgMTAyNHgyNTYgVGV4dCBBcmVhIEJvdHRvbSlcblxuICAgIGNvbnN0IHdpZHRoID0gMTAyNDtcbiAgICBjb25zdCBoZWlnaHQgPSBpc0NvdmVyID8gMTAyNCA6IDEyODA7XG5cbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7XG4gICAgY29udGFpbmVyLnN0eWxlLmhlaWdodCA9IGAke2hlaWdodH1weGA7XG4gICAgY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBjb250YWluZXIuc3R5bGUubGVmdCA9ICctOTk5OXB4JztcbiAgICBjb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyNmZmZmZmYnO1xuICAgIGNvbnRhaW5lci5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuXG4gICAgaWYgKGlzQ292ZXIpIHtcbiAgICAgIC8vIENvdmVyIGlzIHNpbXBsZSBmdWxsIGltYWdlXG4gICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxpbWcgc3JjPVwiJHtpbWdVcmx9XCIgc3R5bGU9XCJ3aWR0aDogMTAyNHB4OyBoZWlnaHQ6IDEwMjRweDsgb2JqZWN0LWZpdDogY292ZXI7XCIgLz5gO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJbm5lciBwYWdlczogVmVydGljYWwgU3RhY2suIEltYWdlIFRvcCwgVGV4dCBCb3R0b20uXG4gICAgICBjb25zdCB0ZXh0ID0gYm9vay5wYWdlc1tpXS5oZWJyZXdUZXh0IHx8IFwiXCI7XG4gICAgICAvLyBJbXByb3ZlZCB0ZXh0IHN0eWxpbmcgbWF0Y2hpbmcgZ2xvYmFscy5jc3MgdXBkYXRlc1xuICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyB3aWR0aDogMTAyNHB4OyBoZWlnaHQ6IDEyODBweDsgYmFja2dyb3VuZDogd2hpdGU7XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cIndpZHRoOiAxMDI0cHg7IGhlaWdodDogMTAwMHB4OyBmbGV4LXNocmluazogMDsgYmFja2dyb3VuZC1jb2xvcjogI2Y4ZmFmYztcIj5cbiAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9XCIke2ltZ1VybH1cIiBzdHlsZT1cIndpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7IG9iamVjdC1maXQ6IGNvdmVyOyBkaXNwbGF5OiBibG9jaztcIiAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMjRweDsgXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogMjgwcHg7IFxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4OyBcbiAgICAgICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsgXG4gICAgICAgICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOyBcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMzJweCA0OHB4OyBcbiAgICAgICAgICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsgXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICNmZmZkZjUgMCUsICNmZmY4ZTcgMzAlLCAjZmRlY2M4IDcwJSwgI2ZiZTNiMiAxMDAlKTtcbiAgICAgICAgICAgICAgICAgICAgYm94LXNoYWRvdzogaW5zZXQgMCAycHggMCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCksIGluc2V0IDAgLTJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjA1KTtcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXRvcDogM3B4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KTtcbiAgICAgICAgICAgICAgICBcIj5cbiAgICAgICAgICAgICAgICAgICAgIDxwIHN0eWxlPVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW46IDA7IFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdSdWJpaycsICdIZWVibycsICdBcmlhbCcsIHNhbnMtc2VyaWY7IFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiA0NHB4OyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7IFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICMyYTFhMGE7IFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBydGw7IFxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0LXNoYWRvdzogMCAxcHggMCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCksIDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMDYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0dGVyLXNwYWNpbmc6IDAuMDFlbTtcbiAgICAgICAgICAgICAgICAgICAgIFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgJHt0ZXh0fVxuICAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgICBjb25zdCBjYW52YXMgPSBhd2FpdCBodG1sMmNhbnZhcyhjb250YWluZXIsIHsgc2NhbGU6IDEsIHVzZUNPUlM6IHRydWUsIHdpZHRoLCBoZWlnaHQgfSk7XG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChjb250YWluZXIpO1xuICAgIHJldHVybiBjYW52YXM7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlRG93bmxvYWRaSVAgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKGlzRXhwb3J0aW5nKSByZXR1cm47XG4gICAgc2V0SXNFeHBvcnRpbmcodHJ1ZSk7XG4gICAgc2V0RXhwb3J0UHJvZ3Jlc3MoJ9ee15vXmdefINeX15HXmdec15Qg157XnNeQ15QuLi4nKTtcbiAgICBjb25zdCB6aXAgPSBuZXcgSlNaaXAoKTtcbiAgICAvLyBBNCBQb3J0cmFpdCBmb3Igc3RhbmRhcmRpemVkIHByaW50aW5nXG4gICAgY29uc3QgcGRmID0gbmV3IGpzUERGKCdwJywgJ21tJywgJ2E0Jyk7XG4gICAgY29uc3QgcGFnZVdpZHRoID0gMjEwO1xuXG4gICAgdHJ5IHtcbiAgICAgIHppcC5maWxlKFwic2VxdWVsX2RhdGEuanNvblwiLCBKU09OLnN0cmluZ2lmeShib29rUmVmLmN1cnJlbnQsIG51bGwsIDIpKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib29rLnBhZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHNldEV4cG9ydFByb2dyZXNzKGDXntei15HXkyDXotee15XXkyAke2kgKyAxfSDXnteq15XXmiAke2Jvb2sucGFnZXMubGVuZ3RofS4uLmApO1xuICAgICAgICBsZXQgaW1nVXJsID0gaW1hZ2VzW2ldO1xuICAgICAgICBjb25zdCBpc0NvdmVyID0gaSA9PT0gMDtcblxuICAgICAgICBpZiAoIWltZ1VybCkge1xuICAgICAgICAgIGNvbnN0IHJlZmVyZW5jZVRvVXNlID0gYm9va1JlZi5jdXJyZW50Lm1ldGFkYXRhLmJhc2VDaGFyYWN0ZXJJbWFnZVVybCB8fCBzZXNzaW9uUmVmZXJlbmNlSW1hZ2U7XG4gICAgICAgICAgY29uc3QgdGV4dFRvUmVuZGVyID0gaXNDb3ZlciA/IChib29rUmVmLmN1cnJlbnQubWV0YWRhdGEudGl0bGUgfHwgJycpIDogdW5kZWZpbmVkO1xuICAgICAgICAgIGltZ1VybCA9IGF3YWl0IGdlbmVyYXRlUGFnZUltYWdlKFxuICAgICAgICAgICAgYm9vay5wYWdlc1tpXS5pbWFnZVByb21wdCxcbiAgICAgICAgICAgIGZ1bGxDaGFyYWN0ZXJEZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGJvb2subWV0YWRhdGEuYXJ0U3R5bGUsXG4gICAgICAgICAgICAocmVmZXJlbmNlVG9Vc2UgfHwgdW5kZWZpbmVkKSBhcyBzdHJpbmcgfCB1bmRlZmluZWQsXG4gICAgICAgICAgICBpc0NvdmVyLFxuICAgICAgICAgICAgdGV4dFRvUmVuZGVyXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoaW1nVXJsKSB7XG4gICAgICAgICAgICBzZXRJbWFnZXMocHJldiA9PiAoeyAuLi5wcmV2LCBbaV06IGltZ1VybCB9KSk7XG4gICAgICAgICAgICBpZiAoIXJlZmVyZW5jZVRvVXNlICYmICFzZXNzaW9uUmVmZXJlbmNlSW1hZ2UpIHNldFNlc3Npb25SZWZlcmVuY2VJbWFnZShpbWdVcmwpO1xuICAgICAgICAgICAgdXBkYXRlQm9va1N0YXRlKGksIGltZ1VybCk7IC8vIFN5bmMhXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGltZ1VybCkge1xuICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IGF3YWl0IHByZXBhcmVFeHBvcnRDYW52YXMoaSwgaW1nVXJsKTtcbiAgICAgICAgICBjb25zdCBwbmdCbG9iID0gYXdhaXQgbmV3IFByb21pc2U8QmxvYiB8IG51bGw+KHJlc29sdmUgPT4gY2FudmFzLnRvQmxvYihyZXNvbHZlLCAnaW1hZ2UvcG5nJykpO1xuXG4gICAgICAgICAgaWYgKHBuZ0Jsb2IpIHppcC5maWxlKGkgPT09IDAgPyAnMDBfQ09WRVIucG5nJyA6IGBQQUdFXyR7U3RyaW5nKGkpLnBhZFN0YXJ0KDIsICcwJyl9LnBuZ2AsIHBuZ0Jsb2IpO1xuXG4gICAgICAgICAgY29uc3QgaW1nRGF0YSA9IGNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL2pwZWcnLCAwLjkpO1xuXG4gICAgICAgICAgLy8gUERGIExheW91dFxuICAgICAgICAgIGNvbnN0IGNhbnZhc1JhdGlvID0gY2FudmFzLmhlaWdodCAvIGNhbnZhcy53aWR0aDtcbiAgICAgICAgICBjb25zdCBwZGZJbWdIZWlnaHQgPSBwYWdlV2lkdGggKiBjYW52YXNSYXRpbztcblxuICAgICAgICAgIC8vIElmIGhlaWdodCBleGNlZWRzIEE0ICgyOTdtbSksIHNjYWxlIGRvd24gdG8gZml0XG4gICAgICAgICAgbGV0IHJlbmRlcldpZHRoID0gcGFnZVdpZHRoO1xuICAgICAgICAgIGxldCByZW5kZXJIZWlnaHQgPSBwZGZJbWdIZWlnaHQ7XG4gICAgICAgICAgaWYgKHJlbmRlckhlaWdodCA+IDI5Nykge1xuICAgICAgICAgICAgY29uc3Qgc2NhbGUgPSAyOTcgLyByZW5kZXJIZWlnaHQ7XG4gICAgICAgICAgICByZW5kZXJIZWlnaHQgPSAyOTc7XG4gICAgICAgICAgICByZW5kZXJXaWR0aCA9IHBhZ2VXaWR0aCAqIHNjYWxlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB4T2Zmc2V0ID0gKDIxMCAtIHJlbmRlcldpZHRoKSAvIDI7XG5cbiAgICAgICAgICBwZGYuYWRkSW1hZ2UoaW1nRGF0YSwgJ0pQRUcnLCB4T2Zmc2V0LCAwLCByZW5kZXJXaWR0aCwgcmVuZGVySGVpZ2h0KTtcblxuICAgICAgICAgIGlmIChpIDwgYm9vay5wYWdlcy5sZW5ndGggLSAxKSBwZGYuYWRkUGFnZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGF1ZGlvRW5hYmxlZCkge1xuICAgICAgICAgIGxldCBhdWRpb0J1ZiA9IGF1ZGlvQnVmZmVyc1tpXTtcbiAgICAgICAgICBpZiAoIWF1ZGlvQnVmKSB7XG4gICAgICAgICAgICBpZiAoIWF1ZGlvQ29udGV4dFJlZi5jdXJyZW50KSBhdWRpb0NvbnRleHRSZWYuY3VycmVudCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCAod2luZG93IGFzIGFueSkud2Via2l0QXVkaW9Db250ZXh0KSh7IHNhbXBsZVJhdGU6IDI0MDAwIH0pO1xuICAgICAgICAgICAgY29uc3QgYnVmID0gYXdhaXQgZ2VuZXJhdGVQYWdlQXVkaW8oaSA9PT0gMCA/IGJvb2subWV0YWRhdGEudGl0bGUgOiBib29rLnBhZ2VzW2ldLmhlYnJld1RleHQsIGF1ZGlvQ29udGV4dFJlZi5jdXJyZW50LCB2b2ljZU5hbWUpO1xuICAgICAgICAgICAgaWYgKGJ1ZikgeyBhdWRpb0J1ZiA9IGJ1Zjsgc2V0QXVkaW9CdWZmZXJzKHByZXYgPT4gKHsgLi4ucHJldiwgW2ldOiBidWYgfSkpOyB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhdWRpb0J1ZikgemlwLmZpbGUoaSA9PT0gMCA/ICcwMF9BVURJT19UaXRsZS53YXYnIDogYEFVRElPX1BhZ2VfJHtTdHJpbmcoaSkucGFkU3RhcnQoMiwgJzAnKX0ud2F2YCwgYXVkaW9CdWZmZXJUb1dhdihhdWRpb0J1ZikpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBkZkJsb2IgPSBwZGYub3V0cHV0KCdibG9iJyk7XG4gICAgICB6aXAuZmlsZShgJHtib29rLm1ldGFkYXRhLnRpdGxlfS5wZGZgLCBwZGZCbG9iKTtcblxuICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHppcC5nZW5lcmF0ZUFzeW5jKHsgdHlwZTogJ2Jsb2InIH0pO1xuXG4gICAgICAvLyBVcGxvYWQgdG8gR29vZ2xlIERyaXZlIGlmIGNvbm5lY3RlZFxuICAgICAgbGV0IGRyaXZlTGlua3M6IHsgemlwTGluazogc3RyaW5nOyBwZGZMaW5rOiBzdHJpbmcgfSB8IG51bGwgPSBudWxsO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBoYXNEcml2ZUFjY2VzcywgdXBsb2FkQm9va1RvRHJpdmUgfSA9IGF3YWl0IGltcG9ydCgnQC9zZXJ2aWNlcy9nb29nbGVEcml2ZScpO1xuICAgICAgICBpZiAoaGFzRHJpdmVBY2Nlc3MoKSkge1xuICAgICAgICAgIHNldEV4cG9ydFByb2dyZXNzKCfXntei15zXlCDXnC1Hb29nbGUgRHJpdmUuLi4nKTtcbiAgICAgICAgICBkcml2ZUxpbmtzID0gYXdhaXQgdXBsb2FkQm9va1RvRHJpdmUoY29udGVudCwgcGRmQmxvYiwgYm9vay5tZXRhZGF0YS50aXRsZSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGRyaXZlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdEcml2ZSB1cGxvYWQgZmFpbGVkOicsIGRyaXZlRXJyb3IpO1xuICAgICAgfVxuXG4gICAgICAvLyBTYXZlIHRvIEZpcmVzdG9yZSBXSVRIIERyaXZlIGxpbmtzXG4gICAgICBzZXRFeHBvcnRQcm9ncmVzcygn16nXldee16gg157XmdeT16IuLi4nKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgc2F2ZUJvb2tQcm9tcHRzIH0gPSBhd2FpdCBpbXBvcnQoJ0Avc2VydmljZXMvZmlyZWJhc2UnKTtcbiAgICAgICAgYXdhaXQgc2F2ZUJvb2tQcm9tcHRzKHtcbiAgICAgICAgICBib29rVGl0bGU6IGJvb2subWV0YWRhdGEudGl0bGUsXG4gICAgICAgICAgbWFpbkNoYXJhY3RlcjogYm9vay5tZXRhZGF0YS5tYWluQ2hhcmFjdGVyRGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgICAgYXJ0U3R5bGU6IGJvb2subWV0YWRhdGEuYXJ0U3R5bGUsXG4gICAgICAgICAgdG9waWM6IGJvb2subWV0YWRhdGEubWFpblRoZW1lIHx8ICcnLFxuICAgICAgICAgIGltYWdlUHJvbXB0czogYm9vay5wYWdlcy5tYXAocCA9PiBwLmltYWdlUHJvbXB0KSxcbiAgICAgICAgICBkcml2ZVppcFVybDogZHJpdmVMaW5rcz8uemlwTGluayxcbiAgICAgICAgICBkcml2ZVBkZlVybDogZHJpdmVMaW5rcz8ucGRmTGlua1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2coJ0Jvb2sgc2F2ZWQgdG8gRmlyZXN0b3JlIHdpdGggRHJpdmUgbGlua3MhJyk7XG4gICAgICB9IGNhdGNoIChmaXJlYmFzZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignRmlyZXN0b3JlIHNhdmUgZmFpbGVkOicsIGZpcmViYXNlRXJyb3IpO1xuICAgICAgfVxuXG4gICAgICAvLyBEb3dubG9hZCBsb2NhbGx5XG4gICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgbGluay5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChjb250ZW50KTtcbiAgICAgIGNvbnN0IHNhZmVUaXRsZSA9IGJvb2subWV0YWRhdGEudGl0bGUucmVwbGFjZSgvW1xcXFwvOio/XCI8PnxdL2csICdfJyk7XG4gICAgICBsaW5rLmRvd25sb2FkID0gYCR7c2FmZVRpdGxlfS56aXBgO1xuICAgICAgbGluay5jbGljaygpO1xuXG4gICAgICAvLyBTaG93IERyaXZlIGxpbmtzIGlmIHVwbG9hZGVkXG4gICAgICBpZiAoZHJpdmVMaW5rcykge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBjb25zdCBzaG93TGlua3MgPSBjb25maXJtKGDXlNeh16TXqCDXlNeV16LXnNeUINecLUdvb2dsZSBEcml2ZSFcXG5cXG7XnNeU16bXmdeSINen15nXqdeV16jXmdedP2ApO1xuICAgICAgICAgIGlmIChzaG93TGlua3MpIHtcbiAgICAgICAgICAgIGFsZXJ0KGDwn5OmIFpJUDogJHtkcml2ZUxpbmtzLnppcExpbmt9XFxuXFxu8J+ThCBQREY6ICR7ZHJpdmVMaW5rcy5wZGZMaW5rfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgNTAwKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkV4cG9ydCBmYWlsZWQ6XCIsIGVycm9yKTtcbiAgICAgIGFsZXJ0KFwi15TXmdeZ16bXldeQINeg15vXqdecLiDXkNeg15Ag16DXodeUINep15XXkS5cIik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzRXhwb3J0aW5nKGZhbHNlKTtcbiAgICAgIHNldEV4cG9ydFByb2dyZXNzKCcnKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlRG93bmxvYWRQREYgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKGlzRXhwb3J0aW5nKSByZXR1cm47XG4gICAgc2V0SXNFeHBvcnRpbmcodHJ1ZSk7XG4gICAgc2V0RXhwb3J0UHJvZ3Jlc3MoJ9eZ15XXpteoIFBERi4uLicpO1xuICAgIGNvbnN0IHBkZiA9IG5ldyBqc1BERigncCcsICdtbScsICdhNCcpO1xuICAgIGNvbnN0IHBhZ2VXaWR0aCA9IDIxMDtcblxuICAgIHRyeSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvb2sucGFnZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc2V0RXhwb3J0UHJvZ3Jlc3MoYNee15XXodeZ16Mg16LXnteV15MgJHtpICsgMX0uLi5gKTtcbiAgICAgICAgbGV0IGltZ1VybCA9IGltYWdlc1tpXTtcbiAgICAgICAgY29uc3QgaXNDb3ZlciA9IGkgPT09IDA7XG5cbiAgICAgICAgaWYgKCFpbWdVcmwpIHtcbiAgICAgICAgICBjb25zdCByZWYgPSBib29rUmVmLmN1cnJlbnQubWV0YWRhdGEuYmFzZUNoYXJhY3RlckltYWdlVXJsIHx8IHNlc3Npb25SZWZlcmVuY2VJbWFnZTtcbiAgICAgICAgICBjb25zdCB0ZXh0VG9SZW5kZXIgPSBpc0NvdmVyID8gKGJvb2tSZWYuY3VycmVudC5tZXRhZGF0YS50aXRsZSB8fCAnJykgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgaW1nVXJsID0gYXdhaXQgZ2VuZXJhdGVQYWdlSW1hZ2UoXG4gICAgICAgICAgICBib29rLnBhZ2VzW2ldLmltYWdlUHJvbXB0LFxuICAgICAgICAgICAgZnVsbENoYXJhY3RlckRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgYm9vay5tZXRhZGF0YS5hcnRTdHlsZSxcbiAgICAgICAgICAgIChyZWYgfHwgdW5kZWZpbmVkKSBhcyBzdHJpbmcgfCB1bmRlZmluZWQsXG4gICAgICAgICAgICBpc0NvdmVyLFxuICAgICAgICAgICAgdGV4dFRvUmVuZGVyXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoaW1nVXJsKSB7IHNldEltYWdlcyhwcmV2ID0+ICh7IC4uLnByZXYsIFtpXTogaW1nVXJsIH0pKTsgdXBkYXRlQm9va1N0YXRlKGksIGltZ1VybCk7IH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW1nVXJsKSB7XG4gICAgICAgICAgY29uc3QgY2FudmFzID0gYXdhaXQgcHJlcGFyZUV4cG9ydENhbnZhcyhpLCBpbWdVcmwpO1xuICAgICAgICAgIGNvbnN0IGltZ0RhdGEgPSBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9qcGVnJywgMC45KTtcblxuICAgICAgICAgIGNvbnN0IGNhbnZhc1JhdGlvID0gY2FudmFzLmhlaWdodCAvIGNhbnZhcy53aWR0aDtcbiAgICAgICAgICBjb25zdCBwZGZJbWdIZWlnaHQgPSBwYWdlV2lkdGggKiBjYW52YXNSYXRpbztcblxuICAgICAgICAgIGxldCByZW5kZXJXaWR0aCA9IHBhZ2VXaWR0aDtcbiAgICAgICAgICBsZXQgcmVuZGVySGVpZ2h0ID0gcGRmSW1nSGVpZ2h0O1xuICAgICAgICAgIGlmIChyZW5kZXJIZWlnaHQgPiAyOTcpIHtcbiAgICAgICAgICAgIGNvbnN0IHNjYWxlID0gMjk3IC8gcmVuZGVySGVpZ2h0O1xuICAgICAgICAgICAgcmVuZGVySGVpZ2h0ID0gMjk3O1xuICAgICAgICAgICAgcmVuZGVyV2lkdGggPSBwYWdlV2lkdGggKiBzY2FsZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgeE9mZnNldCA9ICgyMTAgLSByZW5kZXJXaWR0aCkgLyAyO1xuXG4gICAgICAgICAgcGRmLmFkZEltYWdlKGltZ0RhdGEsICdKUEVHJywgeE9mZnNldCwgMCwgcmVuZGVyV2lkdGgsIHJlbmRlckhlaWdodCk7XG4gICAgICAgICAgaWYgKGkgPCBib29rLnBhZ2VzLmxlbmd0aCAtIDEpIHBkZi5hZGRQYWdlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgcGRmQmxvYiA9IHBkZi5vdXRwdXQoJ2Jsb2InKTtcblxuICAgICAgLy8gVXBsb2FkIHRvIEdvb2dsZSBEcml2ZSBpZiBjb25uZWN0ZWRcbiAgICAgIGxldCBkcml2ZUxpbmtzOiB7IHppcExpbms6IHN0cmluZzsgcGRmTGluazogc3RyaW5nIH0gfCBudWxsID0gbnVsbDtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgaGFzRHJpdmVBY2Nlc3MsIHVwbG9hZEJvb2tUb0RyaXZlIH0gPSBhd2FpdCBpbXBvcnQoJ0Avc2VydmljZXMvZ29vZ2xlRHJpdmUnKTtcbiAgICAgICAgaWYgKGhhc0RyaXZlQWNjZXNzKCkpIHtcbiAgICAgICAgICBzZXRFeHBvcnRQcm9ncmVzcygn157Xotec15Qg15wtR29vZ2xlIERyaXZlLi4uJyk7XG4gICAgICAgICAgLy8gRm9yIFBERiBvbmx5IGV4cG9ydCwgd2UganVzdCB1cGxvYWQgdGhlIFBERiAobW9jayBlbXB0eSBaSVApXG4gICAgICAgICAgLy8gT3IgYmV0dGVyLCB3ZSBjYW4gdXNlIGEgc2ltcGxlciB1cGxvYWRUb0RyaXZlIGZ1bmN0aW9uLCBidXQgdXBsb2FkQm9va1RvRHJpdmUgaXMgaGFuZHkuXG4gICAgICAgICAgLy8gTGV0J3MganVzdCB1cGxvYWQgdGhlIFBERiB1c2luZyB0aGUgZ2VuZXJpYyB1cGxvYWQgZnVuY3Rpb24gZXhwb3NlZCBvciB2aWEgdXBsb2FkQm9va1RvRHJpdmUgcGFzc2luZyBlbXB0eSBibG9iIGZvciB6aXA/XG4gICAgICAgICAgLy8gQWN0dWFsbHkgdXBsb2FkQm9va1RvRHJpdmUgZXhwZWN0cyBib3RoLiBMZXQncyBpbXBvcnQgdXBsb2FkVG9Ecml2ZSBkaXJlY3RseS5cbiAgICAgICAgICBjb25zdCB7IHVwbG9hZFRvRHJpdmUgfSA9IGF3YWl0IGltcG9ydCgnQC9zZXJ2aWNlcy9nb29nbGVEcml2ZScpO1xuICAgICAgICAgIGNvbnN0IHNhZmVUaXRsZSA9IGJvb2subWV0YWRhdGEudGl0bGUucmVwbGFjZSgvW1xcXFwvOio/XCI8PnxdL2csICdfJyk7XG4gICAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdXBsb2FkVG9Ecml2ZShwZGZCbG9iLCBgJHtzYWZlVGl0bGV9XyR7dGltZXN0YW1wfS5wZGZgLCAnYXBwbGljYXRpb24vcGRmJyk7XG4gICAgICAgICAgZHJpdmVMaW5rcyA9IHsgemlwTGluazogJycsIHBkZkxpbms6IHJlc3VsdC53ZWJWaWV3TGluayB9O1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChkcml2ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignRHJpdmUgdXBsb2FkIGZhaWxlZDonLCBkcml2ZUVycm9yKTtcbiAgICAgIH1cblxuICAgICAgLy8gTG9nIGJvb2sgbWV0YWRhdGEgdG8gRmlyZXN0b3JlIFdJVEggRHJpdmUgbGlua1xuICAgICAgc2V0RXhwb3J0UHJvZ3Jlc3MoJ9ep15XXnteoINee15nXk9eiLi4uJyk7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IHNhdmVCb29rUHJvbXB0cyB9ID0gYXdhaXQgaW1wb3J0KCdAL3NlcnZpY2VzL2ZpcmViYXNlJyk7XG4gICAgICAgIGF3YWl0IHNhdmVCb29rUHJvbXB0cyh7XG4gICAgICAgICAgYm9va1RpdGxlOiBib29rLm1ldGFkYXRhLnRpdGxlLFxuICAgICAgICAgIG1haW5DaGFyYWN0ZXI6IGJvb2subWV0YWRhdGEubWFpbkNoYXJhY3RlckRlc2NyaXB0aW9uIHx8ICcnLFxuICAgICAgICAgIGFydFN0eWxlOiBib29rLm1ldGFkYXRhLmFydFN0eWxlLFxuICAgICAgICAgIHRvcGljOiBib29rLm1ldGFkYXRhLm1haW5UaGVtZSB8fCAnJyxcbiAgICAgICAgICBpbWFnZVByb21wdHM6IGJvb2sucGFnZXMubWFwKHAgPT4gcC5pbWFnZVByb21wdCksXG4gICAgICAgICAgZHJpdmVQZGZVcmw6IGRyaXZlTGlua3M/LnBkZkxpbmtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdCb29rIG1ldGFkYXRhIHNhdmVkIHRvIEZpcmVzdG9yZSEnKTtcbiAgICAgIH0gY2F0Y2ggKGZpcmViYXNlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdGaXJlc3RvcmUgc2F2ZSBmYWlsZWQ6JywgZmlyZWJhc2VFcnJvcik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNhZmVUaXRsZSA9IGJvb2subWV0YWRhdGEudGl0bGUucmVwbGFjZSgvW1xcXFwvOio/XCI8PnxdL2csICdfJyk7XG4gICAgICBwZGYuc2F2ZShgJHtzYWZlVGl0bGV9LnBkZmApO1xuXG4gICAgICAvLyBTaG93IERyaXZlIGxpbmtzIGlmIHVwbG9hZGVkXG4gICAgICBpZiAoZHJpdmVMaW5rcz8ucGRmTGluaykge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBjb25zdCBzaG93TGlua3MgPSBjb25maXJtKGDXlC1QREYg15TXldei15zXlCDXnC1Hb29nbGUgRHJpdmUhXFxuXFxu15zXlNem15nXkiDXp9eZ16nXldeoP2ApO1xuICAgICAgICAgIGlmIChzaG93TGlua3MpIHtcbiAgICAgICAgICAgIGFsZXJ0KGDwn5OEIFBERjogJHtkcml2ZUxpbmtzLnBkZkxpbmt9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCA1MDApO1xuICAgICAgfVxuICAgIH0gZmluYWxseSB7IHNldElzRXhwb3J0aW5nKGZhbHNlKTsgc2V0RXhwb3J0UHJvZ3Jlc3MoJycpOyB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImZpeGVkIGluc2V0LTAgYmctc2xhdGUtOTAwIHotWzEwMF0gZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXJcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy1mdWxsIGJnLXdoaXRlIHB4LTQgaC0yMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gc2hhZG93LW1kIHNocmluay0wIHotNTBcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtNFwiPlxuICAgICAgICAgIDxidXR0b24gb25DbGljaz17b25DbG9zZX0gY2xhc3NOYW1lPVwidGV4dC1zbGF0ZS02MDAgaG92ZXI6dGV4dC1zbGF0ZS05MDAgZm9udC1ib2xkIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXhsXCI+4oaQPC9zcGFuPiDXl9eW16jXlCDXnNei16jXmdeb15RcbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2hhbmRsZUNoYW5nZUtleX0gY2xhc3NOYW1lPVwidGV4dC1zbGF0ZS00MDAgaG92ZXI6dGV4dC1zbGF0ZS02MDAgdGV4dC14cyBmb250LWJvbGQgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgcHgtMiBweS0xIHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMVwiPlxuICAgICAgICAgICAg8J+UkSBBUElcbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTNcIj5cbiAgICAgICAgICA8RHJpdmVDb25uZWN0QnV0dG9uIC8+XG4gICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXtoYW5kbGVEb3dubG9hZFpJUH0gZGlzYWJsZWQ9e2lzRXhwb3J0aW5nfSBjbGFzc05hbWU9XCJiZy1raWQtb3JhbmdlIGhvdmVyOmJnLW9yYW5nZS00MDAgdGV4dC13aGl0ZSBmb250LWJvbGQgcHktMiBweC00IHJvdW5kZWQtZnVsbCB0ZXh0LXNtIHRyYW5zaXRpb24tYWxsIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICA8c3Bhbj7Xl9eR15nXnNeUINee15zXkNeUPC9zcGFuPiDwn5OmXG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXtoYW5kbGVEb3dubG9hZFBERn0gZGlzYWJsZWQ9e2lzRXhwb3J0aW5nfSBjbGFzc05hbWU9XCJiZy1raWQtYmx1ZSBob3ZlcjpiZy10ZWFsLTQwMCB0ZXh0LXdoaXRlIGZvbnQtYm9sZCBweS0yIHB4LTQgcm91bmRlZC1mdWxsIHRleHQtc20gdHJhbnNpdGlvbi1hbGxcIj5cbiAgICAgICAgICAgIFBERiDXkdec15HXkyDwn5OEXG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC1ncm93IHctZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBwLTQgb3ZlcmZsb3ctYXV0byBiZy1zbGF0ZS04MDBcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZSB3LWZ1bGwgbWF4LXctWzU1MHB4XSBiZy13aGl0ZSByb3VuZGVkLTJ4bCBzaGFkb3ctMnhsIG92ZXJmbG93LWhpZGRlbiBncm91cCBib3JkZXItNCBib3JkZXItd2hpdGUgZmxleCBmbGV4LWNvbFwiPlxuICAgICAgICAgIHtpbWFnZXNbY3VycmVudFBhZ2VJbmRleF0gPyAoXG4gICAgICAgICAgICA8PlxuICAgICAgICAgICAgICB7LyogSU1BR0UgQVJFQTogXG4gICAgICAgICAgICAgICAgIC0gQ292ZXI6IEZ1bGwgY29udGFpbmVyLlxuICAgICAgICAgICAgICAgICAtIElubmVyOiBTdHJpY3RseSBzcXVhcmUsIHRvcCBwYXJ0IG9mIGZsZXggY29sdW1uLlxuICAgICAgICAgICAgICAqL31cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2ByZWxhdGl2ZSB3LWZ1bGwgJHtjdXJyZW50UGFnZUluZGV4ID09PSAwID8gJ2gtZnVsbCBhc3BlY3Qtc3F1YXJlJyA6ICdhc3BlY3Qtc3F1YXJlIHNocmluay0wJ30gYmctc2xhdGUtMTAwYH0+XG4gICAgICAgICAgICAgICAgPGltZyBzcmM9e2ltYWdlc1tjdXJyZW50UGFnZUluZGV4XX0gY2xhc3NOYW1lPVwidy1mdWxsIGgtZnVsbCBvYmplY3QtY292ZXJcIiAvPlxuXG4gICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlUmVnZW5lcmF0ZUltYWdlfVxuICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2xvYWRpbmdJbWFnZXNbY3VycmVudFBhZ2VJbmRleF19XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJhYnNvbHV0ZSB0b3AtNCBsZWZ0LTQgei0zMCBiZy13aGl0ZS84MCBob3ZlcjpiZy13aGl0ZSB0ZXh0LXNsYXRlLTcwMCBwLTIgcm91bmRlZC1mdWxsIHNoYWRvdy1sZyBiYWNrZHJvcC1ibHVyLXNtIHRyYW5zaXRpb24tYWxsIGhvdmVyOnNjYWxlLTExMCBkaXNhYmxlZDpvcGFjaXR5LTUwXCJcbiAgICAgICAgICAgICAgICAgIHRpdGxlPVwi16bXmdeZ16gg157Xl9eT16kg15DXqiDXlNeq157Xldeg15RcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIHtsb2FkaW5nSW1hZ2VzW2N1cnJlbnRQYWdlSW5kZXhdID8gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctNiBoLTYgYm9yZGVyLTIgYm9yZGVyLXNsYXRlLTcwMCBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgYW5pbWF0ZS1zcGluXCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXhsXCI+8J+UhDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG5cbiAgICAgICAgICAgICAgICB7LyogQXVkaW8gQnV0dG9uIGZvciBDb3ZlciAoT3ZlcmxheSBTdHlsZSkgKi99XG4gICAgICAgICAgICAgICAge2N1cnJlbnRQYWdlSW5kZXggPT09IDAgJiYgYXVkaW9FbmFibGVkICYmIChcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWJzb2x1dGUgYm90dG9tLTYgcmlnaHQtNiBmbGV4IGZsZXgtY29sIGl0ZW1zLWVuZCBnYXAtMiB6LTIwXCI+XG4gICAgICAgICAgICAgICAgICAgIHthdWRpb0Vycm9yICYmIDxzcGFuIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1yZWQtNTAwIGJnLXdoaXRlIHB4LTIgcHktMSByb3VuZGVkLWZ1bGwgZm9udC1ib2xkIHNoYWRvdy1tZFwiPnthdWRpb0Vycm9yfTwvc3Bhbj59XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoZSkgPT4geyBlLnN0b3BQcm9wYWdhdGlvbigpOyBoYW5kbGVUb2dnbGVBdWRpbygpOyB9fVxuICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmdBdWRpb31cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdy0xNCBoLTE0IHJvdW5kZWQtZnVsbCBzaGFkb3ctbGcgYm9yZGVyLTQgYm9yZGVyLXdoaXRlIHRyYW5zaXRpb24tYWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7aXNQbGF5aW5nID8gJ2JnLXJlZC01MDAgdGV4dC13aGl0ZSBhbmltYXRlLXB1bHNlJyA6ICdiZy1raWQtYmx1ZSB0ZXh0LXdoaXRlIGhvdmVyOmJnLXRlYWwtNDAwIGhvdmVyOnNjYWxlLTExMCd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7YXVkaW9FcnJvciA/ICdiZy1zbGF0ZS00MDAgYm9yZGVyLXNsYXRlLTIwMCcgOiAnJ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAge2lzTG9hZGluZ0F1ZGlvID8gPGRpdiBjbGFzc05hbWU9XCJ3LTYgaC02IGJvcmRlci0zIGJvcmRlci13aGl0ZSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgYW5pbWF0ZS1zcGluXCI+PC9kaXY+IDogaXNQbGF5aW5nID8gPHNwYW4gY2xhc3NOYW1lPVwidGV4dC0zeGxcIj7ij7k8L3NwYW4+IDogPHNwYW4gY2xhc3NOYW1lPVwidGV4dC0zeGxcIj7wn5SKPC9zcGFuPn1cbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICB7LyogVEVYVCBBUkVBIChJbm5lciBQYWdlcyBPbmx5KTogVXNlIGN1c3RvbSBib29rLXRleHQtY29udGFpbmVyIGNsYXNzICovfVxuICAgICAgICAgICAgICB7Y3VycmVudFBhZ2VJbmRleCAhPT0gMCAmJiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgYm9vay10ZXh0LWNvbnRhaW5lciBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gZmxleC0xXCI+XG5cbiAgICAgICAgICAgICAgICAgIHthdWRpb0VuYWJsZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KGUpID0+IHsgZS5zdG9wUHJvcGFnYXRpb24oKTsgaGFuZGxlVG9nZ2xlQXVkaW8oKTsgfX1cbiAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNMb2FkaW5nQXVkaW99XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNocmluay0wIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHctMTIgaC0xMiByb3VuZGVkLWZ1bGwgc2hhZG93LXNtIHRyYW5zaXRpb24tYWxsIG1yLTZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtpc1BsYXlpbmcgPyAnYmctcmVkLTUwMCB0ZXh0LXdoaXRlIGFuaW1hdGUtcHVsc2UnIDogJ2JnLWtpZC1ibHVlIHRleHQtd2hpdGUgaG92ZXI6YmctdGVhbC00MDAnfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2lzTG9hZGluZ0F1ZGlvID8gJ29wYWNpdHktNzAgY3Vyc29yLXdhaXQnIDogJyd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7YXVkaW9FcnJvciA/ICdiZy1zbGF0ZS00MDAnIDogJyd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYH1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIHtpc0xvYWRpbmdBdWRpbyA/IDxkaXYgY2xhc3NOYW1lPVwidy01IGgtNSBib3JkZXItMiBib3JkZXItd2hpdGUgYm9yZGVyLXQtdHJhbnNwYXJlbnQgcm91bmRlZC1mdWxsIGFuaW1hdGUtc3BpblwiPjwvZGl2PiA6IGlzUGxheWluZyA/IDxzcGFuIGNsYXNzTmFtZT1cInRleHQtMnhsXCI+4o+5PC9zcGFuPiA6IDxzcGFuIGNsYXNzTmFtZT1cInRleHQtMnhsXCI+8J+Uijwvc3Bhbj59XG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgdGV4dC1jZW50ZXIgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiYm9vay10ZXh0XCI+XG4gICAgICAgICAgICAgICAgICAgICAge2N1cnJlbnRQYWdlLmhlYnJld1RleHR9XG4gICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC8+XG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy1mdWxsIGFzcGVjdC1zcXVhcmUgZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgYmctc2xhdGUtMTAwXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0xMiBoLTEyIGJvcmRlci00IGJvcmRlci1raWQtYmx1ZSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgYW5pbWF0ZS1zcGluIG1iLTRcIj48L2Rpdj5cbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZm9udC1ib2xkIHRleHQtc2xhdGUtNTAwXCI+157XpteZ15nXqCDXqNeS16Ig16fXodeV150uLi48L3A+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInctZnVsbCBiZy13aGl0ZS8xMCBiYWNrZHJvcC1ibHVyLW1kIHAtNiBmbGV4IGp1c3RpZnktY2VudGVyIGl0ZW1zLWNlbnRlciBnYXAtMTBcIj5cbiAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXtoYW5kbGVQcmV2fSBkaXNhYmxlZD17Y3VycmVudFBhZ2VJbmRleCA9PT0gMH0gY2xhc3NOYW1lPVwidy0xNCBoLTE0IGJnLXdoaXRlLzIwIGhvdmVyOmJnLXdoaXRlLzQwIHRleHQtd2hpdGUgcm91bmRlZC1mdWxsIHRleHQtMnhsIGRpc2FibGVkOm9wYWNpdHktMjAgdHJhbnNpdGlvbi1hbGxcIj7ihpA8L2J1dHRvbj5cbiAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC13aGl0ZSBmb250LWJvbGQgYmctYmxhY2svNDAgcHgtNiBweS0yIHJvdW5kZWQtZnVsbFwiPlxuICAgICAgICAgINei157XldeTIHtjdXJyZW50UGFnZUluZGV4ICsgMX0g157XqteV15oge3RvdGFsUGFnZXN9XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXtoYW5kbGVOZXh0fSBkaXNhYmxlZD17Y3VycmVudFBhZ2VJbmRleCA9PT0gdG90YWxQYWdlcyAtIDF9IGNsYXNzTmFtZT1cInctMTQgaC0xNCBiZy1raWQteWVsbG93IGhvdmVyOmJnLXllbGxvdy00MDAgdGV4dC1zbGF0ZS05MDAgcm91bmRlZC1mdWxsIHRleHQtMnhsIGRpc2FibGVkOm9wYWNpdHktMjAgdHJhbnNpdGlvbi1hbGxcIj7ihpI8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7aXNFeHBvcnRpbmcgJiYgKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZpeGVkIGluc2V0LTAgei1bNDAwXSBiZy1zbGF0ZS05MDAvOTAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC13aGl0ZVwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0xNiBoLTE2IGJvcmRlci00IGJvcmRlci1raWQtYmx1ZSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgYW5pbWF0ZS1zcGluIG14LWF1dG8gbWItNlwiPjwvZGl2PlxuICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT1cInRleHQtMnhsIGZvbnQtYm9sZCBmb250LWZyZWRva2FcIj57ZXhwb3J0UHJvZ3Jlc3N9PC9oMz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuICAgIDwvZGl2PlxuICApO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgQm9va1ZpZXdlcjtcbiJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlTWVtbyIsInVzZVJlZiIsImdlbmVyYXRlUGFnZUltYWdlIiwiZ2VuZXJhdGVQYWdlQXVkaW8iLCJEcml2ZUNvbm5lY3RCdXR0b24iLCJodG1sMmNhbnZhcyIsImpzUERGIiwiSlNaaXAiLCJhdWRpb0J1ZmZlclRvV2F2IiwiYnVmZmVyIiwibnVtQ2hhbm5lbHMiLCJudW1iZXJPZkNoYW5uZWxzIiwic2FtcGxlUmF0ZSIsImZvcm1hdCIsImJpdERlcHRoIiwiYnl0ZXNQZXJTYW1wbGUiLCJibG9ja0FsaWduIiwiZGF0YUJ5dGVDb3VudCIsImxlbmd0aCIsImhlYWRlckJ5dGVDb3VudCIsInRvdGFsQnl0ZUNvdW50IiwiaGVhZGVyQnVmZmVyIiwiQXJyYXlCdWZmZXIiLCJ2aWV3IiwiRGF0YVZpZXciLCJ3cml0ZVN0cmluZyIsIm9mZnNldCIsInN0cmluZyIsImkiLCJzZXRVaW50OCIsImNoYXJDb2RlQXQiLCJzZXRVaW50MzIiLCJzZXRVaW50MTYiLCJkYXRhQnVmZmVyIiwiZGF0YVZpZXciLCJjaGFubmVsIiwic2FtcGxlIiwiZ2V0Q2hhbm5lbERhdGEiLCJzIiwiTWF0aCIsIm1heCIsIm1pbiIsImludDE2Iiwic2V0SW50MTYiLCJCbG9iIiwidHlwZSIsIkJvb2tWaWV3ZXIiLCJib29rIiwib25VcGRhdGVCb29rIiwib25DbG9zZSIsImN1cnJlbnRQYWdlSW5kZXgiLCJzZXRDdXJyZW50UGFnZUluZGV4IiwiYm9va1JlZiIsImN1cnJlbnQiLCJpbWFnZXMiLCJzZXRJbWFnZXMiLCJpbml0aWFsSW1hZ2VzIiwicGFnZXMiLCJmb3JFYWNoIiwicGFnZSIsImluZGV4IiwiZ2VuZXJhdGVkSW1hZ2VVcmwiLCJsb2FkaW5nSW1hZ2VzIiwic2V0TG9hZGluZ0ltYWdlcyIsInNlc3Npb25SZWZlcmVuY2VJbWFnZSIsInNldFNlc3Npb25SZWZlcmVuY2VJbWFnZSIsIm1ldGFkYXRhIiwiYmFzZUNoYXJhY3RlckltYWdlVXJsIiwiZmluZCIsInAiLCJpc0V4cG9ydGluZyIsInNldElzRXhwb3J0aW5nIiwiZXhwb3J0UHJvZ3Jlc3MiLCJzZXRFeHBvcnRQcm9ncmVzcyIsImlzUGxheWluZyIsInNldElzUGxheWluZyIsImlzTG9hZGluZ0F1ZGlvIiwic2V0SXNMb2FkaW5nQXVkaW8iLCJhdWRpb0Vycm9yIiwic2V0QXVkaW9FcnJvciIsImF1ZGlvQnVmZmVycyIsInNldEF1ZGlvQnVmZmVycyIsImF1ZGlvQ29udGV4dFJlZiIsImF1ZGlvU291cmNlUmVmIiwiY3VycmVudFBhZ2UiLCJ0b3RhbFBhZ2VzIiwiYXVkaW9FbmFibGVkIiwiYXVkaW9Db25maWciLCJlbmFibGVkIiwidm9pY2VOYW1lIiwiZnVsbENoYXJhY3RlckRlc2NyaXB0aW9uIiwiZGVzYyIsIm1haW5DaGFyYWN0ZXJEZXNjcmlwdGlvbiIsIm1haW5DaGFyYWN0ZXJEaXN0aW5jdGl2ZU1hcmsiLCJzZWNvbmRhcnlDaGFyYWN0ZXJEZXNjcmlwdGlvbiIsInNlY29uZGFyeUNoYXJhY3RlckRpc3RpbmN0aXZlTWFyayIsInN0b3BBdWRpbyIsImNsb3NlIiwic3RvcCIsImUiLCJoYW5kbGVDaGFuZ2VLZXkiLCJhaXN0dWRpbyIsIndpbmRvdyIsIm9wZW5TZWxlY3RLZXkiLCJoYW5kbGVUb2dnbGVBdWRpbyIsIkF1ZGlvQ29udGV4dCIsIndlYmtpdEF1ZGlvQ29udGV4dCIsInN0YXRlIiwicmVzdW1lIiwiY3R4IiwicGxheUJ1ZmZlciIsInRleHRUb1JlYWQiLCJ0aXRsZSIsImhlYnJld1RleHQiLCJwcmV2IiwiY29uc29sZSIsImVycm9yIiwic291cmNlIiwiY3JlYXRlQnVmZmVyU291cmNlIiwiY29ubmVjdCIsImRlc3RpbmF0aW9uIiwib25lbmRlZCIsInN0YXJ0IiwiaGFuZGxlTmV4dCIsImhhbmRsZVByZXYiLCJ1cGRhdGVCb29rU3RhdGUiLCJ1cmwiLCJjdXJyZW50Qm9va1N0YXRlIiwidXBkYXRlZFBhZ2VzIiwidXBkYXRlZEJvb2siLCJsb2FkSW1hZ2UiLCJwYWdlSW5kZXgiLCJhY3Rpb25Qcm9tcHQiLCJyZWZlcmVuY2VUb1VzZSIsImlzQ292ZXIiLCJ0ZXh0VG9SZW5kZXIiLCJ1bmRlZmluZWQiLCJhcnRTdHlsZSIsImVyciIsImhhbmRsZVJlZ2VuZXJhdGVJbWFnZSIsInN0b3BQcm9wYWdhdGlvbiIsImltYWdlUHJvbXB0IiwiYWxlcnQiLCJwcmVwYXJlRXhwb3J0Q2FudmFzIiwiaW1nVXJsIiwid2lkdGgiLCJoZWlnaHQiLCJjb250YWluZXIiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzdHlsZSIsInBvc2l0aW9uIiwibGVmdCIsImJhY2tncm91bmRDb2xvciIsIm92ZXJmbG93IiwiaW5uZXJIVE1MIiwidGV4dCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImNhbnZhcyIsInNjYWxlIiwidXNlQ09SUyIsInJlbW92ZUNoaWxkIiwiaGFuZGxlRG93bmxvYWRaSVAiLCJ6aXAiLCJwZGYiLCJwYWdlV2lkdGgiLCJmaWxlIiwiSlNPTiIsInN0cmluZ2lmeSIsInBuZ0Jsb2IiLCJ0b0Jsb2IiLCJTdHJpbmciLCJwYWRTdGFydCIsImltZ0RhdGEiLCJ0b0RhdGFVUkwiLCJjYW52YXNSYXRpbyIsInBkZkltZ0hlaWdodCIsInJlbmRlcldpZHRoIiwicmVuZGVySGVpZ2h0IiwieE9mZnNldCIsImFkZEltYWdlIiwiYWRkUGFnZSIsImF1ZGlvQnVmIiwiYnVmIiwicGRmQmxvYiIsIm91dHB1dCIsImNvbnRlbnQiLCJnZW5lcmF0ZUFzeW5jIiwiZHJpdmVMaW5rcyIsImhhc0RyaXZlQWNjZXNzIiwidXBsb2FkQm9va1RvRHJpdmUiLCJkcml2ZUVycm9yIiwid2FybiIsInNhdmVCb29rUHJvbXB0cyIsImJvb2tUaXRsZSIsIm1haW5DaGFyYWN0ZXIiLCJ0b3BpYyIsIm1haW5UaGVtZSIsImltYWdlUHJvbXB0cyIsIm1hcCIsImRyaXZlWmlwVXJsIiwiemlwTGluayIsImRyaXZlUGRmVXJsIiwicGRmTGluayIsImxvZyIsImZpcmViYXNlRXJyb3IiLCJsaW5rIiwiaHJlZiIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsInNhZmVUaXRsZSIsInJlcGxhY2UiLCJkb3dubG9hZCIsImNsaWNrIiwic2hvd0xpbmtzIiwiY29uZmlybSIsImhhbmRsZURvd25sb2FkUERGIiwicmVmIiwidXBsb2FkVG9Ecml2ZSIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwicmVzdWx0Iiwid2ViVmlld0xpbmsiLCJzYXZlIiwiZGl2IiwiY2xhc3NOYW1lIiwiYnV0dG9uIiwib25DbGljayIsInNwYW4iLCJkaXNhYmxlZCIsImltZyIsInNyYyIsImgzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./components/BookViewer.tsx\n"));

/***/ })

});